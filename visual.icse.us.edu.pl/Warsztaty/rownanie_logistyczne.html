

  <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Równanie logistyczne &mdash; Warsztaty</title>
    
    <link rel="stylesheet" href="_static/cloud.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Noticia+Text|Open+Sans|Droid+Sans+Mono&subset=latin,latin-ext" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     'I',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/jquery.cookie.js"></script>
    <script type="text/javascript" src="_static/cloud.js"></script>



    <script src="http://sagecell.icse.us.edu.pl:6363/static/jquery.min.js"></script>
	<script src="http://sagecell.icse.us.edu.pl:6363/static/embedded_sagecell.js"></script>

	<script>sagecell.makeSagecell({inputLocation: ".sage",
                                       evalButtonText: 'Wykonaj',
                                       linked: true});</script>

	<style type="text/css">
		.sagecell .CodeMirror-scroll {
			overflow-y: hidden;
			overflow-x: auto;
		}
		.sagecell .CodeMirror {
			height: auto;
		}
	</style>

    
    <link rel="top" title="Warsztaty" href="index.html" />
    <link rel="next" title="Równanie logistyczne II" href="rownanie_logistyczne_II.html" />
    <link rel="prev" title="Od układu Lorenza do równania logistycznego" href="motyl_lorenza_II.html" />
 
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1">
  </head>
  <body>
  <div class="relbar-top">
    
    <div class="related">
      <h3>Nawigacja</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="rownanie_logistyczne_II.html" title="Równanie logistyczne II"
             accesskey="N">dalej</a></li>
        <li class="right" >
          <a href="motyl_lorenza_II.html" title="Od układu Lorenza do równania logistycznego"
             accesskey="P">wstecz</a> &nbsp; &nbsp;</li>
  <li><a href="index.html">Warsztaty</a> &raquo;</li>
   
      </ul>
    </div>
  </div>
  
  <div class="content">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="rownanie-logistyczne">
<h1>Równanie  logistyczne<a class="headerlink" href="rownanie_logistyczne.html#rownanie-logistyczne" title="Stały odnośnik do tego nagłówka">¶</a></h1>
<div class="section" id="troche-historii">
<h2>Trochę historii<a class="headerlink" href="rownanie_logistyczne.html#troche-historii" title="Stały odnośnik do tego nagłówka">¶</a></h2>
<p>W latach siedemdziesiątych XX wieku, na Uniwersytecie w Oxford,
australijski uczony Robert May zajmował się teoretycznymi aspektami
dynamiki populacyjnej. Swoje prace podsumował w artykule, który ukazał
się w <em>Nature</em> pod prowokującym tytułem &#8220;Proste modele matematyczne z
bardzo skomplikowaną dynamiką&#8221; x[may76]_. Artykuł ten po latach stał
się jedną z najczęściej cytowanych prac z teoretycznej ekologii.  Co
wzbudziło tak wielkie zainteresowanie w tej pracy?</p>
<p>May zajmował się zastosowaniem matematyki w ilościowym opisie zjawisk
ekologicznych. Klasycznym zadaniem w tej dziedzinie jest obliczenie wielkości
populacji pewnego gatunku w czasie, znając jej stan liczebny w chwili
początkowej. Najprostszym, z punktu widzenia modelowania
matematycznego, rodzajem ekosystemów wydawały się takie w których
życie jednego pokolenia populacji trwa jeden sezon. Dobrym przykładem
jest populacja owadów, które w ciągu jednego sezonu przechodzą pełną
metamorfozę np. motyle. Czas jest w naturalny sposób podzielony na
dyskretne okresy, odpowiadające cyklom życia populacji. Równania
opisujące taki ekosystem mają więc formę dyskretnych układów
iterowanych w których bieżąca liczebność osobników danego gatunku w
ekosystemie jest funkcją liczebności w poprzednim okresie.</p>
<p>Robert May zajmował się między innymi właśnie taką dynamiką. Badając
układy iteracyjne, uprościł ekosystem do jednego gatunku w którym
populacja była funkcją kwadratową populacji w roku poprzednim. Skąd
taki model?  Najprostszym równaniem dyskretnym opisującym ewolucję
populacji jest model liniowy:</p>
<div class="math" id="equation-Ni">
<span class="eqno">(1)</span>\[N_{i+1} = \alpha \; N_{i},\]</div>
<p>gdzie <span class="math">\(N_i\)</span> to liczebność w i-tym sezonie. Łatwo się przekonać,
że takie równanie może prowadzić to trzech scenariuszy. Jeżeli
<span class="math">\(\alpha&gt;1\)</span> to populacja będzie nieograniczenie rosnąć, jeżeli
<span class="math">\(\alpha&lt;1\)</span> to zaniknie oraz dla <span class="math">\(\alpha=1\)</span> ewolucja nie
będzie zmieniać stanu liczebnego populacji. Najprostszym rozwinięciem
tego modelu jest wprowadzenie zależności stałej <span class="math">\(\alpha\)</span> od
wielkości populacji. Wyobraźmy sobie populacje szkodników w zamkniętym
ekosystemie. Szkodniki zjadają zboże, którego jest dokładnie taka sama
ilość co roku. Jeżeli owadów jest mało w porównaniu do ilości
pożywienia, to mogą rozmnażać się z pełną siła rozrodczą - na przykład
w następnym sezonie będzie ich cztery razy więcej niż w
poprzednim. Jednak w miarę wzrostu liczebności szkodników, pożywienia
nie będzie wystarczać i siła rozrodcza będzie maleć. W krytycznym
przypadku można sobie wyobrazić ze owady zjadają latem całe zboże po
czym wszystkie osobniki umierają z głodu przed osiągnięciem zdolności
rozrodczej. Załóżmy więc, że nasza stała rozrodu będzie liniową
funkcją populacji:</p>
<div class="math" id="equation-alpha">
<span class="eqno">(2)</span>\[\alpha = \alpha( N_{i} ) = A - B N_{i},\]</div>
<p>gdzie <span class="math">\(A\)</span> to stała wzrostu populacji w warunkach dostatku
pożywienia a <span class="math">\(B\)</span> jest stałą, która określa jak szybko brak
pożywienia będzie zmniejszał siłę rozrodczą. W szczególności jeśli
<span class="math">\(N_i=A/B\)</span> to pożywienia jest na tyle mało, że żaden osobnik nie
przeżywa sezonu żerowania.</p>
<p>Równanie <a href="rownanie_logistyczne.html#equation-Ni">(1)</a> ze stałą <a href="rownanie_logistyczne.html#equation-alpha">(2)</a>, można przeskalować do postaci
matematycznie równoważnej, zależnej tylko od jednego
parametru. Równanie takie obecnie jest znane pod nazwą odwzorowania
logistycznego:</p>
<div class="math" id="equation-logistic">
<span class="eqno">(3)</span>\[x_{i+1} = a x_{i} (1 - x_{i}),\]</div>
<p>gdzie <span class="math">\(a&lt;=4\)</span> jest pewną dodatnią stałą a <span class="math">\(x_i\in(0,1)\)</span>
jest proporcjonalne do liczebności populacji w i-tym sezonie.</p>
<div class="admonition note">
<p class="first admonition-title">Informacja</p>
<p class="last">Jeśli populacja ma liczebność równą jeden, to nie dożywa do
następnego pokoleniu. Tak samo było by w przypadku gdy jest większa
od jednego, dlatego wystarczy się ograniczyć do
<span class="math">\(x_i\in(0,1)\)</span>. Z tego samego powodu nie rozważamy parametru
<span class="math">\(a&gt;4\)</span> - bowiem <span class="math">\(a&lt;=4\)</span> odwzorowanie logistyczne
przeprowadza zawsze odcinek (0,1) w odcinek (0,1).</p>
</div>
<p>Mogło by się wydawać, że tak prosty model będzie dawał proste
wyniki. Spróbujmy sami!</p>
<p>Rozważmy model <a href="rownanie_logistyczne.html#equation-logistic">(3)</a> dla parametru <span class="math">\(a=0.5\)</span>, startując z
liczebności <span class="math">\(x=0.45\)</span>. Kolejne wartości populacji można otrzymać
stosując przekształcenie kwadratowe <a href="rownanie_logistyczne.html#equation-logistic">(3)</a> do wartości z
poprzedniego sezonu, na przykład za pomocą poniższego programu:</p>
<div class='sage'><script type='text/x-sage'>a = 0.5
x = 0.45
for i in range(10):
    x = a*x*(1-x)
    print x</script></div><p>Wykonując ten przykład otrzymujemy kolejne wartości populacji, które wraz z
upływem czasu dążą do zera. Eksperymentując z powyższym kodem łatwo
też jest się przekonać, że niezależnie od wartości z której
startujemy, zawsze populacja ginie.</p>
<p>Możemy sobie też ułatwić zadanie, wykorzystując w Sage narzędzie do
szybkiego prototypowania elementów interaktywnych - dekorator
<tt class="code docutils literal"><span class="pre">&#64;interact</span></tt>. Ponadto, zamiast wypisywać wartości liczbowe
przedstawmy je graficzne rysując wykres liczebności populacji od
czasu.</p>
<div class='sage'><script type='text/x-sage'>@interact
def myf(x = slider(0.0,1.0,0.01,default=0.4),a=slider(0,4,0.01,default=0.5)):
    pkts = []
    for i in range(25):
        pkts.append( (i,x) )
        x = a*x*(1-x)
    point(pkts,figsize=(7,3),ymin=0,ymax=1).show()</script></div><p>W powyższym kodzie, elementy <tt class="code docutils literal"><span class="pre">slider</span></tt> pozwalają nam na wykonanie
funkcji <tt class="code docutils literal"><span class="pre">myf</span></tt> dla wybranych interaktywnie wartości <span class="math">\(x\)</span> i
<span class="math">\(a\)</span>.</p>
<p>Zwiększmy teraz parametr <span class="math">\(a\)</span> do dowolnej wartości z przedziału
<span class="math">\(a\in(1,3)\)</span>.  Okazuje się, że wtedy ciąg <span class="math">\(x_i\)</span> dąży do
pewnej wielkości - tym razem jednak nie jest to zero. Interpretując w
kategoriach ekologii, możemy powiedzieć, że wielkość populacji ustala
się na pewnym poziomie, który nie zmienia się z sezonu na
sezon. Podobnie jak poprzednim razem, ta wartość graniczna nie zależy
od punktu startowego. Czyli niezależnie od tego czy populacja
wystartuje bardzo małą liczebnością czy dużą, po kilku pokoleniach i
tak będzie taka sama. W takim przypadku mamy efekt dążenia ekosystemu
do stabilizacji - populacja dostosowuje swoją liczebność do możliwości
wyżywienia się.</p>
<p>Taki efekt był oczekiwany przez badaczy i równanie logistyczne
<a href="rownanie_logistyczne.html#equation-logistic">(3)</a> nie przyciągnęło by szczególnej uwagi gdyby nie
pewna niespodzianka. Okazało się bowiem, że dla pewnych wartości
parametru <span class="math">\(a\)</span> model nie zachowuje się w przewidywalny
sposób. Pojawiają się nie tylko stany okresowe, ale i stany w których
populacja z roku na rok zmienia się w chaotyczny sposób i występuje
czułość na warunki początkowe - wszystkie cechy, które są
charakterystyczne dla chaosu deterministycznego.</p>
<p>Zbadajmy to! Na początek ustalmy wartość parametru na <span class="math">\(a = 3.2\)</span>
i przyjrzyjmy się ewolucji. Zaskoczeniem może być fakt, że tym razem
populacja nie osiąga jednej wartości, ale dwie, które występują
kolejno po sobie co drugi sezon.  Przyjrzyjmy się bliżej temu
zjawisku. Po pierwsze jeżeli ciąg kolejnych wartości <span class="math">\(x_i\)</span> dąży
do pewnej granicy, to możemy napisać dokładny warunek na jej wartość
<span class="math">\(x_g\)</span>. Musi bowiem zachodzić <span class="math">\(x_g=f(x_g)\)</span>. Jeżeli taki
punkt istnieje dla pewnej funkcji <span class="math">\(f\)</span>, to mówimy, że jest to
punkt stały odwzorowania. Możemy więc dokładnie wyznaczyć wartość
punktów stałych odwzorowania logistycznego w zależności od parametru
<span class="math">\(a\)</span>. Prosty rachunek pokazuje, że mamy dwa rozwiązania:
<span class="math">\(x_g = 0\)</span> oraz <span class="math">\(x_g=1-\frac{1}{a}\)</span>. O ile <span class="math">\(x_g = 0\)</span>
jest punktem stałym dla dowolnej wartości parametru, to pamiętając, że
sens mają tylko wartości <span class="math">\(x_i\in(0,1)\)</span>, drugi punkt stały
istnieje dla wartości <span class="math">\(a\in(1,4)\)</span>. Możemy narysować więc wykres
punktów stałych od parametru:</p>
<div class='sage'><script type='text/x-sage'>var('a')
plot(0,(a,0,1),thickness=2)+\
 plot(1-1/a,(a,1,4),thickness=2)+\
 plot(0,(a,1,4),thickness=2,color='red',figsize=(7,3))</script></div><p>Jeżeli mamy równanie zależne od parametru i ilość rozwiązań zmienia się
wraz z tymże parametrem to mówimy, że następuje bifurkacja. W punkcie
<span class="math">\(a=1\)</span> następuje właśnie bifurkacja i układ zamiast jednego
rozwiązania ma dwa. Jednak zauważmy jeszcze jedno ciekawe zjawisko. Z
dowolnego warunku początkowego dla <span class="math">\(a&lt;1\)</span> zawsze otrzymywaliśmy
malejący ciąg populacji, który wydawał się być przyciągany do jedynego
w tym obszarze punktu stałego - do zera. Taki punkt, do którego układ
jest przyciągany zwany jest też atraktorem układu. Dla <span class="math">\(a&gt;1\)</span>
mamy dwa punkty stałe. Okazuje się, że w tym obszarze startując z
dowolnego punktu z wyjątkiem <span class="math">\(x=0\)</span> zawsze będziemy dążyć do
drugiego rozwiązania, który jest atraktorem!  Oznacza to, że jeżeli
rozwiązanie <span class="math">\(x=0\)</span> zaburzymy dowolnie małą liczbą
np. <span class="math">\(x=0.0001\)</span> to i tak po kilkunastu iteracjach populacja
będzie dążyła do <span class="math">\(x_g=1-\frac{1}{a}\)</span> (Poeksperymentujmy!).
Stabilny dla <span class="math">\(a&lt;1\)</span> punkt stały <span class="math">\(x=0\)</span> staje się niestabilny
dla <span class="math">\(a&gt;1\)</span>.</p>
<p>Wróćmy więc do naszej sytuacji, w której mamy <span class="math">\(a = 3.2\)</span>. Według
poprzednich wyliczeń dalej powinniśmy mieć punkt stały
<span class="math">\(x_g=1-\frac{1}{a}\)</span>! I mamy, sprawdźmy:</p>
<div class='sage'><script type='text/x-sage'>a=3.2
x=1-1/a
print "Wartosc poczatkowa x=",x
pkts = []
for i in range(125):
    pkts.append( (i,x) )
    x = a*x*(1-x)
point(pkts,figsize=(7,3),ymin=0,ymax=1).show()</script></div><p>Dodajmy jednak do wartości początkowej pewną małą liczbę np. niech
<tt class="code docutils literal"><span class="pre">x=x+1e-6</span></tt>. Zobaczmy co się stanie? Okazuje się, że we
wcześniejszym punkcie (jak się okaże <span class="math">\(a=3\)</span>) nastąpiła kolejna
bifurkacja w wyniku której rozwiązanie <span class="math">\(x_g=1-\frac{1}{a}\)</span>
utraciło stabilność na rzecz oscylacji. Ponieważ oscylacje te są w
pomiędzy dwoma wartościami, to mówimy, że dla <span class="math">\(a=3.2\)</span> układ ma
punkt okresowy z okresem 2. Właściwie to możemy tylko przypuszczać, że
tak jest bo wynika to tylko z zabaw podczas których liczba iteracji
była skończona. Możemy jednak w tym przypadku pokazać to
dokładnie. Jeżeli populacja co drugi sezon przechodzi w tą samą to
możemy rozważyć odwzorowanie <span class="math">\(g(x)=f(f(x))\)</span>, które przeprowadza
układ o dwa sezony do przodu. W taki przypadku powinniśmy punkt stały
dla <span class="math">\(g\)</span> odpowiada punktowi okresowemu o okresie 2 dla
<span class="math">\(f\)</span>. Zastosujmy tą chytrą sztuczkę, tym razem z pomocą Sage:</p>
<div class='sage'><script type='text/x-sage'>var('a x')
f(x) = a*x*(1-x)
show( expand( f(f(x))==x) )
s = solve(f(f(x))==x,x)
show(s)</script></div><p>Dobrze, że możemy wyręczyć się systemem algebry komputerowej, bo
niestety równanie <span class="math">\(f(f(x))=x\)</span> jest równaniem czwartego stopnia!
Sage na szczęście &#8220;potrafi&#8221; rozwiązywać analitycznie równania czwartego
stopnia i otrzymujemy rozwiązania. Od razu widzimy wśród pierwiastków
punkty stałe odwzorowania <span class="math">\(f\)</span>, co jest zrozumiałe, bo jeśli
zachodzi <span class="math">\(f(x)=x\)</span> to tym bardziej <span class="math">\(f(f(x))=x\)</span>. Narysujmy
zatem nasz wynik.</p>
<div class='sage'><script type='text/x-sage'>var('x a')
f(x)=a*x*(1-x)
s = solve(x==f(f(x)),x)
show(s)

plot(s[3].rhs(),(a,0,1),thickness=2)+\
 plot(s[2].rhs(),(a,1,3),thickness=2)+\
 plot(s[3].rhs(),(a,1,4),thickness=2,color='red',figsize=(7,3))+\
 plot(s[0].rhs(),(a,3,4),thickness=2)+\
 plot(s[1].rhs(),(a,3,4),thickness=2)+\
 plot(s[2].rhs(),(a,3,4),thickness=2,ymin=0,ymax=1,color='red')</script></div><p>Wykres ten, zwany diagramem bifurkacyjnym, nie jest do końca
kompletny - skoro pojawiły się dwie bifurkacje to nie ma powodu, żeby
zakładać, że więcej się nie pojawi! W dalszej analizie pojawia się
jednak zasadniczy problem. Otóż nie możemy badać analitycznie punktów
stałych dalszych złożeń odwzorowania <span class="math">\(f(f(f(x)))=x\)</span>, bo w
poprzednim przypadku wyczerpaliśmy możliwość dokładnego znajdywania
miejsc zerowych wielomianów. Zgodnie z <a class="reference external" href="http://pl.wikipedia.org/wiki/Teoria_Galois">Teoria Galois</a> wzory analityczne na
pierwiastki wielomianu kończą się w przypadku ogólnym na stopniu
cztery. Oczywiście można zastosować metody przybliżone, lub metodę
graficzną. Jednak okazuje się, że całkiem niezłym sposobem na poznanie
struktury cykli układu jest po prostu jego symulacja na tyle długa by
układ zdążył dojść wystarczająco blisko do atraktora. Zanim użyjemy
tego sposobu, zapoznajmy się z metodą graficzną - jak mawiano,
ilustracja jest warta tysiąca słów. Zapraszamy do lektury części II!</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <div class="sphinxlocaltoc">
  <h3><a href="index.html">Spis treści</a></h3>
  <ul>
<li><a class="reference internal" href="rownanie_logistyczne.html#">Równanie  logistyczne</a><ul>
<li><a class="reference internal" href="rownanie_logistyczne.html#troche-historii">Trochę historii</a></li>
</ul>
</li>
</ul>

  </div>
  <h4>Poprzedni temat</h4>
  <p class="topless"><a href="motyl_lorenza_II.html"
                        title="poprzedni rozdział">Od układu Lorenza do równania logistycznego</a></p>
  <h4>Następny temat</h4>
  <p class="topless"><a href="rownanie_logistyczne_II.html"
                        title="następny rozdział">Równanie  logistyczne II</a></p>
<div id="searchbox" style="display: none">
  <h3>Szybkie wyszukiwanie</h3>
    <form class="search" action="http://visual.icse.us.edu.pl/Warsztaty/search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Szukaj" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Wprowadź szukany termin lub nazwę modułu, klasy lub funkcji.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  </div>
  <div class="relbar-bottom">
    
    <div class="related">
      <h3>Nawigacja</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="rownanie_logistyczne_II.html" title="Równanie logistyczne II"
             >dalej</a></li>
        <li class="right" >
          <a href="motyl_lorenza_II.html" title="Od układu Lorenza do równania logistycznego"
             >wstecz</a> &nbsp; &nbsp;</li>
  <li><a href="index.html">Warsztaty</a> &raquo;</li>
   
      </ul>
    </div>
  </div>
  
  <div class="footer">
    <a class="logo" href="../../icse.us.edu.pl/index.html" target="_blank"><img src="_static/logo-icse.png" alt="ICSE"/></a><br/>
    &copy; Copyright 2013, CubeProject.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.2.
  </div>
  </body>
</html>