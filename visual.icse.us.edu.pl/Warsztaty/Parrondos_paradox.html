

  <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Parrondo’s paradox &mdash; Warsztaty</title>
    
    <link rel="stylesheet" href="_static/cloud.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Noticia+Text|Open+Sans|Droid+Sans+Mono&subset=latin,latin-ext" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     'I',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/jquery.cookie.js"></script>
    <script type="text/javascript" src="_static/cloud.js"></script>



    <script src="http://sagecell.icse.us.edu.pl:6363/static/jquery.min.js"></script>
	<script src="http://sagecell.icse.us.edu.pl:6363/static/embedded_sagecell.js"></script>

	<script>sagecell.makeSagecell({inputLocation: ".sage",
                                       evalButtonText: 'Wykonaj',
                                       linked: true});</script>

	<style type="text/css">
		.sagecell .CodeMirror-scroll {
			overflow-y: hidden;
			overflow-x: auto;
		}
		.sagecell .CodeMirror {
			height: auto;
		}
	</style>

    
    <link rel="top" title="Warsztaty" href="index.html" />
    <link rel="next" title="Wprowadzenie do SAGE’a – matematyka bez bólu, obliczenia, wykresy" href="iCSE_1a_Wprowadzenie_CubeProject.html" />
    <link rel="prev" title="Zadanie 7 - o tym jak nakłonić funkcję plot do współpracy" href="matura2015_p07.html" />
 
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1">
  </head>
  <body>
  <div class="relbar-top">
    
    <div class="related">
      <h3>Nawigacja</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="iCSE_1a_Wprowadzenie_CubeProject.html" title="Wprowadzenie do SAGE’a – matematyka bez bólu, obliczenia, wykresy"
             accesskey="N">dalej</a></li>
        <li class="right" >
          <a href="matura2015_p07.html" title="Zadanie 7 - o tym jak nakłonić funkcję plot do współpracy"
             accesskey="P">wstecz</a> &nbsp; &nbsp;</li>
  <li><a href="index.html">Warsztaty</a> &raquo;</li>
   
      </ul>
    </div>
  </div>
  
  <div class="content">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="parrondo-s-paradox">
<h1>Parrondo&#8217;s paradox<a class="headerlink" href="Parrondos_paradox.html#parrondo-s-paradox" title="Stały odnośnik do tego nagłówka">¶</a></h1>
<div class="admonition-abstract admonition">
<p class="first admonition-title">Abstract</p>
<p>Parrondo&#8217;s paradox is a combination of games which behaves quite
counterintuively. Beyond its curious behavior, it provides a simple
illustration of a physical system, the so-called flashing ratchet.
After giving some background information on Parrondo&#8217;s paradox, we
will explore several approaches to a numerical implementation. An
object-oriented approach will finally allow us to study in some
detail various aspects of Parrondo&#8217;s paradox. Readers less
interested in the programming aspects can skip that part and after
having read the introduction can go directly to the last section.</p>
<p>Literature:</p>
<ul class="last simple">
<li><a class="reference external" href="http://dx.doi.org/10.1080/00107510310001644836">J. M. R. Parrondo and Luis Dinís, Contemp. Phys. 45, 147 (2004)</a></li>
<li><a class="reference external" href="http://en.wikipedia.org/wiki/Parrondo%27s_paradox">Parrondo&#8217;s paradox – Wikipedia, The Free Encyclopedia</a></li>
</ul>
</div>
<div class="sidebar">
<p class="first sidebar-title">What is Parrondo&#8217;s paradox?</p>
<div class="last"><iframe width="420" height="280" src="https://www.youtube.com/embed/TQ31Md9KPRM?start=8&end=585&version=3&loop=1&controls=2" frameborder="0" allowfullscreen></iframe></div></div>
<p>In Parrondo&#8217;s paradox, a flashing ratchet is simulated by two games
representing the situations with the potential switched on and off. In
both cases, the player will loose on average, thereby mimicking a
tilted potential with an average motion to the left as explained
above. The question to be explored in the following is how the
situation changes for the player when one switches between the two
games.</p>
<p>Parrondo&#8217;s paradox serves as an illustration of Brownian ratchets by
means of appropriately combining two games where tossing a coin
represents the random Brownian motion.</p>
<p>Brownian motion of particles leads to a broadening of their
distribution. An initially sharp distribution (red curve) will be
significantly broader (green curve) after some time.</p>
<img alt="_images/diffusion.png" class="align-center" src="_images/diffusion.png" />
<p>If the potential is slightly tilted to the left, the distribution will
not only broaden but also move to the left in the course of time.</p>
<p>A specific type of a Brownian ratchet is the so-called <em>flashing
ratchet</em>, where during certain periods of time a sawtooth potential
(see figure below) is switched on. If the sawtooth potential is
permanently switched on, the diffusive motion will not have a
preferential direction. If the potential is tilted to the left,
particles on average will move to the left as was the case in the
absence of an external potential.</p>
<img alt="_images/sawtoothpotential.png" class="align-center" src="_images/sawtoothpotential.png" />
<p>However, in the operational mode of a flashing ratchet, when the
sawtooth potential is switched on and off appropriately, one can
observe an average motion to the right.</p>
<div class="section" id="tossing-a-coin">
<h2>Tossing a coin<a class="headerlink" href="Parrondos_paradox.html#tossing-a-coin" title="Stały odnośnik do tego nagłówka">¶</a></h2>
<div class="sidebar">
<p class="first sidebar-title">Let&#8217;s play a game!</p>
<div class="last"><iframe width="420" height="280" src="https://www.youtube.com/embed/TQ31Md9KPRM?start=585&end=1600&version=3&loop=1&controls=2" frameborder="0" allowfullscreen></iframe></div></div>
<p>Let us try out the creation of random numbers. The numbers are
generated in a way that they are equally distributed between 0
and 1. For the simplest fair game, we would define a threshold of 0.5
where the player wins if the random number is below the threshold and
looses otherwise.</p>
<div class='sage'><script type='text/x-sage'>print random()</script></div><div class='sage'><script type='text/x-sage'>for n in range(10):
    print random()</script></div><div class="admonition-note-on-python admonition">
<p class="first admonition-title">Note on Python</p>
<p class="last">Indentation is used as a syntax markup. As long as the code is indented
relative to the for <tt class="code docutils literal"><span class="pre">loop</span></tt> statement (first line above), the code is
repeated within the loop. Once the indented block terminates, Python knows
that the following code is no longer part of the loop. The same indentation
concept holds for example for <tt class="code docutils literal"><span class="pre">if/else</span></tt> constructs and function and
class definitions, all of which we will encounter below. Indentation needs to
be consistent. Make it a rule to always indent by 4 spaces per indentation
level.</p>
</div>
<p>Let us now toss some coins in a fair game. Since the outcomes are random,
you should not expect to win in exactly half of the cases even though this
may happen. For comparison, you might try the same game with a real coin.</p>
<div class='sage'><script type='text/x-sage'>for n in range(10):
    if random() < 0.5:
        print "you win"
    else:
        print "you loose"</script></div></div>
<div class="section" id="game-a">
<h2>Game A<a class="headerlink" href="Parrondos_paradox.html#game-a" title="Stały odnośnik do tego nagłówka">¶</a></h2>
<p>Now we take a look at the individual games which are part of Parrondo&#8217;s
paradox and start with game A. The rule is simple: We win if the random
number is below <span class="math">\(0.5-\epsilon\)</span>, otherwise we loose. For
<span class="math">\(\epsilon&gt;0\)</span>, we have to face it: We will loose in the long run. For
our numerical runs, let us use <span class="math">\(\epsilon=0.005\)</span>.</p>
<p>We are not interested in the absolute amount of money which we have after
a certain number of games. Only changes are important, how much money have
we won or lost? Therefore, it is fine to start without any money at the
beginning.</p>
<p>Running the following code several times, you will notice that in some
cases you are lucky and win money for some time. However, if you continue
to play, you will end up loosing money. In order to show this, we have to
play the game often. Setting the number of games to 100000, the code will
run for a couple of seconds. You can try a different number of games by
changing the value of <tt class="code docutils literal"><span class="pre">ngames</span></tt>, but if <tt class="code docutils literal"><span class="pre">ngames</span></tt> is too large,
the code might need a long time to terminate.</p>
<div class='sage'><script type='text/x-sage'>eps = 0.005
ngames = 100000
money = 0
evolution = [money]

for ngame in range(ngames):
    if random() < 0.5-eps:
        money = money+1
    else:
        money = money-1
    evolution.append(money)

list_plot(evolution, pointsize=1)</script></div></div>
<div class="section" id="game-b">
<h2>Game B<a class="headerlink" href="Parrondos_paradox.html#game-b" title="Stały odnośnik do tego nagłówka">¶</a></h2>
<p>The rules of the second game are slightly more complicated because
they depend on the amount of money in our possession at the time the
game is played. There are two rules:</p>
<ol class="arabic simple">
<li>Our money is not a multiple of <span class="math">\(m\)</span>:
We win if the random number is below <span class="math">\(\frac{3}{4}-\epsilon\)</span>.
Otherwise we loose. This sounds extremely good…</li>
<li>Our money is a multiple of <span class="math">\(m\)</span>:
We win only if the random number is below <span class="math">\(\frac{1}{10}-\epsilon\)</span>.
Otherwise we loose. A pretty bad situation…</li>
</ol>
<p>But: For <span class="math">\(\epsilon&gt;0\)</span>, we still loose in the long run. While this
statement can be rigorously proven, we will simply try it out numerically.</p>
<p><span class="math">\(m\)</span> is an integer which we choose to be 3 in the following.</p>
<div class='sage'><script type='text/x-sage'>eps = 0.005
m = 3
ngames = 100000
money = 0
evolution = [money]

for ngame in range(ngames):
     if money % m:
         if random() < 0.75-eps:
             money = money+1
         else:
             money = money-1
     else:
         if random() < 0.1-eps:
             money = money+1
         else:
             money = money-1
     evolution.append(money)

list_plot(evolution, pointsize=1)</script></div><div class="admonition-note-on-python admonition">
<p class="first admonition-title">Note on Python</p>
<p class="last">The character <tt class="code docutils literal"><span class="pre">%</span></tt> represents the modulo operator. In the previous
code the <tt class="code docutils literal"><span class="pre">if</span></tt>-branch is chosen if <tt class="code docutils literal"><span class="pre">money</span></tt> is not divisible by
<tt class="code docutils literal"><span class="pre">m</span></tt> without rest while the <tt class="code docutils literal"><span class="pre">else</span></tt>-branch is chosen if
the division is possible without rest.</p>
</div>
</div>
<div class="section" id="combining-two-loosing-games">
<h2>Combining two loosing games<a class="headerlink" href="Parrondos_paradox.html#combining-two-loosing-games" title="Stały odnośnik do tego nagłówka">¶</a></h2>
<p>We now play a series of games alternating between two games A and
two games B in a row: A-A-B-B-A-A-B-B-…</p>
<p>What do you expect? Will we loose again? Let&#8217;s try it out.</p>
<div class='sage'><script type='text/x-sage'>eps = 0.005
m = 3
ngames = 100000
money = 0
evolution = [money]

for ngame in range(ngames):
    if ngame % 4 < 2:
        # game A
        if random() < 0.5-eps:
            money = money+1
        else:
            money = money-1
    else:
        # game B
        if money % m:
            if random() < 0.75-eps:
                money = money+1
            else:
                money = money-1
        else:
            if random() < 0.1-eps:
                money = money+1
            else:
                money = money-1
    evolution.append(money)

list_plot(evolution, pointsize=1)</script></div><p>Unless you have been extremely unlucky, the combination of two loosing
game should yield a winning situation.</p>
</div>
<div class="section" id="object-oriented-approach">
<h2>Object-oriented approach<a class="headerlink" href="Parrondos_paradox.html#object-oriented-approach" title="Stały odnośnik do tego nagłówka">¶</a></h2>
<p>By putting together the codes from games A and B, we ended up with code
which is not optimal in two respects. Chaining the <tt class="code docutils literal"><span class="pre">if/else</span></tt>
constructs results in not very readable code. Furthermore, we have
repeated three times the code for tossing a coin. The three code segments
only differ by the winning threshold. Instead of repeating code, it is
better to follow the DRY principle: Don&#8217;t Repeat Yourself.</p>
<div class="admonition-important-hint admonition">
<p class="first admonition-title">Important hint</p>
<p class="last">In the following we will present an object-oriented approach to
Parrondo&#8217;s paradox which will facilitate our further analysis of the
paradox. Feel free to skip this section if you are not interested in
the details of the code but <em>be sure to execute the code cells</em> so that
the various classes and their methods are available later on.
Executing cells in this section will not yield any visible results.</p>
</div>
<p>The object-oriented approach will present a few advantages for exploring
Parrondo&#8217;s paradox. New sequences of games A and B can be defined in a
simple way. An instance of a game remembers the parameters <span class="math">\(\epsilon\)</span>
and <span class="math">\(m\)</span> for which it was defined as well as the money in our
possession during the game. Several instances of games can be played in
parallel, each instance having automatically its own money and game
parameters.</p>
<p>The class <tt class="xref py py-class docutils literal"><span class="pre">Game</span></tt> defined in the following code knows how to toss
a coin and to determine a win or loss as a function of the winning threshold.
It also knows how to perform a series of plays. However, a single play
has to be defined by classes derived from <tt class="xref py py-class docutils literal"><span class="pre">Game</span></tt>.</p>
<div class='sage'><script type='text/x-sage'>class Game(object):
    '''The Game class knows how to toss a coin and how to play a series
       of games. However, there is no definition of a single game. This
       class should be used as a generic parent class for specific games.

    '''
    def __init__(self, money=0):
        self.money = money

    def toss_coin(self, threshold):
        if random() < threshold:
            self.money = self.money+1
        else:
            self.money = self.money-1

    def play(self):
        raise NotImplementedError

    def play_series(self, repetitions):
        evolution = [self.money]
        for r in range(repetitions):
            self.play()
            evolution.append(self.money)
        return evolution</script></div><p>The class <tt class="xref py py-class docutils literal"><span class="pre">ParrondoGame</span></tt> is derived from the parent class
<tt class="xref py py-class docutils literal"><span class="pre">Game</span></tt> and defines the games A and B. However, it only serves
as a parent class for the classes defined below which are actually able
to do the playing. The class <tt class="xref py py-class docutils literal"><span class="pre">ParrondoGame</span></tt> defines the values used
above for the parameters <span class="math">\(\epsilon\)</span> and <span class="math">\(m\)</span> as default values.
These values need to be specified only if other values are desired.</p>
<div class='sage'><script type='text/x-sage'>class ParrondoGame(Game):
    '''This class provides games A and B of Parrondo's paradox.

    '''
    def __init__(self, epsilon=0.005, m=3, **kwargs):
        self.epsilon = epsilon
        self.m = m
        Game.__init__(self, **kwargs)

    def play_a(self):
        self.toss_coin(0.5-self.epsilon)

    def play_b(self):
        if self.money % self.m:
            self.toss_coin(0.75-self.epsilon)
        else:
            self.toss_coin(0.10-self.epsilon)</script></div><p>The class <tt class="xref py py-class docutils literal"><span class="pre">GameA</span></tt> plays game A of Parrondo&#8217;s paradox.</p>
<div class='sage'><script type='text/x-sage'>class GameA(ParrondoGame):
    '''Game A of Parrondo's paradox

    '''
    def __init__(self, **kwargs):
        ParrondoGame.__init__(self, **kwargs)

    def __repr__(self):
        return 'game A'

    def play(self):
        self.play_a()</script></div><p>Correspondingly, the class <tt class="xref py py-class docutils literal"><span class="pre">GameB</span></tt> plays game B of Parrondo&#8217;s paradox.</p>
<div class='sage'><script type='text/x-sage'>class GameB(ParrondoGame):
    '''Game B of Parrondo's paradox

    '''
    def __init__(self, **kwargs):
        ParrondoGame.__init__(self, **kwargs)

    def __repr__(self):
        return 'game B'

    def play(self):
        self.play_b()</script></div><p>The class <tt class="xref py py-class docutils literal"><span class="pre">GameAABB</span></tt> plays a the sequence of two games A and two
games B as specified above for Parrondo&#8217;s paradox.</p>
<div class='sage'><script type='text/x-sage'>import itertools

class GameAABB(ParrondoGame):
    '''Sequence of games AABB of Parrondo's paraodxon

    '''
    def __init__(self, **kwargs):
        ParrondoGame.__init__(self, **kwargs)
        self.gametype = itertools.cycle((
                            self.play_a, self.play_a,
                            self.play_b, self.play_b))

    def __repr__(self):
        return u'game sequence A-A-B-B'

    def play(self):
        game = self.gametype.next()
        game()</script></div><p>For comparison, we also define a class <tt class="xref py py-class docutils literal"><span class="pre">GameABRandom</span></tt> which chooses
at random between games A and B.</p>
<div class='sage'><script type='text/x-sage'>class GameABRandom(ParrondoGame):
    '''Random sequence of games A and B of Parrondo's paradox

    '''
    def __init__(self, **kwargs):
        ParrondoGame.__init__(self, **kwargs)

    def __repr__(self):
        return u'random sequence of games A and B'

    def play(self):
        game = choice((self.play_a, self.play_b))
        game()</script></div><p>The preceding two classes can be used as templates for the definition of
other sequences of games A and B.</p>
</div>
<div class="section" id="exploring-parrondo-s-paradox">
<h2>Exploring Parrondo&#8217;s paradox<a class="headerlink" href="Parrondos_paradox.html#exploring-parrondo-s-paradox" title="Stały odnośnik do tego nagłówka">¶</a></h2>
<p>Let us first repeat our numerical experiments carried out at the beginning,
but now by using the object-oriented code.</p>
<div class='sage'><script type='text/x-sage'>games = [(GameA(), 'blue'),
         (GameB(), 'green'),
         (GameAABB(), 'red')]
plots = [list_plot(game.play_series(30000), pointsize=1, color=color) for game, color in games]
show(sum(plots))</script></div><p>If everything works as expected, the blue and green curves corresponding to
game A and B, respectively, should end up at a negative value while the red
curve corresponding to a games A-A-B-B-… should end up at a positive value.</p>
<p>However, single realizations of a game can be treacherous as you might have
seen already above by running the simulations several times. Therefore, we
now evaluate the average and standard deviation for 50 realizations of a game
where the coin is tossed only 10000 times.</p>
<div class='sage'><script type='text/x-sage'>ngames = 10000
nrealizations = 50
for game in (GameA, GameB, GameAABB):
    results = [game().play_series(ngames)[-1] for n in range(nrealizations)]
    print game()
    print '   average money:      %8.2f' % N(mean(results))
    print '   standard deviation: %8.2f' % N(std(results))</script></div><p>Do the averages come out with the expected sign?</p>
<p><strong>Histogram seems to require at least Sage 6.5</strong></p>
<div class='sage'><script type='text/x-sage'>from sage.plot.histogram import Histogram
ngames = 10000
nrealizations = 200
results = [GameA().play_series(ngames)[-1] for n in range(nrealizations)]
Histogram(results)</script></div></div>
<div class="section" id="suggestions-for-further-numerical-experiments">
<h2>Suggestions for further numerical experiments<a class="headerlink" href="Parrondos_paradox.html#suggestions-for-further-numerical-experiments" title="Stały odnośnik do tego nagłówka">¶</a></h2>
<ul class="simple">
<li>What happens if the number of A and B games is changed in the sequence?</li>
<li>What happens for random switching between games A and B?</li>
<li>What happens when parameters like <span class="math">\(\epsilon\)</span> and  <span class="math">\(m\)</span> are changed?</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <div class="sphinxlocaltoc">
  <h3><a href="index.html">Spis treści</a></h3>
  <ul>
<li><a class="reference internal" href="Parrondos_paradox.html#">Parrondo&#8217;s paradox</a><ul>
<li><a class="reference internal" href="Parrondos_paradox.html#tossing-a-coin">Tossing a coin</a></li>
<li><a class="reference internal" href="Parrondos_paradox.html#game-a">Game A</a></li>
<li><a class="reference internal" href="Parrondos_paradox.html#game-b">Game B</a></li>
<li><a class="reference internal" href="Parrondos_paradox.html#combining-two-loosing-games">Combining two loosing games</a></li>
<li><a class="reference internal" href="Parrondos_paradox.html#object-oriented-approach">Object-oriented approach</a></li>
<li><a class="reference internal" href="Parrondos_paradox.html#exploring-parrondo-s-paradox">Exploring Parrondo&#8217;s paradox</a></li>
<li><a class="reference internal" href="Parrondos_paradox.html#suggestions-for-further-numerical-experiments">Suggestions for further numerical experiments</a></li>
</ul>
</li>
</ul>

  </div>
  <h4>Poprzedni temat</h4>
  <p class="topless"><a href="matura2015_p07.html"
                        title="poprzedni rozdział">Zadanie 7 - o tym jak nakłonić funkcję <tt class="code docutils literal"><span class="pre">plot</span></tt> do współpracy</a></p>
  <h4>Następny temat</h4>
  <p class="topless"><a href="iCSE_1a_Wprowadzenie_CubeProject.html"
                        title="następny rozdział">Wprowadzenie do SAGE&#8217;a &#8211; matematyka bez bólu, obliczenia, wykresy</a></p>
<div id="searchbox" style="display: none">
  <h3>Szybkie wyszukiwanie</h3>
    <form class="search" action="http://visual.icse.us.edu.pl/Warsztaty/search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Szukaj" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Wprowadź szukany termin lub nazwę modułu, klasy lub funkcji.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  </div>
  <div class="relbar-bottom">
    
    <div class="related">
      <h3>Nawigacja</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="iCSE_1a_Wprowadzenie_CubeProject.html" title="Wprowadzenie do SAGE’a – matematyka bez bólu, obliczenia, wykresy"
             >dalej</a></li>
        <li class="right" >
          <a href="matura2015_p07.html" title="Zadanie 7 - o tym jak nakłonić funkcję plot do współpracy"
             >wstecz</a> &nbsp; &nbsp;</li>
  <li><a href="index.html">Warsztaty</a> &raquo;</li>
   
      </ul>
    </div>
  </div>
  
  <div class="footer">
    <a class="logo" href="../../icse.us.edu.pl/index.html" target="_blank"><img src="_static/logo-icse.png" alt="ICSE"/></a><br/>
    &copy; Copyright 2013, CubeProject.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.2.
  </div>
  </body>
</html>