

  <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Modele oddziałujących populacji: ofiara - drapieżca &mdash; Procesy nieliniowe w Biologii</title>
    
    <link rel="stylesheet" href="_static/cloud.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Noticia+Text|Open+Sans|Droid+Sans+Mono&subset=latin,latin-ext" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     'I',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/jquery.cookie.js"></script>
    <script type="text/javascript" src="_static/cloud.js"></script>

	<script src="http://sagecell.icse.us.edu.pl:6363/static/jquery.min.js"></script>
	<script src="http://sagecell.icse.us.edu.pl:6363/static/embedded_sagecell.js"></script>
	
	<!-- <script src="http://sagecell.sagemath.org/static/jquery.min.js"></script> -->
        <!-- <script src="http://sagecell.sagemath.org/static/embedded_sagecell.js"></script> -->


	<script>sagecell.makeSagecell({inputLocation: ".sage",
                                       evalButtonText: 'Wykonaj',
                                       linked: true});</script>


	<style type="text/css">
		.sagecell .CodeMirror-scroll {
			overflow-y: hidden;
			overflow-x: auto;
		}
		.sagecell .CodeMirror {
			height: auto;
		}
	</style>

    
    <link rel="top" title="Procesy nieliniowe w Biologii" href="index.html" />
    <link rel="next" title="Kinetyka reakcji chemicznych" href="iCSE_BProcnielin04_z122_kinetyka_chemiczna.html" />
    <link rel="prev" title="Dynamika populacyjna: ciągłe modele jednowymiarowe" href="iCSE_BProcnielin01_z118_modele_jednowymiarowe.html" />
 
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1">
  </head>
  <body>
  <div class="relbar-top">
    
    <div class="related">
      <h3>Nawigacja</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="iCSE_BProcnielin04_z122_kinetyka_chemiczna.html" title="Kinetyka reakcji chemicznych"
             accesskey="N">dalej</a></li>
        <li class="right" >
          <a href="iCSE_BProcnielin01_z118_modele_jednowymiarowe.html" title="Dynamika populacyjna: ciągłe modele jednowymiarowe"
             accesskey="P">wstecz</a> &nbsp; &nbsp;</li>
  <li><a href="index.html">Procesy nieliniowe w Biologii</a> &raquo;</li>
   
      </ul>
    </div>
  </div>
  
  <div class="content">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="modele-oddzialujacych-populacji-ofiara-drapiezca">
<h1>Modele oddziałujących populacji: ofiara - drapieżca<a class="headerlink" href="iCSE_BProcnielin02_z119_ofiara_drapiezca.html#modele-oddzialujacych-populacji-ofiara-drapiezca" title="Stały odnośnik do tego nagłówka">¶</a></h1>
<div class="section" id="model-lotki-volterry">
<h2>Model Lotki-Volterry<a class="headerlink" href="iCSE_BProcnielin02_z119_ofiara_drapiezca.html#model-lotki-volterry" title="Stały odnośnik do tego nagłówka">¶</a></h2>
<p>W modelu tym rozważamy 2 populacje: populacja zwana &#8220;ofiary&#8221; i
populacja zwana &#8220;drapieżniki&#8221; lub drapieżcy. Osobniki jednej z nich
(&#8220;ofiary&#8221;) są (niestety) zjadane przez osobniki drugiej populacji
(&#8220;drapieżniki&#8221;).  &#8220;Ofiary&#8221; mogą rozmnażać się i umierać śmiercią
naturalaną. Ponadto &#8220;ofiary&#8221; giną śmiercią tragiczną zjadane przez
&#8220;drapieżników&#8221;, które to rozmnażają się i umierają śmiercią naturalną
(niestety).</p>
<p>Populacja ofiar opisana jest funkcją <span class="math">\(N=N(t)\)</span>, natomiast
populacja drapieżników opisana jest funkcją <span class="math">\(P=P(t)\)</span>. Podobnie
jak w modelu Malthusa, tempo zmian w populacji ofiar i drapieżników
jest wynikiem urodzin i śmierci w populacji:</p>
<div class="math">
\[\frac{dN}{dt} = a N - b N\]</div>
<div class="math">
\[\frac{dP}{dt} = c P - e P\]</div>
<p>gdzie parametr <span class="math">\(a\)</span> charakteryzuje tempo urodzin ofiar, <span class="math">\(b\)</span>
charakteryzuje tempo śmierci ofiar, <span class="math">\(c\)</span> charakteryzuje tempo
urodzin drapieżników i <span class="math">\(e\)</span> charakteryzuje tempo śmierci
drapieżników.</p>
<p>Zakładamy, że tempo śmierci ofiar <span class="math">\(b\)</span> zależy od populacji
drapieżników: im więcej jest drapieżników <span class="math">\(P\)</span>, tym większe jest
tempo śmierci ofiar.  W prostym opisie oznacza to, że</p>
<div class="math">
\[b \to  b_0 P\]</div>
<p>gdzie <span class="math">\(b_0\gt 0\)</span> jest parametrem. Podobnie założymy, że tempo
urodzin drapieżników <span class="math">\(c\)</span> zależy od populacji ofiar: im więcej
jest ofiar <span class="math">\(N\)</span>, tym większe jest tempo urodzin drapieżników (im
więcej jest pożywienia tym szybciej rozrasta się populacja). Oznacza
to, że</p>
<div class="math">
\[c  \to  c_0 N\]</div>
<p>gdzie <span class="math">\(c_0 \gt 0\)</span>.  Przy takich założeniach model Malthusa zmienia się do postaci</p>
<div class="math">
\[\frac{dN}{dt} = a N - b_0 P N\]</div>
<div class="math">
\[\frac{dP}{dt} = c_0 N P - e P\]</div>
<p>Wszystkie parametry są dodatnie. Model ten wprowadził w
1926 r. V. Volterra do opisu populacji ryb. Natomiast w
1920 r. A. J. Lotka otrzymał podobne równania do opisu kinetyki
autokatalizy (patrz wykład o kinetyce reakcji chemicznych). Stąd model
ten nazywa się modelem Lotki-Volterry. W modelu tym pojawiają się 4
parametry. Jak to często bywa, własności tego typu modeli zależą od
mniejszej ilości parametrów. Metodą na eliminację niektórych
parametrów jest wprowadzenie wielkości bezwymiarowych lub wielkości
przeskalowanych. W powyższym przypadku wprowadzimy następujące
przeskalowane i bezwymiarowe wielkości:</p>
<div class="math">
\[x=\frac{c_0}{e} N, \quad y =\frac{b_0}{a} P\]</div>
<p>oraz bezwymiarowy czas:</p>
<div class="math">
\[\tau = a t\]</div>
<p>Po wstawieniu tych wielkości do równań Lotki-Volterry otrzymamy układ równań:</p>
<div class="math">
\[\dot x= x- x y\]</div>
<div class="math">
\[\dot y = \alpha (xy-y)\]</div>
<p>w którym pojawia się tylko jeden parametr <span class="math">\(\alpha = \frac{e}{a}
\gt 0\)</span>, który opisuje stosunek tempa śmierci drapieżników <span class="math">\(d\)</span> do
tempa urodzin ofiar <span class="math">\(r\)</span>.  Tak więc procedura przeskalowania
równań pozwoliła wyeliminować nieistotne parametry. Jedynym istotnym
parametrem jest tylko jeden parametr, a mianowicie <span class="math">\(\alpha\)</span>.
Własności rozwiązań w modelu Lotki-Volterry zależą tylko od tego
parametru i od warunków początkowych <span class="math">\(x(0)\)</span> i <span class="math">\(y(0)\)</span>.</p>
<p><strong>STANY STACJONARNE</strong></p>
<p>Stany stacjonarne wyznaczone sa przez równania:</p>
<div class="math">
\[f(x, y) = x- x y =0,  \quad g(x,y) = \alpha (xy - y) =0,\]</div>
<p>stąd otrzymujemy</p>
<div class="math">
\[(x_1=0, y_1=0) \quad \mbox{lub} \quad (x_2=1, y_2 =1)\]</div>
<p><strong>STABILNOŚĆ STANÓW STACJONARNYCH</strong></p>
<ol class="arabic simple">
<li>Wyznaczamy macierz Jacobiego</li>
</ol>
<div class="math">
\[\begin{split}J = \begin{bmatrix}\frac{ \partial f}{\partial x}&amp;  \frac{\partial f}{\partial y}\\ \frac{\partial g}{\partial x}&amp;  \frac{\partial g}{\partial y}  \end{bmatrix}\end{split}\]</div>
<p>w punktach stacjonarnych:</p>
<div class="math">
\[\begin{split}J_1= J(0, 0) = \begin{bmatrix}1&amp; 0\\ 0&amp; -\alpha \end{bmatrix}, \quad \quad  J_2= J(1, 1) = \begin{bmatrix}0&amp; -1\\ \alpha&amp; 0 \end{bmatrix}\end{split}\]</div>
<ol class="arabic simple" start="2">
<li>Wyznaczamy wartości własne macierzy Jacobiego <span class="math">\(|J-\lambda I|=0\)</span>:</li>
</ol>
<ol class="loweralpha">
<li><dl class="first docutils">
<dt>dla <span class="math">\((0, 0)\)</span> otrzymujemy:</dt>
<dd><dl class="first last docutils">
<dt><span class="math">\(\lambda_{01} = 1,\quad \lambda_{02} =- \alpha\)</span>.</dt>
<dd><p class="first last">Więc rozwiązanie to nie jest asymptotycznie stabilne, ponieważ
jedna z wartości własnych jest dodatnia,
tzn. <span class="math">\(\lambda_{01} \gt 0\)</span>. Dowolnie małe zaburzenie tego
stanu spowoduje ucieczkę układu z tego stanu.</p>
</dd>
</dl>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>dla <span class="math">\((1, 1)\)</span> otrzymujemy:</dt>
<dd><p class="first last"><span class="math">\(\lambda_{11} = i \sqrt{\alpha}, \quad \lambda_{12} = -i\sqrt{\alpha}\)</span>.
Ponieważ wartości własne są urojone, to rozwiązanie jest
stabilne, lecz nie jest asymptotycznie stabilne. Dowolnie małe
zaburzenie tego stanu spowoduje powstanie stanu, który cały
czas będzie w otoczeniu tego stanu <span class="math">\((1, 1)\)</span>, ale do niego
nie dąży. W pobliżu tego stany, trajektorie są periodyczne i
krzywe fazowe powinny być zamknięte.</p>
</dd>
</dl>
</li>
</ol>
<p>Znajdziemy teraz postać  krzywych fazowych. W tym celu podzielimy obustronnie przeskalowane równania Lotki-Volterry:</p>
<div class="math">
\[\frac{dy}{dx}= \frac{\alpha y (x-1)}{x(1-y)}\]</div>
<p>Otrzymliśmy równanie różniczkowe pierwszego rzędu, które rozwiązujemy metodą rozdzielenia zmiennych:</p>
<div class="math">
\[\left(\frac{1}{y} - 1\right) \; dy = \alpha \left(1-\frac{1}{x}\right)\; dx\]</div>
<p>Obustronne całkowanie tego  równania daje następująca postać krzywych fazowych:</p>
<div class="math">
\[\mbox{ln} y -y = \alpha (x- \mbox{ln} x) - H_0\]</div>
<p>gdzie <span class="math">\(H_0\)</span> jest stałą całkowania.  Jej wartość określona jest przez warunki początkowe <span class="math">\(x_0\)</span> oraz <span class="math">\(y_0\)</span>, ale minimalna wartość jest dla  stanu stacjonarnego <span class="math">\((1, 1)\)</span> i wynosi <span class="math">\(H_0 = 1+\alpha\)</span>. Poniżej przedstawiamy kilka krzywych fazowych  dla różnych wartości <span class="math">\(H_0\)</span>. Ponieważ równanie powyższe jest równaniem uwikłanym,  jego graficzną wizualizację  można bardzo łatwo otrzymać korzystając z SAGE w następujący sposób:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s">&#39;x,y&#39;</span><span class="p">)</span> <span class="c">## alfa=2</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">p1</span><span class="o">=</span><span class="n">implicit_plot</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">ln</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">ln</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span><span class="mf">5.5</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;violet&quot;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">p2</span><span class="o">=</span><span class="n">implicit_plot</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">ln</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">ln</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">p3</span><span class="o">=</span><span class="n">implicit_plot</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">ln</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">ln</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;green&quot;</span><span class="p">,</span><span class="n">aspect_ratio</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">show</span><span class="p">(</span><span class="n">p1</span><span class="o">+</span><span class="n">p2</span><span class="o">+</span><span class="n">p3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/cell_1_sage0.png" class="align-center" src="_images/cell_1_sage0.png" />
<p>Po pierwsze, zauważamy że krzywe fazowe są zamknięte, więc z tego wynika, że rozwiązania są funkcjami periodycznymi czasu <span class="math">\(t\)</span>.  Po drugie, zauważamy że wzrost wartości stałej całkowania <span class="math">\(H_0\)</span> powoduje wzrost amplitud oscylacji czasowego przebiegu. Poniżej pokazujemy to explicite rozwiązując numerycznie równania Lotki-Volterry .</p>
<div class="section" id="ewolucja-czasowa-w-modelu-lotki-volterry">
<h3>Ewolucja czasowa w Modelu Lotki-Volterry<a class="headerlink" href="iCSE_BProcnielin02_z119_ofiara_drapiezca.html#ewolucja-czasowa-w-modelu-lotki-volterry" title="Stały odnośnik do tego nagłówka">¶</a></h3>
<p>Przebieg czasowy rozwiązań równań Lotki-Volterry można łatwo otrzymać korzystając z pakietu SAGE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x,y&#39;</span><span class="p">)</span> <span class="c">## warunek początkowy (x0, y0)=(1, 0.3)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">a</span><span class="o">=</span><span class="mi">2</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">T</span> <span class="o">=</span> <span class="n">srange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">sol</span><span class="o">=</span><span class="n">desolve_odeint</span><span class="p">(</span>\
<span class="o">...</span>    <span class="n">vector</span><span class="p">([</span><span class="n">x</span><span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">-</span><span class="n">y</span><span class="p">)]),</span>\
<span class="o">...</span>    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span><span class="n">T</span><span class="p">,[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">line</span><span class="p">(</span> <span class="nb">zip</span> <span class="p">(</span> <span class="n">T</span><span class="p">,</span><span class="n">sol</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span> <span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&#39;green&#39;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">legend_label</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="o">...</span>    <span class="n">line</span><span class="p">(</span> <span class="nb">zip</span> <span class="p">(</span> <span class="n">T</span><span class="p">,</span><span class="n">sol</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span> <span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span><span class="n">legend_label</span><span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/cell_2_sage0.png" class="align-center" src="_images/cell_2_sage0.png" />
<p>Zauważamy, że maksima w populacji drapieżców pojawiają się później niż maksima w populacji ofiar. Jest to dość jasna własność: drapieżniki mają dużo pożywienia i zjadają ofiary.  Łatwy dostęp do pożywienia powoduje szybkie rozmnażanie się drapieżników. Ale to z kolei powoduje, że szybko maleje populacja ofiar i drapieżniki mają utrudniony dostęp do pożywienia i dlatego ich liczba zaczyna maleć. Zmniejszenie się liczby drapieżników powoduje wzrost liczby ofiar. To z kolei powoduje zwiększone zasoby pożywienia dla drapieżników i ich populacja zaczyna wzrastać. I tak powtarza się cykl.</p>
<p>Możemy z powyższych  rozwiązań czasowych  otrzymać krzywą fazową jako punkty na płaszczyźnie o współrzędnych <span class="math">\((x(t_i), y(t_i))\)</span> zmieniając czas od <span class="math">\(t_i=0\)</span> do jakiegoś <span class="math">\(t_i=t_{max}\)</span>.  W SAGE wygląda to tak prosto  jak poniżej:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">list_plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">plotjoined</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<img alt="_images/cell_7_sage01.png" class="align-center" src="_images/cell_7_sage01.png" />
<p>Jak wpływa parametr <span class="math">\(H_0\)</span> na okres oscylacji rozwiązań?   Poniżej pokazujemy wpływ warunków początkowych ( tzn. <span class="math">\(H_0\)</span>) na okres oscylacji.</p>
<p>Jeden warunek początkowy to <span class="math">\((1, 0.8)  --\gt  H1\)</span>. Drugi warunek początkowy jest z powyższego przykładu:   <span class="math">\((1, 0.3) --\gt  H2\)</span>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">H1</span><span class="o">==</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">ln</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.8</span> <span class="o">-</span> <span class="n">ln</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
<div class="math">
\[H1 == 3.02314355131421\]</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">H2</span><span class="o">==</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">ln</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">-</span> <span class="n">ln</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
<div class="math">
\[H2 == 3.50397280432594\]</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x,y&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">a</span><span class="o">=</span><span class="mi">2</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">T</span> <span class="o">=</span> <span class="n">srange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">solu</span><span class="o">=</span><span class="n">desolve_odeint</span><span class="p">(</span>\
<span class="o">...</span>    <span class="n">vector</span><span class="p">([</span><span class="n">x</span><span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">-</span><span class="n">y</span><span class="p">)]),</span>\
<span class="o">...</span>    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span><span class="n">T</span><span class="p">,[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">line</span><span class="p">(</span> <span class="nb">zip</span> <span class="p">(</span> <span class="n">T</span><span class="p">,</span><span class="n">sol</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span> <span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&#39;green&#39;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span><span class="n">legend_label</span><span class="o">=</span><span class="s">&quot;$H_2$&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="o">...</span>    <span class="n">line</span><span class="p">(</span> <span class="nb">zip</span> <span class="p">(</span> <span class="n">T</span><span class="p">,</span><span class="n">solu</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span> <span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span><span class="n">legend_label</span><span class="o">=</span><span class="s">&quot;$H_1&lt;H_2$&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/cell_11_sage0.png" class="align-center" src="_images/cell_11_sage0.png" />
<p>Rozwiązaniom tym odpowiadają krzywe fazowe przedstawione poniżej. Z tych dwóch  rysunków wnioskujemy, że gdy <span class="math">\(H_1 \lt  H_2\)</span> to amplituda oscylacji jest mniejsza i okres oscylacji jest mniejszy.  To odpowiada krzywym fazowym o mniejszym &#8220;obwodzie&#8221;.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">list_plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">plotjoined</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s">&#39;green&#39;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="o">+</span> <span class="n">list_plot</span><span class="p">(</span><span class="n">solu</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">plotjoined</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<img alt="_images/cell_15_sage0.png" class="align-center" src="_images/cell_15_sage0.png" />
</div>
</div>
<div class="section" id="bardziej-realistyczny-model-maya">
<h2>Bardziej realistyczny: Model Maya<a class="headerlink" href="iCSE_BProcnielin02_z119_ofiara_drapiezca.html#bardziej-realistyczny-model-maya" title="Stały odnośnik do tego nagłówka">¶</a></h2>
<p>W modelu Lotki-Volterry występuje 1 stabilny punkt równowagi: gdy w chwili początkowej przeskalowane populacje <span class="math">\(x_0=1, y_0=1\)</span>  to w dowolnej innej chwili, liczba osobników w populacjach nie zmienia się. Natomiast drobne zaburzenia powodują odejście od tego stanu równowagi i pojawiają się oscylacje w obu populacjach. Jeżeli znowu zaburzymy układ, zmienią się także oscylacje, tzn.  ich amplituda i ich okres. Często obserwuje się inny rodzaj zachowania. Mimio, że układ zaburza się w niewielkim stopniu, układ powraca do swego poprzedniego stanu.  Mówimy, że układ jest strukturalnie stabilny. Tej własności nie posiada model Lotki-Volterry.  Przypomnijmy, że model Lotki-Volterry jest  w zasadzie 2-wymiarowym modelem Malthusa:</p>
<div class="math">
\[\frac{dN}{dt} = a N - b N\]</div>
<div class="math">
\[\frac{dP}{dt} = c P - e P\]</div>
<p>w którym procesy rozmnażania i śmierci  są modelowane w najprostszy sposób. My mamy jednak doświadczenie nabyte w uogólnianiu modelu Malthusa dla jednej populacji. Możemy teraz to wykorzystać i podobnie zmodyfikować model Lotki-Volterry:</p>
<ol class="upperalpha simple">
<li>w części dla populacji ofiar uwględniamy model Verhulsta i efekty nasycenia z modelu Ludwiga (w funkcją Hilla)</li>
</ol>
<div class="math">
\[a=r\left(1-\frac{N}{K}\right), \quad \quad bN = b_0 \,\frac{N}{D+N} \;P\]</div>
<ol class="upperalpha simple" start="2">
<li>w części dla populacji drapieżników uwzględniamy  model Verhulsta</li>
</ol>
<div class="math">
\[c  = c_0 \left(1-\frac{P}{K_0} \right)\]</div>
<p>Dlatego w drugim równaniu otrzymamy</p>
<div class="math">
\[c P - e P  = c_0 \left(1-\frac{P}{K_0} \right)\;P - e P = (c_0 - e) P - c_0 \frac{P^2}{K_0} = s P \left(1- \frac{P}{K_1} \right)\]</div>
<p>Zakładamy, że <span class="math">\(s=c_0-e \gt  0\)</span>.  Przeskalowana stała <span class="math">\(K_1 = K_0 (1-e/c_0).\)</span></p>
<p>Parametr <span class="math">\(K_1\)</span> modelujący zasoby pożywienia dla drapieżników jest proporcjonalny do liczby osobników ofiar <span class="math">\(K_1=h_0 N\)</span> (<span class="math">\(h_0 \gt  0\)</span> jest stałą proporcjonalności). Więc ostatecznie dostajemy</p>
<div class="math">
\[c = s \left(1- h \frac{P}{N}\right)\]</div>
<p>gdzie nowy parametr <span class="math">\(h=1/h_0\)</span>.</p>
<p>Uwzględniając powyższe wyrażenia w wyjściowym modelu Malthusa otrzymamy taki oto układ równań:</p>
<div class="math">
\[\frac{dN}{dt} = r \left(1-\frac{N}{K}\right) \; N- b_0 \frac{N}{D+N} \; P\]</div>
<div class="math">
\[\frac{dP}{dt} = s\left(1-h\frac{P}{N}\right)\; P\]</div>
<p>Wszystkie stałe w tym modelu przyjmują dodatnie wartości. Stałych tych jest aż 6: <span class="math">\(r, K, b_0, D, s, h\)</span>. Ile jest istotnych stałych w tym modelu? Musimy umiejętnie dokonać skalowania i wprowadzić wielkości bezwymiarowe. Znowu możemy wykorzystać doświadczenie nabyte w skalowaniu równania Verhulsta, tzn.</p>
<div class="math">
\[x= \frac{N}{K}\]</div>
<p>Wstawiając <span class="math">\(N=K x\)</span> to do wyrażenia w nawiasie w równaniu dla <span class="math">\(P\)</span> widzimy że  drugą zmienną należy skalować w taki oto sposób:</p>
<div class="math">
\[y= h\frac{P}{K}\]</div>
<p>Wówczas otrzymamy:</p>
<div class="math">
\[\frac{dx}{d\tau} = (1-x)\, x - \alpha  \frac{x y}{d+x}\]</div>
<div class="math">
\[\frac{dy}{d\tau} = \beta \left(1- \frac{y}{x}\right) y\]</div>
<p>gdzie  zdefiniowaliśmy  następujące bezwymiarowe wielkości:</p>
<div class="math">
\[\tau = r t, \quad \alpha = \frac{b_0}{h r}, \quad d = \frac{D}{K} , \quad \beta = \frac{s}{r}\]</div>
<p>W wyniku tagiego postepowania otrzymaliśmy układ równań różniczkowych z trzema parametrami. Bezwymiarowy czas skaluje się ze względu na tempo rozmnażania się ofiar. Parametr <span class="math">\(\beta\)</span> to relacja między tempem rozmnażania się drapieżników w stosunku do tempa rozmnażania się ofiar. Jeżeli <span class="math">\(\beta \lt 1\)</span> to tempo rozmnażania się drapieżników jest mniejsze niż tempo rozmnażania sie ofiar i dlatego populacja ofiar może przetrwać. Jeżeli  <span class="math">\(\beta \gt 1\)</span> to tempo rozmnażania się drapieżników jest większe niż  tempo rozmnażania sie ofiar i dlatego populacja ofiar może wyginąć. Ale ponieważ układ jest nieliniowy, to takie proste dywagacje nie muszą być prawidziwe. Sprawdzimy to dokładniej.</p>
<p><strong>STANY STACJONARNE</strong></p>
<p>Stany stacjonarne są określone przez równania:</p>
<div class="math">
\[(1-x)\, x - \alpha  \frac{x y}{d+x} = 0\]</div>
<div class="math">
\[\beta \left(1- \frac{y}{x}\right) y = 0\]</div>
<p>Jeden stan stacjonarny jest łatwo wyznaczyć:</p>
<div class="math">
\[x_0=1, \quad y_0 =0\]</div>
<p>(stan <span class="math">\(x=0\)</span> oczywiście  wykluczmy z rozważań, ponieważ gdy  nie ma ofiar  to i nie ma drapieżników).  Powyższy stan  to stan bez drapieżników, więc stan stacjonarny populacji ofiar jest taki jak w modelu Verhulsta. Czy ten stan jest stabilny?</p>
<p>Inne stany stacjonarne  są określone przez równania:</p>
<div class="math" id="equation-OD1">
<span class="eqno">(1)</span>\[  y=x , \quad \quad  (1-x)   - \alpha  \frac{ y}{d+x} = 0\]</div>
<p>Stąd otrzymujemy równanie dla <span class="math">\(x\)</span> w postaci</p>
<div class="math">
\[x^2 + (\alpha + d -1) x -d =0\]</div>
<p>Jest to równanie kwadratowe, ale należy brać pod uwagę tylko dodatnie  rozwiązania.  Wyróżnik</p>
<div class="math">
\[\Delta = (\alpha + d -1)^2 + 4d \gt  0\]</div>
<p>więc otrzymujemy drugi stan stacjonarny</p>
<div class="math">
\[x_1=  y_1 = \frac{1}{2} \left[- (\alpha + d -1) + \sqrt{\Delta}\right]\]</div>
<p>Zauważmy, że ten stan nie zależy od wartości parametru <span class="math">\(\beta\)</span>.</p>
<p><strong>STABILNOŚĆ STANÓW STACJONARNYCH</strong></p>
<ol class="arabic simple">
<li>Wyznaczamy macierz Jacobiego</li>
</ol>
<div class="math">
\[\begin{split}\quad \quad \quad  J = \begin{bmatrix}\frac{ \partial  f}{\partial x}&amp;  \frac{\partial  f}{\partial y}\\ \frac{\partial  g}{\partial x}&amp;  \frac{\partial  g}{\partial y}  \end{bmatrix}  = \begin{bmatrix}1-2x-\alpha y \frac{d}{(x+d)^2}&amp;  -\alpha \frac{x}{x+d} \\ \frac{\beta y^2}{x^2}&amp;  \beta - \frac{2\beta y}{x}  \end{bmatrix}\end{split}\]</div>
<ol class="arabic simple" start="2">
<li>Wyznaczamy wartości własne macierzy Jacobiego <span class="math">\(|J-\lambda I|=0\)</span>:</li>
</ol>
<ol class="loweralpha simple">
<li>dla stanu stacjonarnego <span class="math">\((1, 0)\)</span> otrzymujemy:</li>
</ol>
<div class="math">
\[\begin{split}\quad \quad \quad  J(1, 0)  =  \begin{bmatrix}-1&amp;  -  \frac{\alpha}{1+d} \\ 0&amp;  \beta \end{bmatrix}\end{split}\]</div>
<p>Stąd wartości własne <span class="math">\(\lambda_{1} = -1, \quad  \lambda_{2} = \beta\)</span>. Więc rozwiązanie to nie jest asymptotycznie  stabilne, ponieważ jedna z wartości własnych jest dodatnia, tzn.  <span class="math">\(\lambda_{2} \gt  0\)</span>. Dowolnie małe zaburzenie tego stanu spowoduje  ucieczkę układu z tego stanu.</p>
<ol class="loweralpha simple" start="2">
<li>dla  drugiego stanu analiza stabilności jest bardziej skomplikowana  ponieważ macierz Jacobiego jest postaci</li>
</ol>
<div class="math">
\[\begin{split}\quad \quad \quad  J(x_1, y_1)  =  \begin{bmatrix}x_1\left[ \frac{\alpha x_1}{(x_1+d)^2} -1\right]&amp;  -  \frac{\alpha x_1}{x_1+d} \\ \beta &amp;  -\beta \end{bmatrix}\end{split}\]</div>
<p>Aby otrzymać wyraz <span class="math">\(J_{11}\)</span> tej macierzy, wykorzystaliśmy równanie <a href="iCSE_BProcnielin02_z119_ofiara_drapiezca.html#equation-OD1">(1)</a> na stan stacjonarny. Zamiast wyznaczyć wartości własne <span class="math">\((\lambda_{1}, \lambda_{2})\)</span> tej macierzy, wystarczy sprawdzić, kiedy część rzeczywista wartości własnych jest ujemna (lub dodatnia).  Ponieważ macierz Jacobiego jest macierzą <span class="math">\(2 \times 2\)</span>, więc otrzymujemy równanie kwadratowe  dla <span class="math">\(\lambda\)</span>. Aby wartości własne miały część rzeczywistą ujemną muszą zachodzić dwie relacje:</p>
<div class="math">
\[\lambda_1 + \lambda_2 \lt 0  \quad \mbox{oraz} \quad \lambda_1 \; \lambda_2 \gt  0, \quad \quad \mbox{to oznacza, że} \quad \mbox{Tr} \, J \lt  0, \quad \quad \mbox{det} \,J \gt  0\]</div>
<dl class="docutils">
<dt><strong>ZADANIE:</strong></dt>
<dd>Udowodnić, że  dla dowolnych (dodatnich) wartości parametrów <span class="math">\(\alpha, \beta,  d\)</span>, drugi warunek  <span class="math">\(\mbox{det} \,J \gt  0\)</span> jest zawsze spełniony.</dd>
</dl>
<p>Pierwszy warunek na stabilność stanu stacjonarnego <span class="math">\((x_1, y_1)\)</span> przyjmuje postać:</p>
<div class="math">
\[b \gt  x_1\left[ \frac{\alpha x_1}{(x_1+d)^2} -1\right] = \phi (\alpha, d)\]</div>
<p>Ponieważ <span class="math">\(x_1\)</span> zależy od 2 parametrów <span class="math">\(\alpha\)</span> i <span class="math">\(d\)</span>, prawa strona przedstawia równanie powierzchni w 3-wymiarowej przestrzeni.</p>
<hr class="docutils" />
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;a b d x y&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">ode_lotka</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">d</span><span class="p">),</span><span class="n">b</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y</span><span class="o">/</span><span class="n">x</span><span class="p">)];</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">show</span><span class="p">(</span><span class="n">ode_lotka</span><span class="p">)</span>
</pre></div>
</div>
<div class="math">
\[\left[-{\left(x - 1\right)} x - \frac{a x y}{d + x}, -{\left(\frac{y}{x} - 1\right)} b y\right]\]</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">y_z_pierwszego</span><span class="o">=</span><span class="n">solve</span><span class="p">(</span><span class="n">ode_lotka</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">y</span><span class="p">,</span><span class="n">solution_dict</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">drugie</span><span class="o">=</span><span class="n">ode_lotka</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">y_z_pierwszego</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">show</span><span class="p">(</span><span class="n">drugie</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">show</span><span class="p">(</span><span class="n">solve</span><span class="p">(</span><span class="n">drugie</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">solution_dict</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">x_0</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">solve</span><span class="p">(</span><span class="n">drugie</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">solution_dict</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">y_0</span><span class="o">=</span><span class="n">y_z_pierwszego</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x</span><span class="p">:</span><span class="n">x_0</span><span class="p">})</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">show</span><span class="p">(</span><span class="n">x_0</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">show</span><span class="p">(</span> <span class="n">y_0</span> <span class="p">)</span>
</pre></div>
</div>
<div class="math">
\[-\frac{{\left(\frac{{\left(d - 1\right)} x + x^{2} - d}{a x} + 1\right)} {\left({\left(d - 1\right)} x + x^{2} - d\right)} b}{a}\]</div>
<div class="math">
\[\left\{x : -\frac{1}{2} \, a - \frac{1}{2} \, d - \frac{1}{2} \, \sqrt{2 \, {\left(a + 1\right)} d + a^{2} + d^{2} - 2 \, a + 1} + \frac{1}{2}\right\}\]</div>
<div class="math">
\[-\frac{1}{2} \, a - \frac{1}{2} \, d + \frac{1}{2} \, \sqrt{2 \, {\left(a + 1\right)} d + a^{2} + d^{2} - 2 \, a + 1} + \frac{1}{2}\]</div>
<div class="math">
\[-\frac{1}{2} \, a - \frac{1}{2} \, d + \frac{1}{2} \, \sqrt{a^{2} + 2 \, a d + d^{2} - 2 \, a + 2 \, d + 1} + \frac{1}{2}\]</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">ode_lotka</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="math">
\[-\frac{a y}{d + x} + \frac{a x y}{{\left(d + x\right)}^{2}} - 2 \, x + 1\]</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">JJ</span><span class="o">=</span><span class="n">jacobian</span><span class="p">(</span><span class="n">ode_lotka</span><span class="p">,[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">show</span><span class="p">(</span><span class="n">JJ</span><span class="p">)</span>
</pre></div>
</div>
<div class="math">
\[\begin{split}\left(\begin{array}{rr}
-\frac{a y}{d + x} + \frac{a x y}{{\left(d + x\right)}^{2}} - 2 \, x + 1 &amp; -\frac{a x}{d + x} \\
\frac{b y^{2}}{x^{2}} &amp; -{\left(\frac{y}{x} - 1\right)} b - \frac{b y}{x}
\end{array}\right)\end{split}\]</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="c">#mamy x0=y0 ;-)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x0&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">JJ0</span><span class="o">=</span><span class="n">JJ</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x</span><span class="p">:</span><span class="n">x0</span><span class="p">,</span><span class="n">y</span><span class="p">:</span><span class="n">x0</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">show</span><span class="p">(</span><span class="n">JJ0</span><span class="p">)</span>
</pre></div>
</div>
<div class="math">
\[\begin{split}\left(\begin{array}{rr}
-\frac{a x_{0}}{d + x_{0}} + \frac{a x_{0}^{2}}{{\left(d + x_{0}\right)}^{2}} - 2 \, x_{0} + 1 &amp; -\frac{a x_{0}}{d + x_{0}} \\
b &amp; -b
\end{array}\right)\end{split}\]</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">show</span><span class="p">(</span><span class="n">JJ0</span><span class="o">.</span><span class="n">trace</span><span class="p">())</span>
</pre></div>
</div>
<div class="math">
\[-\frac{a x_{0}}{d + x_{0}} + \frac{a x_{0}^{2}}{{\left(d + x_{0}\right)}^{2}} - b - 2 \, x_{0} + 1\]</div>
<div class="math">
\[b = x_1\left[ \frac{\alpha x_1}{(x_1+d)^2} -1\right]\]</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">expr_murray</span> <span class="o">=</span> <span class="n">x0</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x0</span><span class="o">/</span><span class="p">(</span><span class="n">x0</span><span class="o">-</span><span class="n">d</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">expr_murray</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="math">
\[{\left(\frac{a x_{0}}{{\left(d - x_{0}\right)}^{2}} - 1\right)} x_{0}\]</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">show</span><span class="p">(</span> <span class="n">JJ0</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x0</span><span class="p">:</span><span class="n">x_0</span><span class="p">})</span><span class="o">+</span><span class="n">b</span> <span class="p">)</span>
</pre></div>
</div>
<div class="math">
\[\begin{split}-\frac{{\left(a + d - \sqrt{2 \, {\left(a + 1\right)} d + a^{2} + d^{2} - 2 \, a + 1} - 1\right)} a}{a - d - \sqrt{2 \, {\left(a + 1\right)} d + a^{2} + d^{2} - 2 \, a + 1} - 1} \\ + \frac{{\left(a + d - \sqrt{2 \, {\left(a + 1\right)} d + a^{2} + d^{2} - 2 \, a + 1} - 1\right)}^{2} a}{{\left(a - d - \sqrt{2 \, {\left(a + 1\right)} d + a^{2} + d^{2} - 2 \, a + 1} - 1\right)}^{2}} \\ + a + d - \sqrt{2 \, {\left(a + 1\right)} d + a^{2} + d^{2} - 2 \, a + 1}\end{split}\]</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">p</span><span class="o">=</span><span class="p">{</span><span class="n">a</span><span class="p">:</span><span class="mf">1.23</span><span class="p">,</span><span class="n">d</span><span class="p">:</span><span class="mf">1.01</span><span class="p">}</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">show</span><span class="p">(</span> <span class="n">JJ0</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x0</span><span class="p">:</span><span class="n">x_0</span><span class="p">})</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">expr_murray</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x0</span><span class="p">:</span><span class="n">x_0</span><span class="p">})</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<div class="math">
\[\begin{split}-b - 0.404054289657954 \\
1.35696399470668\end{split}\]</div>
<div class='sage'><script type='text/x-sage'>var('a,d,b,x,y,t')
ode_lotka=[x*(1-x)-(a*x*y)/(x+d),b*y*(1-y/x)];
#Murray eq. 3.28
f(a,d)=(a-sqrt(  (1-a-d)^2+4*d) )*(1+a+d-sqrt((1-a-d)^2+4*d))/(2*a)
@interact
def myf(a_in = slider(0,2,0.01,default=1.0),b_in = slider(0,2,0.01,default=0.1),d_in = slider(0,2,0.01,default=0.1) ):
    p={a:a_in,d:d_in,b:b_in}
    ode_lotka_num=[i.subs(p) for i in ode_lotka]
    pkt_osob=solve(ode_lotka_num,x,y, solution_dict=True)
    x_osobliwy,y_osobliwy=0,0
    plt_pkt=[]
    for n_pkt,pkt in enumerate(pkt_osob):
       x_osobliwy,y_osobliwy=pkt[x].n(),pkt[y].n()
       plt_pkt.append(point([x_osobliwy,y_osobliwy],size=30,color='red') )
       JJ=jacobian(ode_lotka_num,[x,y])
       JJ0=JJ.subs({x:x_osobliwy+1e-8,y:y_osobliwy+1e-8})
       print n_pkt+1,":",x_osobliwy.n(digits=3),y_osobliwy.n(digits=3),vector(JJ0.eigenvalues()).n(digits=3)
       if pkt[x]>0 and pkt[y]>0 :
           print "Czy pkt. jest stabilny?",bool(b_in>f(a_in,d_in))
    plt1 = plot_vector_field(vector(ode_lotka_num)/vector(ode_lotka_num).norm(),(x,-0.1,2),(y,-0.1,2))
    #plt2a = implicit_plot(ode_lotka_num[0],(x,-0.10,2),(y,-0.10,2),color='green')
    plt2a = plot(solve(ode_lotka_num[0],y)[0].rhs(),(x,-0.10,2),ymin=-0.10,ymax=2,color='green')
    show(ode_lotka_num)
    plt2b = implicit_plot(ode_lotka_num[1],(x,-0.10,2),(y,-.010,2),color='blue',xmin=-0.03)
...
    T = srange(0,123,0.1)
    sol1=desolve_odeint(vector(ode_lotka_num), [0.82,0.85], T, [x,y])
    plt_solution = list_plot(sol1.tolist(), plotjoined=1,color='brown')
...
    show(sum(plt_pkt)+plt1+plt2a+plt2b+plt_solution)</script></div><div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;a,d&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">d</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span>  <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="o">-</span><span class="n">d</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">d</span><span class="p">)</span> <span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="o">+</span><span class="n">d</span><span class="o">-</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="o">-</span><span class="n">d</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">d</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">show</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">implicit_plot</span><span class="p">(</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">d</span><span class="p">),(</span><span class="n">d</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">.</span><span class="mi">61</span><span class="p">),(</span><span class="n">a</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">aspect_ratio</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>  <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">axes_labels</span><span class="o">=</span><span class="p">[</span><span class="s">r&#39;$d$&#39;</span><span class="p">,</span><span class="s">&#39;$a$&#39;</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
<div class="math">
\[\left( a, d \right) \ {\mapsto} \ \frac{{\left(a - \sqrt{{\left(a + d - 1\right)}^{2} + 4 \, d}\right)} {\left(a + d - \sqrt{{\left(a + d - 1\right)}^{2} + 4 \, d} + 1\right)}}{2 \, a}\]</div>
<img alt="_images/cell_20_sage0.png" class="align-center" src="_images/cell_20_sage0.png" />
<p>Pod tą płaszczyzną</p>
<div class="math">
\[b = x_1\left[ \frac{\alpha x_1}{(x_1+d)^2} -1\right] = \phi (\alpha, d)\]</div>
<p>mamy cykl graniczny:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">assume</span><span class="p">(</span><span class="n">a</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">sol1</span><span class="o">=</span><span class="n">solve</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">d</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">show</span><span class="p">(</span><span class="n">sol1</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">dm_expr</span><span class="o">=</span><span class="n">sol1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>
<span class="n">sage</span><span class="p">:</span> <span class="kn">import</span> <span class="nn">sympy</span>
<span class="n">sage</span><span class="p">:</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">b2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span> <span class="n">sympy</span><span class="o">.</span><span class="n">lambdify</span><span class="p">((</span><span class="n">a</span><span class="p">,</span><span class="n">d</span><span class="p">),</span> <span class="n">sympy</span><span class="o">.</span><span class="n">sympify</span><span class="p">(</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">d</span><span class="p">)</span>  <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">bm</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span> <span class="n">sympy</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">a</span><span class="p">,</span>    <span class="n">sympy</span><span class="o">.</span><span class="n">sympify</span><span class="p">(</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>  <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">dm</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span> <span class="n">sympy</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">a</span><span class="p">,</span>    <span class="n">sympy</span><span class="o">.</span><span class="n">sympify</span><span class="p">(</span> <span class="n">dm_expr</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="n">sage</span><span class="p">:</span> <span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">sage</span><span class="p">:</span> <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
<span class="n">sage</span><span class="p">:</span> <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">step</span> <span class="o">=</span> <span class="mf">0.04</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">maxval</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s">&#39;3d&#39;</span><span class="p">,</span><span class="n">azim</span><span class="o">=</span><span class="mi">134</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">115</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.00</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mi">35</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="c"># transform them to cartesian system</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="o">=</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">X</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">X</span><span class="p">))</span>
<span class="n">sage</span><span class="p">:</span> <span class="c">#Y[:,i((X[7,0]**2+4*X[7,0])**0.5 - (1+X[7,0]) )</span>
<span class="n">sage</span><span class="p">:</span> <span class="c">#0.99*d(:,i)*((a1.^2+4.*a1)^0.5 - (1+a1) )</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">b2</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="c">#ax.plot_surface(X, Y, Z,  cmap=cm.jet)</span>
<span class="n">sage</span><span class="p">:</span> <span class="c">#ax.plot_wireframe(X, Y, Z)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_zlim3d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim3d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim3d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">7</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">r&#39;$a$&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">r&#39;$d$&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s">r&#39;$b(a,d)$&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dm</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">6</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span><span class="o">.</span><span class="mi">92</span><span class="p">),</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">bm</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>  <span class="n">color</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="n">elev</span><span class="o">=</span><span class="mi">35</span><span class="p">,</span> <span class="n">azim</span><span class="o">=</span><span class="mi">134</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&quot;1.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="math">
\[\left[d = -\sqrt{a + 4} \sqrt{a} - a - 1, d = \sqrt{a + 4} \sqrt{a} - a - 1, d = -a + \sqrt{2 \, {\left(a + 1\right)} d + a^{2} + d^{2} - 2 \, a + 1} - 1\right]\]</div>
<img alt="_images/cell_21_1.png" class="align-center" src="_images/cell_21_1.png" />
<p><strong>Rozwiązania dążące do stabilnego stanu stacjonarnego:</strong>  <span class="math">\(a \in (0, 0.5), \beta \gt  0, d \gt 0\)</span></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x,y&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.1</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">T</span> <span class="o">=</span> <span class="n">srange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">sol2</span><span class="o">=</span><span class="n">desolve_odeint</span><span class="p">(</span>\
<span class="o">...</span>    <span class="n">vector</span><span class="p">([</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">d</span><span class="p">)),</span> <span class="n">b</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y</span><span class="o">/</span><span class="n">x</span><span class="p">)]),</span>\
<span class="o">...</span>    <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span><span class="n">T</span><span class="p">,[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">line</span><span class="p">(</span> <span class="nb">zip</span> <span class="p">(</span> <span class="n">T</span><span class="p">,</span><span class="n">sol2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span> <span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&#39;green&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">legend_label</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="o">...</span>    <span class="n">line</span><span class="p">(</span> <span class="nb">zip</span> <span class="p">(</span> <span class="n">T</span><span class="p">,</span><span class="n">sol2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span> <span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span><span class="n">legend_label</span><span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/cell_22_sage0.png" class="align-center" src="_images/cell_22_sage0.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.1</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">F</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">=</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">d</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">G</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y</span><span class="o">/</span><span class="n">x</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">T</span> <span class="o">=</span> <span class="n">srange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">sol1</span><span class="o">=</span><span class="n">desolve_odeint</span><span class="p">(</span><span class="n">vector</span><span class="p">([</span><span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">]),</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],</span> <span class="n">T</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">list_plot</span><span class="p">(</span><span class="n">sol1</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">plotjoined</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<img alt="_images/cell_24_sage0.png" class="align-center" src="_images/cell_24_sage0.png" />
<p><strong>Rozwiązania dążące do stabilnego cyklu granicznego:</strong>  <span class="math">\(a \gt  0.5 , \beta \gt  0, d \gt 0\)</span></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x,y&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.1</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">T</span> <span class="o">=</span> <span class="n">srange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">sol2</span><span class="o">=</span><span class="n">desolve_odeint</span><span class="p">(</span>\
<span class="o">...</span>    <span class="n">vector</span><span class="p">([</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">d</span><span class="p">)),</span> <span class="n">b</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y</span><span class="o">/</span><span class="n">x</span><span class="p">)]),</span>\
<span class="o">...</span>    <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span><span class="n">T</span><span class="p">,[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">line</span><span class="p">(</span> <span class="nb">zip</span> <span class="p">(</span> <span class="n">T</span><span class="p">,</span><span class="n">sol2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span> <span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&#39;green&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">legend_label</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span><span class="o">+</span>\
<span class="o">...</span>    <span class="n">line</span><span class="p">(</span> <span class="nb">zip</span> <span class="p">(</span> <span class="n">T</span><span class="p">,</span><span class="n">sol2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span> <span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span><span class="n">legend_label</span><span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/cell_26_sage0.png" class="align-center" src="_images/cell_26_sage0.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.1</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">F</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">=</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">d</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">G</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y</span><span class="o">/</span><span class="n">x</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">T</span> <span class="o">=</span> <span class="n">srange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">250</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">sol1</span><span class="o">=</span><span class="n">desolve_odeint</span><span class="p">(</span><span class="n">vector</span><span class="p">([</span><span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">]),</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],</span> <span class="n">T</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">list_plot</span><span class="p">(</span><span class="n">sol1</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">plotjoined</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<img alt="_images/cell_25_sage01.png" class="align-center" src="_images/cell_25_sage01.png" />
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <div class="sphinxlocaltoc">
  <h3><a href="index.html">Spis treści</a></h3>
  <ul>
<li><a class="reference internal" href="iCSE_BProcnielin02_z119_ofiara_drapiezca.html#">Modele oddziałujących populacji: ofiara - drapieżca</a><ul>
<li><a class="reference internal" href="iCSE_BProcnielin02_z119_ofiara_drapiezca.html#model-lotki-volterry">Model Lotki-Volterry</a><ul>
<li><a class="reference internal" href="iCSE_BProcnielin02_z119_ofiara_drapiezca.html#ewolucja-czasowa-w-modelu-lotki-volterry">Ewolucja czasowa w Modelu Lotki-Volterry</a></li>
</ul>
</li>
<li><a class="reference internal" href="iCSE_BProcnielin02_z119_ofiara_drapiezca.html#bardziej-realistyczny-model-maya">Bardziej realistyczny: Model Maya</a></li>
</ul>
</li>
</ul>

  </div>
  <h4>Poprzedni temat</h4>
  <p class="topless"><a href="iCSE_BProcnielin01_z118_modele_jednowymiarowe.html"
                        title="poprzedni rozdział">Dynamika populacyjna: ciągłe modele jednowymiarowe</a></p>
  <h4>Następny temat</h4>
  <p class="topless"><a href="iCSE_BProcnielin04_z122_kinetyka_chemiczna.html"
                        title="następny rozdział">Kinetyka reakcji chemicznych</a></p>
<div id="searchbox" style="display: none">
  <h3>Szybkie wyszukiwanie</h3>
    <form class="search" action="http://visual.icse.us.edu.pl/PNB/search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Szukaj" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Wprowadź szukany termin lub nazwę modułu, klasy lub funkcji.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  </div>
  <div class="relbar-bottom">
    
    <div class="related">
      <h3>Nawigacja</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="iCSE_BProcnielin04_z122_kinetyka_chemiczna.html" title="Kinetyka reakcji chemicznych"
             >dalej</a></li>
        <li class="right" >
          <a href="iCSE_BProcnielin01_z118_modele_jednowymiarowe.html" title="Dynamika populacyjna: ciągłe modele jednowymiarowe"
             >wstecz</a> &nbsp; &nbsp;</li>
  <li><a href="index.html">Procesy nieliniowe w Biologii</a> &raquo;</li>
   
      </ul>
    </div>
  </div>
  
  <div class="footer">
    <a class="logo" href="../../icse.us.edu.pl/index.html" target="_blank"><img src="_static/logo-icse.png" alt="ICSE"/></a><br/>
    &copy; Copyright 2013, Jerzy Łuczka, Marcin Kostur.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.2.
  </div>
  </body>
</html>