

  <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Równania reakcji-dyfuzji &mdash; Procesy nieliniowe w Biologii</title>
    
    <link rel="stylesheet" href="_static/cloud.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Noticia+Text|Open+Sans|Droid+Sans+Mono&subset=latin,latin-ext" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     'I',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/jquery.cookie.js"></script>
    <script type="text/javascript" src="_static/cloud.js"></script>

	<script src="http://sagecell.icse.us.edu.pl:6363/static/jquery.min.js"></script>
	<script src="http://sagecell.icse.us.edu.pl:6363/static/embedded_sagecell.js"></script>
	
	<!-- <script src="http://sagecell.sagemath.org/static/jquery.min.js"></script> -->
        <!-- <script src="http://sagecell.sagemath.org/static/embedded_sagecell.js"></script> -->


	<script>sagecell.makeSagecell({inputLocation: ".sage",
                                       evalButtonText: 'Wykonaj',
                                       linked: true});</script>


	<style type="text/css">
		.sagecell .CodeMirror-scroll {
			overflow-y: hidden;
			overflow-x: auto;
		}
		.sagecell .CodeMirror {
			height: auto;
		}
	</style>

    
    <link rel="top" title="Procesy nieliniowe w Biologii" href="index.html" />
    <link rel="next" title="Modele epidemii" href="iCSE_BProcnielin06_z155_modele_epidemii.html" />
    <link rel="prev" title="Kinetyka reakcji chemicznych" href="iCSE_BProcnielin04_z122_kinetyka_chemiczna.html" />
 
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1">
  </head>
  <body>
  <div class="relbar-top">
    
    <div class="related">
      <h3>Nawigacja</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="iCSE_BProcnielin06_z155_modele_epidemii.html" title="Modele epidemii"
             accesskey="N">dalej</a></li>
        <li class="right" >
          <a href="iCSE_BProcnielin04_z122_kinetyka_chemiczna.html" title="Kinetyka reakcji chemicznych"
             accesskey="P">wstecz</a> &nbsp; &nbsp;</li>
  <li><a href="index.html">Procesy nieliniowe w Biologii</a> &raquo;</li>
   
      </ul>
    </div>
  </div>
  
  <div class="content">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="rownania-reakcji-dyfuzji">
<h1>Równania reakcji-dyfuzji<a class="headerlink" href="iCSE_BProcnielin05_z125_reakcja_dyfuzja.html#rownania-reakcji-dyfuzji" title="Stały odnośnik do tego nagłówka">¶</a></h1>
<p>Dotychczas analizowaliśmy modele dynamiki populacyjnej oraz kinetykę reakcji chemicznych bez uwzględnienia zjawisk rozprzestrzeniania się populacji lub substancji chemicznych na powierzchni czy w przestrzeni. Interesowało nas tylko zachowanie się układu w czasie, a nie w przestrzeni. Oznacza to, że modelowanie oparte było na równaniach różniczkowych zwyczajnych (występują tylko pochodne ze względu na czas) . Uwzględnienie zjawisk związanych z przestrzennymi zmianami modeluje się z pomocą równań różniczkowych cząstkowych (występują pochodne ze względu na zmienne przestrzenne).  Poniższy przykład przybliży nam sposób takiego modelowania.</p>
<p><strong>Przykład: zjawisko dyfuzji</strong></p>
<p>Wrzućmy kroplę farby akwarelowej do pojemnika z wodą. Zaobserwujemy, że z upływem czasu cząsteczki farby rozpływają się w coraz to większym obszarze i po odpowiednio długim czasie wypełniaja całkowicie pojemnik z wodą. To, co obserwujemy jest zjawiskiem dyfuzji lub, jak niektórzy nazywają, ruchem cząstek Browna. Jest to zjawisko natury molekularnej, spowodowane nieregularnymi (chaotycznymi) zderzeniami cząsteczek wody i cząsteczek farby.  Zauważamy też, że podwyższenie temperatury wody powoduje szybsze mieszanie się obu substancji. W języku fizyki statystycznej oznacza to, że współczynnik dyfuzji ulega zwiększeniu, rosnie natężenie fluktuacji termicznych i następuje przyspieszenie procesu dyfuzji.W języki matematyki, proces ten jest opisany za pomocą równania:</p>
<div class="math">
\[\frac{\partial c(\vec r, t)}{\partial t} = D \Delta c(\vec r, t) = D \left[\frac{\partial^2 }{\partial x^2} + \frac{\partial^2 }{\partial y^2} + \frac{\partial ^2}{\partial z^2} \right] c(\vec r, t)\]</div>
<p>gdzie <span class="math">\(c(\vec r, t)\)</span> jest koncentracją substancji  w chwili czasu <span class="math">\(t\)</span> w punkcie przestrzeni określonej przez wektor wodzący <span class="math">\(\vec r = (x, y, z)\)</span>. Zwracamy uwagę, że proces dyfuzji jest opisany operatorem Laplace&#8217;a (dwukrotnym różniczkowaniem).</p>
<p>Dla początkowej koncentracji <span class="math">\(c(x, y, z, 0)\)</span>  skupionej punktowo w początku układu odniesienia <span class="math">\(XYZ\)</span>, rozwiązanie równania dyfuzji ma postać</p>
<div class="math">
\[c(x, y, z, t) = [4\pi Dt]^{-3/2} \; exp\left[-\frac{x^2+y^2+z^2}{4Dt}\right]\]</div>
<p>Gdyby proces przebiegał tylko w jednym kierunku przestrzennym, np. wzdłuż osi <span class="math">\(OX\)</span> to odpowiednie równanie ma postać</p>
<div class="math">
\[\frac{\partial c(x, t)}{\partial t} =  D  \frac{\partial^2 }{\partial x^2}  c(x, t)  = D  \frac{\partial^2  c(x, t) }{\partial x^2}\]</div>
<p>Jego rozwiązaniem jest funkcja</p>
<div class="math">
\[c(x,  t) = [4\pi Dt]^{-1/2} \; exp\left[-\frac{x^2}{4Dt}\right]\]</div>
<p>Otrzymujemy więc następującą receptę na uwzględnienie dyfuzyjnego (losowego) rozprzestrzeniania się populacji lub substancji chemicznej:</p>
<p>Do równań opisujących dynamikę populacji dodaj jeszcze wyraz z pochodnymi drugiego rzędu względem zmiennych przestrzennych. Jeżeli zmiany mogą zachodzić tylko w jednym kierunku przestrzennym, to dodajemy wyraz analogiczny jak po prawej stronie powyższego równania. Gdyby zmiany mogły zachodzić na płaszczyżnie, to dodajemy wyraz typu:</p>
<div class="math">
\[+  D \left[ \frac{\partial^2 }{\partial  x^2}  + \frac{\partial^2 }{\partial y^2} \right] c(x, y, t)\]</div>
<p>Rozwiązaniem 2-wymiarowego równania dyfuzji jest funkcja</p>
<div class="math">
\[c(x, y, t) = [4\pi Dt]^{-2/2} \; \exp\left[-\frac{x^2+y^2}{4Dt}\right] =\frac{1}{4\pi Dt}  \; \exp\left[-\frac{x^2+y^2}{4Dt}\right]\]</div>
<div class='sage'><script type='text/x-sage'>var('x,y,t')
c(x,y,t)=1/(4*pi*t)*exp(-(x^2+y^2)/(4*t) )
plts = [ plot3d(c(x,y,t), (x,-4,4), (y,0,8),rgbcolor = hue(t/2.0)) for t in [0.5,1.0,1.5,2.0]]
@interact
def _(viewer=['tachyon','jmol','canvas3d']):
    show(sum(plts),viewer=viewer)</script></div><div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="k">def</span> <span class="nf">plt_t</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
<span class="o">...</span>       <span class="n">cmax</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="o">...</span>       <span class="k">return</span> <span class="n">contour_plot</span><span class="p">(</span> <span class="n">c</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="p">,(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),(</span><span class="n">y</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">contours</span><span class="o">=</span><span class="n">srange</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="n">cmax</span><span class="p">,</span><span class="n">cmax</span><span class="o">/</span><span class="mf">20.0</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="s">&#39;spectral&#39;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">times</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.9</span><span class="p">]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">html</span><span class="o">.</span><span class="n">table</span><span class="p">([[</span><span class="s">&quot;t=</span><span class="si">%0.2f</span><span class="s">&quot;</span><span class="o">%</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times</span><span class="p">],[</span><span class="n">plt_t</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times</span><span class="p">]])</span>
</pre></div>
</div>
<img alt="_images/cell_6_sage01.png" class="align-center" src="_images/cell_6_sage01.png" />
<img alt="_images/cell_6_sage1.png" class="align-center" src="_images/cell_6_sage1.png" />
<img alt="_images/cell_6_sage2.png" class="align-center" src="_images/cell_6_sage2.png" />
<p>Wszystkie dotychczas rozważane modele (Malthusa, Verhuslta,  autokatalizy, Lotki-Volterry, Maya, Biełousowa-Żabotyńskiego) mogą być  uogólnione na przypadek przestrzennych zmian. Dla przykładu, jeżeli  równanie dynamiki populacyjnej ma postać</p>
<div class="math">
\[\frac{dN(t)}{dt} = F(N(t))\]</div>
<p>to odpowiednie równanie uwzględniające proces dyfuzji ma postać</p>
<div class="math">
\[\frac{\partial N(\vec r, t)}{\partial t} = F(N(\vec r, t) ) +  D  \Delta N(\vec r, t)\]</div>
<p>gdzie w zależności od zagadnienia, laplasjan jest w jednym, dwóch lub trzech wymiarach.  <strong>Tego typu równanie nazywa się równaniem reakcji-dyfuzji.</strong></p>
<p>Rozważamy poniżej dwa modele: model Malthusa i model Verhulsta.</p>
</div>
<div class="section" id="model-malthusa-z-migracja-rownanie-skellama">
<h1>Model Malthusa z migracją: Równanie Skellama<a class="headerlink" href="iCSE_BProcnielin05_z125_reakcja_dyfuzja.html#model-malthusa-z-migracja-rownanie-skellama" title="Stały odnośnik do tego nagłówka">¶</a></h1>
<p>Standardowy model Malthusa to najprostszy model wzrostu lub zaniku populacji opisany  przez  równanie różniczkowe</p>
<div class="math">
\[\frac{dN(t)}{dt} = k N(t)\]</div>
<p>Jeżeli populacja może przemieszczać się losowo na płaszczyźnie <span class="math">\(XY\)</span> to ogólniona wersja tego równania ma postać</p>
<div class="math">
\[\frac{dN(x, y, t)}{dt} = k N(x, y, t) +   D \left[ \frac{\partial^2  }{\partial  x^2}  + \frac{\partial^2 }{\partial y^2} \right] N(x, y,  t)\]</div>
<p>gdzie teraz <span class="math">\(N(x, y,  t)\)</span> ma interpretację koncentracji populacji  (substancji chemicznej) w chwili czasu <span class="math">\(t\)</span> w punkcie o współrzędnych  <span class="math">\((x, y)\)</span>, czyli liczby osobników na jednostke powierzchni. Jest to jeden  z prostszych  przykładów  układu,  który nazywamy równaniem  reakcji-dyfuzji. W literaturze, powyższe równanie  nazywa się równaniem  Skellama, który w 1951 roku  zaproponował ten model jako model inwazji  gatunku. Zastosował go do opisu inwazji piżmaka w Europie.</p>
<img alt="http://upload.wikimedia.org/wikipedia/commons/thumb/3/35/Bisamratte-drawing.jpg/250px-Bisamratte-drawing.jpg" class="align-center" src="http://upload.wikimedia.org/wikipedia/commons/thumb/3/35/Bisamratte-drawing.jpg/250px-Bisamratte-drawing.jpg" />
<p><a class="reference external" href="http://pl.wikipedia.org/w/index.php?title=Plik:Bisamratte-drawing.jpg&amp;filetimestamp=20041114193425">http://pl.wikipedia.org/w/index.php?title=Plik:Bisamratte-drawing.jpg&amp;filetimestamp=20041114193425</a></p>
<p>Do Europy  piżmaki sprowadzone zostały na początku XX w. z  Ameryki  Północnej  przez księcia Colloredo-Mansfelda jako zwierzę futerkowe.   Cała dzisiejsza europejska populacja  dziko żyjących piżmaków pochodzi  od kilku osobników, które w 1905 roku uciekły z  farmy  położonej w  Czechach, 40 km na południowy zachód od Pragi.   Na ziemiach polskich  pojawił się w latach 30. XX w.</p>
<p>W modelu rozpatrujemy tylko takie przypadki że <span class="math">\(N(x, y,  t) \ge 0\)</span>.   Nie jest to jeszcze kompletne sformułowanie problemu. Należy  sprecyzować:</p>
<ol class="arabic simple">
<li>warunek początkowy <span class="math">\(N(x, y, 0)= N_0(x, y)\)</span></li>
<li>warunki brzegowe</li>
</ol>
<p>Właściwe warunki brzegowe są często trudne do zdefiniowania. Na pewno  na brzegach obszaru  koncentracja <span class="math">\(N(\pm \infty, t)\)</span> powinna  przyjmować ograniczone wartości.  Ale to niekoniecznie musi wystarczać,  aby rozwiązania posiadały poprawne własności i były pozbawione  artefaktów.</p>
<p>Powyższe równanie reakcji-dyfuzji jest  tak trudne (łatwe)  do  analizy jak równanie dyfuzji. Aby to zobaczyć, dokonamy podstawienia:</p>
<div class="math">
\[N(x, y, t)=e^{kt} c(x, y, t)\]</div>
<p>Wstawiając je  do równania reakcji-dyfuzji, widzimy że nowa funkcja <span class="math">\(c(x, y, t)\)</span> spełnia równanie</p>
<div class="math">
\[\frac{d c(x, y, t)}{dt} =   D \left[ \frac{\partial^2  }{\partial   x^2}  + \frac{\partial^2 }{\partial y^2} \right] c(x, y,  t)\]</div>
<p>czyli równanie dyfuzji w dwu-wymiarowej przestrzeni. Rozwiązanie tego  równania jest przedstawione powyżej. Więc funkcja <span class="math">\(N(x, y, t)\)</span> ma  postać</p>
<div class="math">
\[N(x, y, t)=e^{kt} c(x, y, t) =  \frac{N_0}{4\pi Dt}  \; exp\left[kt -\frac{x^2+y^2}{4Dt}\right]\]</div>
<p>gdzie stała <span class="math">\(N_0=N(0)\)</span> jest liczbą osobników w populacji w chwili początkowej <span class="math">\(t=0\)</span>.</p>
<p>Ponieważ koncentracja <span class="math">\(N(x, y, t)\)</span> populacji ma interpretację liczby osobników na jednostkę powierzchni, to</p>
<div class="math">
\[\int_{-\infty}^{\;\infty} \;\int_{-\infty}^{\;\infty} N(x, y, t) \,dx \,dy = N(t) = N(0) e^{kt}\]</div>
<p>Zauważmy, że ewolucja koncentracji populacji zależy tylko od położenia w taki oto sposób</p>
<div class="math">
\[N(x, y, t)= N(r ,t) = \frac{N_0}{4\pi Dt}  \; exp\left[kt -\frac{r^2}{4Dt}\right]\]</div>
<p>gdzie</p>
<div class="math">
\[r^2=x^2+y^2\]</div>
<p>jest  miarą odległości od początku układu odniesienia.</p>
<p>Analizę własności <span class="math">\(N(r,  t)\)</span> można łatwo przeprowadzić korzystając z możliwości Sage.  Są one przedstawione graficznie poniżej.</p>
<div class='sage'><script type='text/x-sage'>g(x,t) = (1/(4*pi*t))*exp(t-x^2/(4*t))
@interact
def _(t=slider(0.1,5,0.01)):
    pr0 = plot( g(x,0.1),(x,0,10),color='black' )
    prt = plot( g(x,t),(x,0,10),fill=True )
    (pr0+prt).show(figsize=5)</script></div><p>Obserwujemy następującą ewolucję populacji:</p>
<ol class="upperalpha simple">
<li>W pewnej umownej chwili początkowej rozkład populacji ma określoną formę (powyżej:  dla t=0.1).</li>
<li>Wraz z upływem czasu populacja rozprzestrzenia się i jej koncentracja wokół <span class="math">\(r=0\)</span>  (w otoczeniu wyjściowego największego skupiska)  zaczyna maleć:  osobniki rozchodzą się, tempo urodzin jest na razie niewielkie.</li>
<li>Po pewnym czasie koncentracja wokół  <span class="math">\(r=0\)</span> przyjmuje minimalną wielkość, a następnie wraz z upływem czasu zaczyna wzrastać (narasta tempo urodzin). Jednocześnie populacja rozprzestrzenia się zajmując coraz to większy obszar.</li>
<li>Następnie obserwujemy,  że  istnieje taka chwila czasu, gdy  koncentracja wokół położenia <span class="math">\(r=0\)</span> przekracza wartość początkową i dalej wzrasta w coraz to większym tempie, jednocześnie rozprzestrzeniając się na coraz to większym obszarze. Obserwujemy  inwazję populacji. Dalej jest już jak w kiepskim horrorze. Tym nie mniej, scenariusz  ten wydaje się dość rozsądny i w pewnych warunkach całkiem dobrze opisuje w ograniczonym przedziale czasowym inwazję populacji.</li>
</ol>
<p>Pełniejsza analiza tego modelu jest przedstawiona w książce:</p>
<p>Nanako Shigesada and Kohkichi Kawasaki,  <em>Biological Invasion: Theory and Practice</em>  (Oxford University Press, 2001)</p>
</div>
<div class="section" id="model-verhulsta-z-migracja-rownanie-fishera-kolmogorowa">
<h1>Model Verhulsta z migracją: Równanie Fishera-Kołmogorowa<a class="headerlink" href="iCSE_BProcnielin05_z125_reakcja_dyfuzja.html#model-verhulsta-z-migracja-rownanie-fishera-kolmogorowa" title="Stały odnośnik do tego nagłówka">¶</a></h1>
<p>Model Verhulsta opisuje ewolucję populacji w przypadku ograniczonych zasobów pożywienia w środowisku, w którym żyje dana populacja:</p>
<div class="math">
\[\frac{dn(t)}{dt} = r n(t) \; [1- n(t)]\]</div>
<p>gdzie przeskalowana koncentracja <span class="math">\(n(t) = N(t)/K\)</span> i parametr <span class="math">\(K\)</span> nazywa sie pojemnością środowiska.</p>
<p>Model ten opisuje też kinetykę dwóch reakcji autokatalitycznych:</p>
<div class="math">
\[A + X {\Longleftrightarrow}  2X , \quad \quad \mbox{lub reakcji} \quad  A+X {\Longleftrightarrow} 2X, \quad B+X \rightarrow C\]</div>
<p>Jeżeli uwzględnimy proces rozprzestrzeniania się dyfuzyjnego, model ten przyjmuje postać</p>
<div class="math">
\[\frac{\partial n(\vec r, t)}{\partial t} =  r n(\vec r, t) \;[1-  n(\vec r, t)] +  D  \Delta n(\vec r, t)\]</div>
<p>W przypadku dynamiki populacyjnej, powinniśmy rozważać migrację na płaszczyżnie (laplasjan w dwóch wymiarach), a w przypadku substancji chemicznych - dyfuzję przestrzenną (pełny trójwymiarowy laplasjan). Oba realistyczne przypadki są wyjątkowo skomplikowane. Dlatego upraszczamy model i redukujemy zagadnienia do przypadku jednowymiarowej dyfuzji i  poniżej rozważamy następujące równanie</p>
<div class="math">
\[\frac{\partial n(x, t)}{\partial t} = r n(x, t) \;[1-  n(x, t)] +    D \frac{\partial^2   n(x, t)}{\partial  x^2}\]</div>
<p>Równanie to nazywa się równaniem Fishera-Kołmogorowa.</p>
<p>Jak zwykle w modelu tym rozpatrujemy tylko takie przypadki że <span class="math">\(n(x,  t) \ge 0\)</span>.  Należy jeszcze zadać:</p>
<ol class="arabic simple">
<li>rozkład  początkowy populacji <span class="math">\(n(x, t= 0)= n_0(x)\)</span></li>
<li>warunki brzegowe dla <span class="math">\(n(\pm\infty, t)\)</span></li>
</ol>
<p>Warunki brzegowe sformułujemy później.</p>
<div class="section" id="analiza-rownania-fishera-kolmogorowa">
<h2>Analiza równania Fishera-Kołmogorowa<a class="headerlink" href="iCSE_BProcnielin05_z125_reakcja_dyfuzja.html#analiza-rownania-fishera-kolmogorowa" title="Stały odnośnik do tego nagłówka">¶</a></h2>
<ol class="upperroman simple">
<li>Zauważmy, że funkcje stałe <span class="math">\(n(x,t) = n_{0} = 0\)</span> oraz <span class="math">\(n(x, t) = n_{1} = 1\)</span> są rozwiązanami tego równania. Są to te same stany stacjonarne, które są obecne w przypadku modelu Verhulsta bez dyfuzji.</li>
<li>Równanie powyższe można przeskalować w następujący sposób:</li>
</ol>
<div class="math">
\[\tau = rt, \quad \quad y^2=\frac{r}{D} x^2, \quad \quad n(x,t) \equiv  c(y, \tau)\]</div>
<dl class="docutils">
<dt></dt>
<dd>Przeskalowana koncentracja spełnia równanie</dd>
</dl>
<div class="math">
\[\frac{\partial c }{\partial \tau} =  c  [1-  c ] + \frac{\partial^2  c}{\partial y^2}, \quad \quad c=c(y, \tau)\]</div>
<dl class="docutils">
<dt></dt>
<dd>Funkcje <span class="math">\(c=0\)</span> oraz <span class="math">\(c=1\)</span> są rozwiązaniami stacjonarnymi.</dd>
</dl>
<ol class="upperroman simple" start="3">
<li>Szukamy rozwiązań w postaci fali biegnącej:</li>
</ol>
<div class="math">
\[c(y, \tau) = U(z), \quad \mbox{gdzie } \quad z=y-v_0 \tau\]</div>
<dl class="docutils">
<dt></dt>
<dd><p class="first">Oznacza to, że fala przesuwa się w prawo z prędkością <span class="math">\(v_0\)</span>.  Często mówi się, że  front falowy koncentracji porusza się w prawo z prędkością <span class="math">\(v_0\)</span>.</p>
<p class="last">Zauważamy, że</p>
</dd>
</dl>
<div class="math">
\[\frac{\partial c }{\partial \tau} = \frac{\partial U}{\partial \tau} = \frac{d U}{d z} \frac{\partial z}{\partial \tau} =  -v_0 \frac{d U}{d z}\]</div>
<div class="math">
\[\frac{\partial c }{\partial y} = \frac{\partial U }{\partial y} = \frac{d U }{d z} \frac{\partial z }{\partial y} =    \frac{d U }{d z}\]</div>
<div class="math">
\[\frac{\partial ^2 c }{\partial y^2} = \frac{\partial^2 U }{\partial y^2} = \frac{d ^2U }{d z^2}\]</div>
<dl class="docutils">
<dt></dt>
<dd>Stąd, nowa funkcja <span class="math">\(U(z)\)</span> spełnia równanie różniczkowe zwyczajne drugiego rzędu:</dd>
</dl>
<div class="math">
\[U'' + v_0 U' + U(1-U)=0\]</div>
<dl class="docutils">
<dt></dt>
<dd>Jest ono równoważne układowi 2 równań:</dd>
</dl>
<div class="math">
\[U'=V = F(U, V), \quad \quad V'=-v_0 - U(1-U) = G(U, V)\]</div>
<dl class="docutils">
<dt></dt>
<dd>Stany stacjonarne określone są przez pierwiastki równań:</dd>
</dl>
<div class="math">
\[F(U, V) = 0, \quad \quad  G(U, V) = 0,\]</div>
<dl class="docutils">
<dt></dt>
<dd>stąd otrzymujemy 2 par rozwiązań</dd>
</dl>
<div class="math">
\[(U_0, V_0) = (0, 0), \quad (U_1,  V_1) = (1, 0)\]</div>
<ol class="arabic simple">
<li>Wyznaczamy macierz Jacobiego</li>
</ol>
<div class="math">
\[\begin{split}\quad \quad \quad \quad J = \begin{bmatrix}\frac{ \partial F}{\partial U}&amp;  \frac{\partial F}{\partial V}\\ \frac{\partial  G}{\partial U}&amp;  \frac{\partial Gg}{\partial V}  \end{bmatrix}= \begin{bmatrix}0,  &amp;  1\\ -1+2U,  &amp;  -v_0  \end{bmatrix}\end{split}\]</div>
<dl class="docutils">
<dt></dt>
<dd>w punktach stacjonarnych:</dd>
</dl>
<div class="math">
\[\begin{split}J_0= J(0, 0) =  \begin{bmatrix}0&amp; 1\\ -1&amp; -v_0 \end{bmatrix}, \quad \quad  J_1=  J(1, ) = \begin{bmatrix}0&amp; 1\\ 1&amp; -v_0 \end{bmatrix}\end{split}\]</div>
<ol class="arabic simple" start="2">
<li>Wyznaczamy wartości własne macierzy Jacobiego <span class="math">\(|J-\lambda I|=0\)</span>:</li>
</ol>
<ol class="loweralpha simple">
<li>dla <span class="math">\((0, 0)\)</span> otrzymujemy:</li>
</ol>
<div class="math">
\[\lambda_{\pm}(0, 0) = (1/2)[-v_0\pm\sqrt{v_0^2-4}]\]</div>
<dl class="docutils">
<dt></dt>
<dd>Należy rozważyć 2 przypadki: <span class="math">\(v_0 \lt  2\)</span> oraz <span class="math">\(v_0 \ge 2\)</span>. Pierwszy przypadek należy odrzucić, ponieważ wartości własne są zespolone, o rzeczywistej części ujemnej i krzywe fazowe tworzą spiralę wokół punktu <span class="math">\((0, 0)\)</span>. Ale to oznacza, że <span class="math">\(U\)</span>  przyjmuje także ujemne wartości, co nie jest dopuszczalne (koncentracje populacji mogą być tylko dodatnie lub zerowe). Pozostaje tylko drugi przypadek:</dd>
</dl>
<div class="math">
\[v_0 \ge 2\]</div>
<ol class="loweralpha simple" start="2">
<li>dla <span class="math">\((1, 0)\)</span> otrzymujemy: <span class="math">\(\lambda_{\pm}(1, 0) = (1/2)[-v_0\pm\sqrt{v_0^2+4}]\)</span>.  Ponieważ jedna  z wartości własnych jest dodatnia, ten stan stacjonarny jest niestabilny (jest to stan stacjonarny typu siodło).</li>
</ol>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">F</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span><span class="o">=</span><span class="n">v</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">G</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span><span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">v</span><span class="o">-</span><span class="n">u</span><span class="o">+</span><span class="n">u</span><span class="o">^</span><span class="mi">2</span> <span class="c">#ewolucja z  otoczenia stanu stacjonarnego (1,0)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">T1</span> <span class="o">=</span> <span class="n">srange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span> <span class="c">#druga liczba=ilość iteracji=&quot;czas&quot;</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">T2</span> <span class="o">=</span> <span class="n">srange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">solo2</span><span class="o">=</span><span class="n">desolve_odeint</span><span class="p">(</span><span class="n">vector</span><span class="p">([</span><span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">]),</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="n">T1</span><span class="p">,</span> <span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">])</span> <span class="c"># warunek pocz (U, V)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">solo3</span><span class="o">=</span><span class="n">desolve_odeint</span><span class="p">(</span><span class="n">vector</span><span class="p">([</span><span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">]),</span> <span class="p">[</span><span class="mf">0.999</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">T2</span><span class="p">,</span> <span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">])</span> <span class="c"># warunek pocz (U, V)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">list_plot</span><span class="p">(</span><span class="n">solo2</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">plotjoined</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;green&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="n">list_plot</span><span class="p">(</span><span class="n">solo3</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">plotjoined</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<img alt="_images/cell_10_sage01.png" class="align-center" src="_images/cell_10_sage01.png" />
<p>Zauważmy, że istnieją stany początkowe z otoczenia stanu <span class="math">\((1, 0)\)</span>, które dążą do stanu <span class="math">\((0, 0)\)</span>. Innymi słowy funkcja <span class="math">\(U(z)\)</span>  z otoczenia <span class="math">\(U(z) \approx 1\)</span> łączy się z  funkcją <span class="math">\(U(z)=0\)</span>. To sugeruje wybór warunków brzegowych w postaci:</p>
<div class="math">
\[\lim_{z\to   -\infty} U(z) = 1, \quad \quad \lim_{z\to \infty} U(z) = 0\]</div>
<p>Pamiętając o własnościach stanów stacjonarnych w standardowym modelu Verhulsta (<span class="math">\(n(t) \to 1\)</span> dla <span class="math">\(t\to \infty\)</span>), oznacza to, że dla ustalonej wartości położenia <span class="math">\(y\)</span>:</p>
<div class="math">
\[\lim_{z\to   -\infty} U(z) =  \lim_{\tau \to \infty} U(y-v_0 \tau ) = \lim_{\tau \to   \infty} c(y, \tau )  = 1\]</div>
<p>co jest konsystentne z zachowaniem się układu w przypadku bez migracji.</p>
<div class="section" id="dokladne-rozwiazanie-w-szczegolnym-przypadku">
<h3>Dokładne rozwiązanie w szczególnym przypadku<a class="headerlink" href="iCSE_BProcnielin05_z125_reakcja_dyfuzja.html#dokladne-rozwiazanie-w-szczegolnym-przypadku" title="Stały odnośnik do tego nagłówka">¶</a></h3>
<p>Istnieje jeden szczególny przypadek, gdy znane jest dokładne  rozwiązanie równania Fishera-Kołmogorowa w postaci analitycznej. Dal prędkości fali</p>
<div class="math">
\[v_0 =  \frac{5}{\sqrt{6}}\]</div>
<p>rozwiązanie ma postać:</p>
<div class="math">
\[c(y, \tau) = \frac{1}{\left\{1+A \exp\left[ (y-v_0 \tau)/\sqrt{6}\right] \right\}^{2}}\]</div>
<p>gdzie stała <span class="math">\(A\gt 0\)</span> określa początkowy profil koncentracji.</p>
<div class='sage'><script type='text/x-sage'>A=1                                              ## określa początkowy profil koncentracji
b=5/sqrt(6)                                      ## prędkość frontu falowego
cs(x,t) = 1/(1+ A*exp(x-b*t)/sqrt(6))^2          ## szczególna, ale analityczna postać frontu koncentracji
@interact
def _(t=slider(0,5,0.2)):
    pr3 = plot( cs(x,0),(x,-10,10),color='black' )
    pr4 = plot( cs(x,t),(x,-10,10),fill=True )
    (pr3+pr4).show(figsize=5)</script></div></div>
</div>
<div class="section" id="analiza-numeryczna-rownania-fishera-kolmogorowa">
<h2>Analiza numeryczna równania Fishera-Kołmogorowa:<a class="headerlink" href="iCSE_BProcnielin05_z125_reakcja_dyfuzja.html#analiza-numeryczna-rownania-fishera-kolmogorowa" title="Stały odnośnik do tego nagłówka">¶</a></h2>
<div class="math">
\[\frac{\partial n(x, t)}{\partial t} = r n(x, t) \;[1-  n(x, t)] +    D \frac{\partial^2  n(x, t)}{\partial x^2}\]</div>
<p>Przyjęto okresowe warunki brzegowe, poprzez odpowiedni wybór dyskretnego operatowa dyfuzji <span class="math">\(L\)</span>.  Najpierw wybieramy dyskretyzację przestrzeni, potem dobieramy maksymalny krok czasowy tak by warunek CFL był spełniony.</p>
<p>Aby uzyskac rozwiązanie z wyraźną falą biegnącą należy wziąć dla <span class="math">\(r=0\)</span> wartości dyfuzji poniżej <span class="math">\(D\lt 0.001\)</span>. Dla większych wartości stałych dyfuzji najpierw nastąpi wyrównanie poziomu <span class="math">\(u\)</span> na obszarze, a potem wzrost do wartości stabilnej <span class="math">\(u=1\)</span>.</p>
<p>Długość układu wchodzi efektywnie w skalowanie stałej dyfuzji, można więc bez straty ogólności rozważać układy o długości 1.</p>
<div class="math">
\[u^{i+1}  = u^i + dt \left( r u^i (1-u^i) + D \frac{1}{h^2} Lu^i\right),\]</div>
<p>gdzie <span class="math">\(L\)</span> jest dyskretnym operatorem Laplace&#8217;a.</p>
<p>Ponieważ część nieliniowa jest lokalna (nie zawiera pochodnych), to warunki brzegowe są zawarte w operatorze <span class="math">\(L\)</span>.</p>
<div class='sage'><script type='text/x-sage'>import numpy as np
Dyf = 1.0
r = 1.0
l = 100.0 # dlugosc ukladu
t_end = 50 # czas symulacje
N = 100 # dyskretyzacja przestrzeni
h = l/(N-1)
dt = 0.2/(Dyf*(N-1)**2/l**2) # 0.2 z warunku CFL, krok nie moze byc wiekszy
sps = int(1/dt) # liczba krokow na jednostke czasu
Nsteps=sps*t_end  # calkowita liczba krotkow
print "sps=",sps,"dt=",dt
one = np.identity(N)
L=np.roll(one,-1)+np.roll(one,1)-2*one
L[0,0]=-2.
L[-1,-1]=-2.
L[0,-1]=1.
L[-1,0]=1.
# warunek poczatkowy
u = np.zeros(N)
u[N/2-10:N/2+10]=.1 # small bump
#u[:N/2]=1 # step
Tlst=[]
for i in range(Nsteps):
    if not i%sps:
        Tlst.append(list(u))
    u = u + dt*(r*u*(1-u) + Dyf*(N-1)**2/l**2*L.dot(u))
@interact
def _(ti=slider(range(len(Tlst)))):
    print r"tau=",dt*ti
    p =  list_plot(Tlst[ti],plotjoined=True)
    p += list_plot(Tlst[-1],plotjoined=True,color='red',ymin=0,ymax=1.5)
    p += list_plot(Tlst[0],plotjoined=True,color='gray')
    p.show(figsize=(8,3))</script></div><div class='sage'><script type='text/x-sage'>import numpy as np
Dyf = 1.0
r = 1.0
l = 100.0 # dlugosc ukladu
t_end = 100 # czas symulacje
N = 200 # dyskretyzacja przestrzeni
h = l/(N-1)
dt = 0.052/(Dyf*(N-1)**2/l**2) # 0.2 z warunku CFL, krok nie moze byc wiekszy
sps = int(1/dt) # liczba krokow na jednostke czasu
Nsteps=sps*t_end  # calkowita liczba krotkow
print "sps=",sps,"dt=",dt
one = np.identity(N)
L=np.roll(one,-1)+np.roll(one,1)-2*one
L[0,0]=1.
L[-1,-1]=1.
# warunek poczatkowy
u = np.zeros(N)
#u[:int(N/2]=1 # step
for i in range(1,3):
    u[i] = 1.0 - i/3.0
def essential_boundary_conditions(u):
    u[0] = 1.
    u[-1] = 0.0
Tlst=[]
essential_boundary_conditions(u)
for i in range(Nsteps):
    if not i%sps:
        Tlst.append(list(u))
    u = u + dt*(r*u*(1-u) + Dyf*(N-1)**2/l**2*L.dot(u))
    essential_boundary_conditions(u)
@interact
def _(ti=slider(range(len(Tlst)))):
    print r"t=",dt*ti
    p =  list_plot(Tlst[ti],plotjoined=True)
    p += list_plot(Tlst[-1],plotjoined=True,color='red',ymin=0,ymax=1.5)
    p += list_plot(Tlst[0],plotjoined=True,color='gray')
    p.show(figsize=(8,3))</script></div><div class="section" id="predkosc-frontu-fali">
<h3>Prędkość frontu fali:<a class="headerlink" href="iCSE_BProcnielin05_z125_reakcja_dyfuzja.html#predkosc-frontu-fali" title="Stały odnośnik do tego nagłówka">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">pos_lst</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">sage</span><span class="p">:</span> <span class="k">for</span> <span class="n">T_</span> <span class="ow">in</span> <span class="n">Tlst</span><span class="p">:</span>
<span class="o">...</span>       <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">a</span><span class="p">),</span><span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">T_</span><span class="p">),</span><span class="n">T_</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
<span class="o">...</span>           <span class="k">if</span> <span class="n">a</span><span class="o">&gt;=</span><span class="mf">0.5</span> <span class="ow">and</span> <span class="n">b</span><span class="o">&lt;=</span><span class="mf">0.5</span><span class="p">:</span>
<span class="o">...</span>               <span class="n">pos_lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">i</span><span class="o">+</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">)</span> <span class="p">)</span>
<span class="o">...</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">list_plot</span><span class="p">(</span> <span class="p">[</span><span class="n">l</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">sps</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pos_lst</span><span class="p">,</span><span class="n">pos_lst</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span> <span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">gridlines</span><span class="o">=</span><span class="p">[[],[</span><span class="mi">2</span><span class="p">]],</span><span class="n">ymax</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/cell_15_sage01.png" class="align-center" src="_images/cell_15_sage01.png" />
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <div class="sphinxlocaltoc">
  <h3><a href="index.html">Spis treści</a></h3>
  <ul>
<li><a class="reference internal" href="iCSE_BProcnielin05_z125_reakcja_dyfuzja.html#">Równania reakcji-dyfuzji</a></li>
<li><a class="reference internal" href="iCSE_BProcnielin05_z125_reakcja_dyfuzja.html#model-malthusa-z-migracja-rownanie-skellama">Model Malthusa z migracją: Równanie Skellama</a></li>
<li><a class="reference internal" href="iCSE_BProcnielin05_z125_reakcja_dyfuzja.html#model-verhulsta-z-migracja-rownanie-fishera-kolmogorowa">Model Verhulsta z migracją: Równanie Fishera-Kołmogorowa</a><ul>
<li><a class="reference internal" href="iCSE_BProcnielin05_z125_reakcja_dyfuzja.html#analiza-rownania-fishera-kolmogorowa">Analiza równania Fishera-Kołmogorowa</a><ul>
<li><a class="reference internal" href="iCSE_BProcnielin05_z125_reakcja_dyfuzja.html#dokladne-rozwiazanie-w-szczegolnym-przypadku">Dokładne rozwiązanie w szczególnym przypadku</a></li>
</ul>
</li>
<li><a class="reference internal" href="iCSE_BProcnielin05_z125_reakcja_dyfuzja.html#analiza-numeryczna-rownania-fishera-kolmogorowa">Analiza numeryczna równania Fishera-Kołmogorowa:</a><ul>
<li><a class="reference internal" href="iCSE_BProcnielin05_z125_reakcja_dyfuzja.html#predkosc-frontu-fali">Prędkość frontu fali:</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <h4>Poprzedni temat</h4>
  <p class="topless"><a href="iCSE_BProcnielin04_z122_kinetyka_chemiczna.html"
                        title="poprzedni rozdział">Kinetyka reakcji chemicznych</a></p>
  <h4>Następny temat</h4>
  <p class="topless"><a href="iCSE_BProcnielin06_z155_modele_epidemii.html"
                        title="następny rozdział">Modele epidemii</a></p>
<div id="searchbox" style="display: none">
  <h3>Szybkie wyszukiwanie</h3>
    <form class="search" action="http://visual.icse.us.edu.pl/PNB/search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Szukaj" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Wprowadź szukany termin lub nazwę modułu, klasy lub funkcji.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  </div>
  <div class="relbar-bottom">
    
    <div class="related">
      <h3>Nawigacja</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="iCSE_BProcnielin06_z155_modele_epidemii.html" title="Modele epidemii"
             >dalej</a></li>
        <li class="right" >
          <a href="iCSE_BProcnielin04_z122_kinetyka_chemiczna.html" title="Kinetyka reakcji chemicznych"
             >wstecz</a> &nbsp; &nbsp;</li>
  <li><a href="index.html">Procesy nieliniowe w Biologii</a> &raquo;</li>
   
      </ul>
    </div>
  </div>
  
  <div class="footer">
    <a class="logo" href="../../icse.us.edu.pl/index.html" target="_blank"><img src="_static/logo-icse.png" alt="ICSE"/></a><br/>
    &copy; Copyright 2013, Jerzy Łuczka, Marcin Kostur.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.2.
  </div>
  </body>
</html>