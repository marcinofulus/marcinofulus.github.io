


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Łagodne wprowadzenie do równań różniczkowych &mdash; Mechanika Stosowana - Skrypt dev documentation</title>
    
    <link rel="stylesheet" href="_static/cloud.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Noticia+Text|Open+Sans|Droid+Sans+Mono&subset=latin,latin-ext" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     'dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/jquery.cookie.js"></script>
    <script type="text/javascript" src="_static/cloud.js"></script>

	<script src="http://sagecell.sagemath.org/static/jquery.min.js"></script>
	<script src="http://sagecell.sagemath.org/static/embedded_sagecell.js"></script>

	<script>sagecell.makeSagecell({inputLocation: ".sage",
                                       evalButtonText: 'Wykonaj',
                                       linked: true});</script>

	<style type="text/css">
		.sagecell .CodeMirror-scroll {
			overflow-y: hidden;
			overflow-x: auto;
		}
		.sagecell .CodeMirror {
			height: auto;
		}
	</style>

    
    <link rel="top" title="Mechanika Stosowana - Skrypt dev documentation" href="http://visual.icse.us.edu.pl/MS/index.html" />
    <link rel="next" title="Tor ruchu u układach krzywoliniowych" href="http://visual.icse.us.edu.pl/MS/tor_ruchu.html" />
    <link rel="prev" title="Zwężone iloczyny epsilonów" href="http://visual.icse.us.edu.pl/MS/iloczyn_epsilonow.html" />
 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>
  <body>
    <div class="relbar-top">
        
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="http://visual.icse.us.edu.pl/MS/genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="http://visual.icse.us.edu.pl/MS/tor_ruchu.html" title="Tor ruchu u układach krzywoliniowych"
             accesskey="N">next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="http://visual.icse.us.edu.pl/MS/iloczyn_epsilonow.html" title="Zwężone iloczyny epsilonów"
             accesskey="P">previous</a> &nbsp; &nbsp;</li>
    <li><a href="http://visual.icse.us.edu.pl/MS/index.html">Mechanika Stosowana - Skrypt dev documentation</a> &raquo;</li>
 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="lagodne-wprowadzenie-do-rownan-rozniczkowych">
<h1>Łagodne wprowadzenie do równań różniczkowych<a class="headerlink" href="lagodne_wprowadzenie_ode.html#lagodne-wprowadzenie-do-rownan-rozniczkowych" title="Permalink to this headline">¶</a></h1>
<div class="section" id="co-to-jest-rownanie-rozniczkowe">
<h2>Co to jest równanie różniczkowe?<a class="headerlink" href="lagodne_wprowadzenie_ode.html#co-to-jest-rownanie-rozniczkowe" title="Permalink to this headline">¶</a></h2>
<p>Równanie różniczkowe to zależność między szukaną funkcją a jej pochodnymi.</p>
<p>W ogólnym przypadku mówimy o równaniu stopnia <span class="math">\(n\)</span>-tego jeśli  mamy  relację:</p>
<div class="math">
\[F(y^{(n)}(x),y^{(n-1)}(x),\dots,y(x),x) = 0,\]</div>
<p>gdzie:</p>
<ul class="simple">
<li><span class="math">\(y^{(n)}(x) = \frac{d^n f(x)}{dx^n}.\)</span></li>
<li><span class="math">\(y(x)\)</span> jest szukaną funkcją, lub zmienną zależną,</li>
<li><span class="math">\(x\)</span> jest zwane zmienną niezależną</li>
</ul>
<p>Możemy mieć też sytuację, że mamy <span class="math">\(m\)</span> równań <span class="math">\(n\)</span>-tego stopnia na <span class="math">\(m\)</span> funkcji <span class="math">\(y_i.\)</span> Szczególnym przypadkiem jest układ <span class="math">\(m\)</span> równań pierwszego stopnia <span class="math">\(m\)</span> funkcji. Okazuje się, że można z równania <span class="math">\(n\)</span> tego stopnia, utworzyć równoważny układ <span class="math">\(n\)</span> równań pierwszego stopnia.</p>
<div class="section" id="przyklad-rownanie-newtona-dla-jednej-czastki-w-jednym-wymiarze">
<h3>Przykład: równanie Newtona dla jednej cząstki w jednym wymiarze<a class="headerlink" href="lagodne_wprowadzenie_ode.html#przyklad-rownanie-newtona-dla-jednej-czastki-w-jednym-wymiarze" title="Permalink to this headline">¶</a></h3>
<p>Ruch cząstki opisywany jest przez:</p>
<div class="math">
\[m  a  = F\]</div>
<p>Przyśpieszenie jest drugą pochodną położenia po czasie, a siła jest w ogólności pewną funkcja położenia <span class="math">\(x\)</span> i czasu. Mamy więc:</p>
<div class="math">
\[m \ddot x  =  F(\dot x, x, t)\]</div>
<p>Wprowadźmy teraz nową funkcję <span class="math">\(v = \frac{dx(t)}{dt}\)</span>. Podstawiając w poprzednim równaniu  można zapisać:</p>
<div class="math">
\[\begin{split}\begin{cases} \dot x = v \\ \dot v = - \frac{F(\dot x,x,t)}{m} x. \end{cases}\end{split}\]</div>
<p>Widzimy, że z jednego równana drugiego stopnia otrzymaliśmy układ dwóch równań pierwszego stopnia.</p>
<p>Równania pierwszego rzędu często przedstawia się  w postaci w której po prawej stronie znaku równości stoi pochodna a po lewej wyrażenie zależące od funkcji:</p>
<div class="math">
\[\underbrace{\frac{dx}{dt}}_{\text{pochodna }} = \underbrace{f(x,t)}_{\text{prawa strona równania, ang. RHS}}\]</div>
</div>
</div>
<div class="section" id="geometryczna-interpretacja-rownan-rozniczkowych">
<h2>Geometryczna interpretacja równań różniczkowych.<a class="headerlink" href="lagodne_wprowadzenie_ode.html#geometryczna-interpretacja-rownan-rozniczkowych" title="Permalink to this headline">¶</a></h2>
<p>Rozważmy układ dwóch równań:</p>
<div class="math">
\[\begin{split}\begin{cases} \dot x = f(x,y) \\ \dot y = g(x,y) \end{cases}.\end{split}\]</div>
<p>Jest to tak zwany dwuwymiarowy autonomiczny układ równań różniczkowych zwyczajnych. Autonomiczność oznacza niezależność prawych stron od czasu (tzn. zmiennej niezależnej). Przykładem takiego układu może być ruch cząstki w jednym wymiarze z siłami niezależnymi od czasu.</p>
<p>Równania z powyższego układu możemy przybliżyć zastępując pochodne ilorazem różnicowym:</p>
<div class="math">
\[\begin{split}\begin{cases} \frac{x(t+h)-x(t)}{h} = f(x,y) \\ \frac{y(t+h)-y(t)}{h} = g(x,y) \end{cases},\end{split}\]</div>
<p>mnożąc każde równanie przez <span class="math">\(h\)</span> oraz przenosząc człon z wartościamy zmiennych zależnych w chwili <span class="math">\(t\)</span> na prawą strone otrzymujemy:</p>
<div class="math">
\[\begin{split}\begin{cases} x(t+h) = x(t) + h \cdot f(x,y) \\ y(t+h) = y(t) +h \cdot g(x,y). \end{cases}\end{split}\]</div>
<p>Zgodnie z definicją pochodnej, w granicy <span class="math">\(h\to\infty\)</span> wyrażenia <span class="math">\(f(x,y)\)</span> mogą być brane w chwili pomiędzy <span class="math">\(t\)</span> a <span class="math">\(t+h\)</span>. Przyjmijmy dla ułatwienia, że będziemy brali chwilę <span class="math">\(t\)</span>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Komentarz: taki wybór prowadzi do tak zwanego algorytmu jawnego,
jeśli wzięlibyśmy chwilę np. <span class="math">\(t+h\)</span> to byłby to algorytm
uwikłany i wykonanie kroku było by związane z rozwiązaniem równań
algebraicznych.</p>
</div>
<p>Układ ten posiada ciekawą interpretację:</p>
<ul class="simple">
<li>po pierwsze zauważmy, że para funkcji wyznacza pole wektorowe na płaszczyźnie</li>
<li>po drugie równania te dają nam przepis jak z wartości funkcji w chwili <span class="math">\(t\)</span> otrzymać wartość z &#8220;następnej&#8221; chwili <span class="math">\(t+h\)</span> co może być przydatne do odtworzenia krzywej <span class="math">\((x(t),y(t))\)</span>.</li>
</ul>
<div class="section" id="pole-wektorowe">
<h3>Pole wektorowe<a class="headerlink" href="lagodne_wprowadzenie_ode.html#pole-wektorowe" title="Permalink to this headline">¶</a></h3>
<p>Polem wektorowe to funkcja, która każdemu punktowi przestrzeni przyporządkowuje pewną wielkość wektorową. Jeśli przestrzenią będzie np. <span class="math">\(\mathbb{R}^2\)</span> to taka funkcja będzie składała się z dwóch funkcji skalarnych:</p>
<div class="math">
\[\begin{split}\vec F(x,y) = \begin{cases}f(x,y) \\  g(x,y) \end{cases}\end{split}\]</div>
<p>Takie pole wektorowe można zwizualizować rysując strzałki dla pewnej
ilości punktów na płaszczyżnie. Przykładem powszechnego użycia takiego
pola wektorowego jest pole prędkości wiatru.</p>
<p>W Sage możemy narysować pole wektorowe za pomocą  <tt class="docutils literal"><span class="pre">plot_vector_field.</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x y&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.4</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.9</span><span class="o">*</span><span class="n">y</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.9</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.4</span><span class="o">*</span><span class="n">y</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">plt_v</span> <span class="o">=</span> <span class="n">plot_vector_field</span><span class="p">((</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)),(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.2</span><span class="p">),(</span><span class="n">y</span><span class="p">,</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.2</span><span class="p">),</span><span class="n">figsize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">aspect_ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">plt_v</span>
</pre></div>
</div>
<div class="figure align-center">
<img alt="_images/pole_wektorowe.png" src="_images/pole_wektorowe.png" />
<p class="caption">Pole wektorowe dla liniowej funkcji wektorowej.</p>
</div>
</div>
<div class="section" id="graficzne-rozwiazanie-ukladu-dwoch-rownan-rozniczkowych">
<h3>Graficzne rozwiązanie układu dwóch równań różniczkowych<a class="headerlink" href="lagodne_wprowadzenie_ode.html#graficzne-rozwiazanie-ukladu-dwoch-rownan-rozniczkowych" title="Permalink to this headline">¶</a></h3>
<p>Stosując powyżej wyprowadzone wzory przybliżone na pozwalające
wyliczyć rozwiązanie układu równań różniczkowych w chwili <span class="math">\(t+h\)</span>
znając je w chwili <span class="math">\(t\)</span> możemy sprobować naszkicować rozwiązanie
na podstawie wykresu pola wektorowego. Wystarczy poruszać się małymi
krokami zgodnie z lokalnym kierunkiem strzałek.</p>
<p>Spróbujmy wykonać to przy pomocy algorytmu:</p>
<ol class="arabic simple">
<li>bierzemy punkt startowy w <span class="math">\(t\)</span></li>
<li>obliczamy punkt w chwili <span class="math">\(t+h\)</span></li>
<li>rysujemy punkt końcowy na wykresie</li>
<li>punkt koncowy bierzemy jako punkt startowy</li>
<li>powracamy do 1.</li>
</ol>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">h</span> <span class="o">=</span> <span class="mf">0.2</span>
</pre></div>
</div>
<p>Wykonując tą komórkę wiele razy otrzymujemy kolejne kroki algrorytmu:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">x1</span><span class="p">,</span><span class="n">y1</span> <span class="o">=</span> <span class="n">x0</span><span class="o">+</span><span class="n">h</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">),</span><span class="n">y0</span><span class="o">+</span><span class="n">h</span><span class="o">*</span><span class="n">g</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">plt_v</span> <span class="o">=</span> <span class="n">plt_v</span> <span class="o">+</span> <span class="n">point</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">))</span> <span class="o">+</span>  <span class="n">arrow2d</span><span class="p">(</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">h</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">),</span><span class="n">y0</span><span class="o">+</span><span class="n">h</span><span class="o">*</span><span class="n">g</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">)</span>    <span class="p">),</span><span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">arrowsize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">arrowshorten</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span><span class="n">aspect_ratio</span><span class="o">=</span><span class="mi">1</span> <span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span>  <span class="o">=</span> <span class="n">x1</span><span class="p">,</span><span class="n">y1</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">plt_v</span>
</pre></div>
</div>
<img alt="_images/cell_15_sage0.png" class="align-center" src="_images/cell_15_sage0.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">h</span><span class="o">=</span><span class="mf">0.2</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">plts</span><span class="o">=</span><span class="p">[</span><span class="n">plot_vector_field</span><span class="p">((</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)),(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.2</span><span class="p">),(</span><span class="n">y</span><span class="p">,</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.2</span><span class="p">),</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">aspect_ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">sage</span><span class="p">:</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">):</span>
<span class="o">...</span>       <span class="n">x1</span><span class="p">,</span><span class="n">y1</span> <span class="o">=</span> <span class="n">x0</span><span class="o">+</span><span class="n">h</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">),</span><span class="n">y0</span><span class="o">+</span><span class="n">h</span><span class="o">*</span><span class="n">g</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">)</span>
<span class="o">...</span>       <span class="n">plt_v</span> <span class="o">=</span> <span class="n">plt_v</span> <span class="o">+</span> <span class="n">point</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">))</span> <span class="o">+</span>  <span class="n">arrow</span><span class="p">(</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">h</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">),</span><span class="n">y0</span><span class="o">+</span><span class="n">h</span><span class="o">*</span><span class="n">g</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">))</span> <span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">arrowsize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">arrowshorten</span><span class="o">=-</span><span class="mi">10</span>  <span class="p">)</span>
<span class="o">...</span>       <span class="n">x0</span><span class="p">,</span><span class="n">y0</span>  <span class="o">=</span> <span class="n">x1</span><span class="p">,</span><span class="n">y1</span>
<span class="o">...</span>       <span class="n">plts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">plt_v</span> <span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">animate</span><span class="p">(</span><span class="n">plts</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Mamy następujące wnioski:</p>
<ol class="arabic simple">
<li>Rozwiązanie układu 2 równań pierwszego rzędu jest krzywą w przestrzeni <span class="math">\(\mathbb{R}^2.\)</span></li>
<li>Krzywa zależy od wyboru punktu początkowego.</li>
<li>Dwa rozwiązania wychodzące od różnych punktów początkowych mogą się schodzić do jednego punktu, ale  <strong>nie mogą się przecinać!</strong></li>
<li>Ponieważ mamy nieograniczony wybór punktów początkowych i zachodzi (3) to rozwiązaniem układu dwóch równań jest dwuparametrowa rodzina krzywych płaskich.</li>
</ol>
<p>Równanie różniczkowe (lub układ równań) z warunkiem początkowym nazywa się w matematyce zagadnieniem Cauchy&#8217;ego. Punkt (3) jest znany jako Twierdzenie Piccarda o istnieniu i jednoznaczności rozwiązań zagadnienia Cauchy&#8217;ego i warto odnotować, że nakłada ono pewne ograniczenia na zmienność prawych stron układu równań.</p>
</div>
<div class="section" id="analityczne-rozwiazania-rownan-rozniczkowych">
<h3>Analityczne rozwiązania równań różniczkowych<a class="headerlink" href="lagodne_wprowadzenie_ode.html#analityczne-rozwiazania-rownan-rozniczkowych" title="Permalink to this headline">¶</a></h3>
<p>Równania różniczkowe można analizować  za pomocą metody graficznej a wartości liczbowe można otrzymywać z dowolną dokładnościa z użyciem metody przybliżonej. Metody te nie ograniczają w żaden sposób postaci prawych stron układu.</p>
<p>Czy można otrzymać analityczny wzór na rodzinę funkcji będących rozwiązaniem równania różniczkowego?</p>
<p>Jest to w ogólnym przypadku trudne, jednak jest kilka postaci równań różniczkowych w których zawsze możemy znaleźć rozwiązanie analityczne. Jedym z takich przypadków to jedno równanie separowalne pierwszego stopnia. Separowalność oznacza, że prawa strona jest iloczynem funkcji <span class="math">\(x\)</span> i <span class="math">\(t\)</span>:</p>
<div class="math">
\[\frac{dx}{dt} = f(x,t) = a(x)\cdot b(t).\]</div>
<p>W takim przypadku możemy zapisać równanie, traktując pochodną jako iloczyn różniczek:</p>
<div class="math">
\[\frac{dx}{dt} = a(x)\cdot b(t)\]</div>
<p>i scałkować obustronnie powyższe wyrażenie. Ponieważ lewa strona nie zawiera jawnie czasu całkowanie po <span class="math">\(x\)</span> przeprowadzamy tak jakby <span class="math">\(x\)</span> było zmienną niezależną.</p>
<div class="section" id="przyklad">
<h4>Przykład:<a class="headerlink" href="lagodne_wprowadzenie_ode.html#przyklad" title="Permalink to this headline">¶</a></h4>
<div class="math">
\[\frac{dx}{dt} = - k x\]</div>
<div class="math">
\[\frac{dx}{x} =-k dt\]</div>
<div class="math">
\[\log(x(t)) =-k t + C\]</div>
<p>przy założeniu, że <span class="math">\(x&gt;0\)</span>.</p>
<p>Rozwikłując <span class="math">\(x\)</span> mamy:</p>
<div class="math">
\[x(t) = e^{-kt +C}\]</div>
<p>Zobaczmy jak stała całkowania zależy od warunku początkowego. Niech <span class="math">\(x(0)=x_0\)</span>, mamy:</p>
<div class="math">
\[x(t=0) = e^{-k0+C} =e^{C}.\]</div>
<p>Możemy więc zapisać rozwiązanie z warunkiem początkowym <span class="math">\(x(0)=x_0\)</span> jako:</p>
<div class="math">
\[x(t) =x_0 e^{-kt}.\]</div>
<p>Sprawdźmy czy to rozwiązanie zgadza się z otrzymanym metodą przybliżoną:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">L</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">k</span><span class="o">=</span><span class="mf">1.0</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">x0</span><span class="o">=</span><span class="mf">1.2</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">X</span> <span class="o">=</span> <span class="n">x0</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">czas</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">xt</span><span class="o">=</span><span class="p">[</span><span class="n">X</span><span class="p">]</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">ts</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">sage</span><span class="p">:</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">500</span><span class="p">):</span>
<span class="o">...</span>       <span class="n">X</span> <span class="o">=</span> <span class="n">X</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">X</span><span class="p">)</span>
<span class="o">...</span>       <span class="n">czas</span> <span class="o">=</span> <span class="n">czas</span> <span class="o">+</span> <span class="n">dt</span>
<span class="o">...</span>       <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="o">%</span><span class="mi">10</span><span class="p">:</span>
<span class="o">...</span>           <span class="n">xt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="o">...</span>           <span class="n">ts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">czas</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;t&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">p1</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span> <span class="n">x0</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="p">,(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">point</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">xt</span><span class="p">))</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">p1</span><span class="o">+</span><span class="n">p2</span>
</pre></div>
</div>
<img alt="_images/cell_5_sage0.png" class="align-center" src="_images/cell_5_sage0.png" />
</div>
</div>
<div class="section" id="praktyczne-rozwiazywanie-rownan-rozniczkowych-z-wykorzystaniem-funkcji-wbudowanej-desolve-odeint">
<h3>Praktyczne  rozwiązywanie równań różniczkowych z wykorzystaniem funkcji wbudowanej: <tt class="docutils literal"><span class="pre">desolve_odeint</span></tt><a class="headerlink" href="lagodne_wprowadzenie_ode.html#praktyczne-rozwiazywanie-rownan-rozniczkowych-z-wykorzystaniem-funkcji-wbudowanej-desolve-odeint" title="Permalink to this headline">¶</a></h3>
<p>W systemie Sage jest wbudowanych kilka algorytmów, które znacznie dokładniej i wydajniej potrafią rozwiązać równania różniczkowe. Nie wchodząc w szczegóły ich implementacji warto nauczyć się nimi posługiwać.</p>
<p>Jednym z lepszych narzędzi jest funkcja  <tt class="docutils literal"><span class="pre">desolve_system:</span></tt></p>
<div class="highlight-python"><pre>desolve_odeint(prawe strony równań różniczkowych, warunki początkowe,czasy,szukane)</pre>
</div>
<p>Dla naszego przykładu mamy użycie tej procedury wygląda w  następujący sposób:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">f</span><span class="o">=-</span><span class="n">k</span><span class="o">*</span><span class="n">x</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">ic</span><span class="o">=</span><span class="mf">1.2</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">t</span><span class="o">=</span><span class="n">srange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">5.01</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">sol</span><span class="o">=</span><span class="n">desolve_odeint</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">ic</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">p</span><span class="o">=</span><span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">sol</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]),</span><span class="n">size</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&#39;green&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="p">(</span><span class="n">p1</span><span class="o">+</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">sage</span><span class="p">:</span> <span class="k">print</span> <span class="n">k</span><span class="p">,</span><span class="n">t</span>
<span class="mf">1.00000000000000</span> <span class="p">[</span><span class="mf">0.000000000000000</span><span class="p">,</span> <span class="mf">0.500000000000000</span><span class="p">,</span> <span class="mf">1.00000000000000</span><span class="p">,</span> <span class="mf">1.50000000000000</span><span class="p">,</span> <span class="mf">2.00000000000000</span><span class="p">,</span> <span class="mf">2.50000000000000</span><span class="p">,</span> <span class="mf">3.00000000000000</span><span class="p">,</span> <span class="mf">3.50000000000000</span><span class="p">,</span> <span class="mf">4.00000000000000</span><span class="p">,</span> <span class="mf">4.50000000000000</span><span class="p">,</span> <span class="mf">5.00000000000000</span><span class="p">]</span>
</pre></div>
</div>
<img alt="_images/cell_8_sage0.png" class="align-center" src="_images/cell_8_sage0.png" />
<p>Rozwiązanie jest przekazywane w postaci macierzy (dokładnie mówiąc typu np.array z pakietu numpy) w której dla <span class="math">\(n\)</span> równań każdy rząd zawiera wartości <span class="math">\(n\)</span>-zmiennych w kolejnych chwilach czasu.</p>
<p>W naszym przypadku mamy jedno równanie:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">sol</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span>
<span class="o">&lt;</span><span class="nb">type</span> <span class="s">&#39;numpy.ndarray&#39;</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span>
<span class="n">sage</span><span class="p">:</span> <span class="k">print</span> <span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span>
<span class="p">[[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="p">]]</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">a</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="przyklad-1-oscylator-harmoniczny">
<h3>Przykład 1: oscylator harmoniczny<a class="headerlink" href="lagodne_wprowadzenie_ode.html#przyklad-1-oscylator-harmoniczny" title="Permalink to this headline">¶</a></h3>
<p>Układ dwóch równań różniczkowych odpowiadającego ruchowi cząstki w potencjale (1d)</p>
<div class="math">
\[U(x) = \frac{1}{2} k x^2\]</div>
<p>Równanie Newtona:</p>
<div class="math">
\[m \ddot x = m  a  = F = -U'(x)  =  -k x\]</div>
<p>co można zapisać:</p>
<div class="math">
\[\begin{split}\begin{cases} \dot x = v \\ \dot v = - k x \end{cases}\end{split}\]</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;t&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x, v&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">k</span> <span class="o">=</span> <span class="mf">1.2</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">times</span> <span class="o">=</span> <span class="n">srange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="n">include_endpoint</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">desolve_odeint</span><span class="p">([</span><span class="n">v</span><span class="p">,</span> <span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">times</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">v</span><span class="p">])</span>
</pre></div>
</div>
<p>Narysujmy potencjał:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">plot</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/cell_51_sage0.png" class="align-center" src="_images/cell_51_sage0.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)</span>
<span class="mi">441</span>
</pre></div>
</div>
<p>Rozwiązanie jest tablicą numpy (zob.  <a class="reference external" href="../../sage2.icse.us.edu.pl/home/pub/114.1.html">Wprowadzenie do numpy</a> ), która może być wygodnie i wydajnie przeszukiwana przez technikę &#8220;slicing&#8221;, np:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">sol</span><span class="p">[::</span><span class="mi">200</span><span class="p">,:]</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.69241901</span><span class="p">,</span>  <span class="mf">0.7903589</span> <span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">0.0411118</span> <span class="p">,</span>  <span class="mf">1.09451919</span><span class="p">]])</span>
</pre></div>
</div>
<p>Zależność parametryczną <span class="math">\((x(t),v(t))\)</span> możemy przedstawić na płaszczyźnie (x,v):</p>
<div class='sage'><script type='text/x-sage'>@interact
def sdfs(i=slider(range(len(times)))):
    sol = desolve_odeint([v, -k*(x)], [1,0], times, [x,v])
    x1,v1 = sol[i,0],sol[i,1]
    p=line(sol,figsize=7,aspect_ratio=1)+\
     plot_vector_field([v, -k*(x)],(x,-4,4),(v,-2,2))+\
     arrow( (x1,v1),(x1+v1,v1+ -k*(x1)),color='red')
    print times[i]
    p.show()</script></div><div class='sage'><script type='text/x-sage'>@interact
def _(v0=slider(-5,5,0.1,default=0.4)):
    sol = desolve_odeint([v, -k*(x)], [0,v0], times, [x,v])
...
    p=line(sol,figsize=7,aspect_ratio=1)+\
     plot_vector_field([v, -k*(x)],(x,-4,4),(v,-3,3),xmax=4,xmin=-4)
    p.show()</script></div><p>Zależności od czasu, prędkości i położenia dane są przez funkcje okresowe:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x v&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">k</span> <span class="o">=</span> <span class="mf">1.2</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">desolve_odeint</span><span class="p">([</span><span class="n">v</span><span class="p">,</span> <span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">times</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">v</span><span class="p">])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">px</span> <span class="o">=</span> <span class="n">line</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">times</span><span class="p">,</span><span class="n">sol</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]),</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">pv</span> <span class="o">=</span> <span class="n">line</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">times</span><span class="p">,</span><span class="n">sol</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]),</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">px</span><span class="o">+</span><span class="n">pv</span>
</pre></div>
</div>
<img alt="_images/cell_3_sage0.png" class="align-center" src="_images/cell_3_sage0.png" />
<p>Ponieważ układ ten jest znany jako oscylator harmoniczny i wiemy, że rozwiązanie dla warunku początkowego <span class="math">\(x(0)=1\)</span>, <span class="math">\(v(0)=0\)</span> jest w postaci:</p>
<div class="math">
\[x(t) = \cos(\sqrt{k}t), v(t) = -\sin(\sqrt{k}t).\]</div>
<p>zatem możemy porównać wynik metody przybliżonej i rozwiązanie analityczne.</p>
<p>Rozwiązanie analityczne, możemy też otrzymać stosując funkcję Sage desolve, która rozwiązuje równania róźniczkowe symbolicznie:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;t k&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">assume</span><span class="p">(</span><span class="n">k</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">x</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">de</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">x</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">desolve</span><span class="p">(</span><span class="n">de</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">ivar</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
<span class="n">k1</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">k2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
<p>Nawet jeśli, znamy postać rozwiązania równania różniczkowego, to możemy zawsze wykorzystać desolve, to poprawnego zastosowania warunku początkowego. Weźmy na przykład oscylator harmoniczny, w którym w chwili początkowej mamy <span class="math">\(x(0)=x_0\)</span> i <span class="math">\(v(0)=v_0\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;t k&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">assume</span><span class="p">(</span><span class="n">k</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">x</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">de</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">x</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;v0,x0&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">show</span><span class="p">(</span> <span class="n">desolve</span><span class="p">(</span><span class="n">de</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">v0</span><span class="p">],</span><span class="n">ivar</span><span class="o">=</span><span class="n">t</span><span class="p">))</span>
</pre></div>
</div>
<div class="math">
\[x_{0} \cos\left(\sqrt{k} t\right) + \frac{v_{0} \sin\left(\sqrt{k} t\right)}{\sqrt{k}}\]</div>
<p>Porównajmy zatem rozwiązanie numeryczne i analityczny dla warunku początkowego <span class="math">\(x_0,v_0=0,1\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;t x v&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">k</span><span class="o">=</span><span class="mf">1.22</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">desolve_odeint</span><span class="p">([</span><span class="n">v</span><span class="p">,</span> <span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">)],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">times</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">v</span><span class="p">])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">px</span> <span class="o">=</span> <span class="n">line</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">times</span><span class="p">,</span><span class="n">sol</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]),</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">px</span><span class="o">+</span><span class="n">plot</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="p">),(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s">&#39;green&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/cell_4_sage0.png" class="align-center" src="_images/cell_4_sage0.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="n">sage</span><span class="p">:</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;t&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">pv</span> <span class="o">=</span> <span class="n">line</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">times</span><span class="p">,</span><span class="n">sol</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]),</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">pv</span><span class="o">+</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="p">),(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s">&#39;green&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/cell_31_sage0.png" class="align-center" src="_images/cell_31_sage0.png" />
</div>
<div class="section" id="przyklad-2-wahadlo-matematyczne">
<h3>Przykład 2: wahadło matematyczne:<a class="headerlink" href="lagodne_wprowadzenie_ode.html#przyklad-2-wahadlo-matematyczne" title="Permalink to this headline">¶</a></h3>
<p>Równanie Newtona:</p>
<div class="math">
\[m \ddot x = m  a  = F = -U'(x)  =  -k \sin(x)\]</div>
<p>co można zapisać:</p>
<div class="math">
\[\begin{split}\begin{cases} \dot x = v \\ \dot v = - k \sin(x) \end{cases}\end{split}\]</div>
<div class='sage'><script type='text/x-sage'>var('t')
var('x, v')
k = 1.2
times = srange(0.0, 11.0, 0.025, include_endpoint=True)
@interact
def _(x0=slider(-4,4,0.1,default=-3),v0=slider(-5,5,0.1,default=0.4)):
    sol = desolve_odeint([v, -k*sin(x)], [x0,v0], times, [x,v])
...
    p=line(sol,figsize=7,aspect_ratio=1)
    p+=plot_vector_field([v, -k*sin(x)],(x,-4,4),(v,-3,3),xmax=4,xmin=-4)
    p+=point([x0,v0],color='red',size=40)
    p.show()</script></div></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <div class="sphinxlocaltoc">
  <h3><a href="http://visual.icse.us.edu.pl/MS/index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="lagodne_wprowadzenie_ode.html#">Łagodne wprowadzenie do równań różniczkowych</a><ul>
<li><a class="reference internal" href="lagodne_wprowadzenie_ode.html#co-to-jest-rownanie-rozniczkowe">Co to jest równanie różniczkowe?</a><ul>
<li><a class="reference internal" href="lagodne_wprowadzenie_ode.html#przyklad-rownanie-newtona-dla-jednej-czastki-w-jednym-wymiarze">Przykład: równanie Newtona dla jednej cząstki w jednym wymiarze</a></li>
</ul>
</li>
<li><a class="reference internal" href="lagodne_wprowadzenie_ode.html#geometryczna-interpretacja-rownan-rozniczkowych">Geometryczna interpretacja równań różniczkowych.</a><ul>
<li><a class="reference internal" href="lagodne_wprowadzenie_ode.html#pole-wektorowe">Pole wektorowe</a></li>
<li><a class="reference internal" href="lagodne_wprowadzenie_ode.html#graficzne-rozwiazanie-ukladu-dwoch-rownan-rozniczkowych">Graficzne rozwiązanie układu dwóch równań różniczkowych</a></li>
<li><a class="reference internal" href="lagodne_wprowadzenie_ode.html#analityczne-rozwiazania-rownan-rozniczkowych">Analityczne rozwiązania równań różniczkowych</a><ul>
<li><a class="reference internal" href="lagodne_wprowadzenie_ode.html#przyklad">Przykład:</a></li>
</ul>
</li>
<li><a class="reference internal" href="lagodne_wprowadzenie_ode.html#praktyczne-rozwiazywanie-rownan-rozniczkowych-z-wykorzystaniem-funkcji-wbudowanej-desolve-odeint">Praktyczne  rozwiązywanie równań różniczkowych z wykorzystaniem funkcji wbudowanej: <tt class="docutils literal"><span class="pre">desolve_odeint</span></tt></a></li>
<li><a class="reference internal" href="lagodne_wprowadzenie_ode.html#przyklad-1-oscylator-harmoniczny">Przykład 1: oscylator harmoniczny</a></li>
<li><a class="reference internal" href="lagodne_wprowadzenie_ode.html#przyklad-2-wahadlo-matematyczne">Przykład 2: wahadło matematyczne:</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <h4>Previous topic</h4>
  <p class="topless"><a href="http://visual.icse.us.edu.pl/MS/iloczyn_epsilonow.html"
                        title="previous chapter">Zwężone iloczyny epsilonów</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="http://visual.icse.us.edu.pl/MS/tor_ruchu.html"
                        title="next chapter">Tor ruchu u układach krzywoliniowych</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="http://visual.icse.us.edu.pl/MS/_sources/lagodne_wprowadzenie_ode.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="http://visual.icse.us.edu.pl/MS/search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="http://visual.icse.us.edu.pl/MS/genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="http://visual.icse.us.edu.pl/MS/tor_ruchu.html" title="Tor ruchu u układach krzywoliniowych"
             >next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="http://visual.icse.us.edu.pl/MS/iloczyn_epsilonow.html" title="Zwężone iloczyny epsilonów"
             >previous</a> &nbsp; &nbsp;</li>
    <li><a href="http://visual.icse.us.edu.pl/MS/index.html">Mechanika Stosowana - Skrypt dev documentation</a> &raquo;</li>
 
      </ul>
    </div>
    </div>

    <div class="footer">
    <a class="logo" href="../../icse.us.edu.pl/index.html" target="_blank"><img src="_static/logo-icse.png" alt="ICSE"/></a><br/>
        &copy; Copyright 2013, Marcin Kostur.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>