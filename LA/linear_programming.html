

  
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17: http://docutils.sourceforge.net/" />

    <title>Linear Programming &#8212; Linear Algebra</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/cloud.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text|Open+Sans|Droid+Sans+Mono&amp;subset=latin,latin-ext" type="text/css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/jquery.cookie.js"></script>
    <script src="_static/cloud.js"></script>
    <script type="text/javascript" src="http://sagecell.sagemath.org/static/jquery.min.js"></script>
    <script type="text/javascript" src="http://sagecell.sagemath.org/embedded_sagecell.js"></script>
    <script type="text/javascript">
        sagecell.makeSagecell({inputLocation: ".sage_linked",
                               linked: true});
        sagecell.makeSagecell({inputLocation: ".sage_unlinked",
                               linked: false});
    </script>

    <style type="text/css">
        .sagecell .CodeMirror-scroll {
            overflow-y: hidden;
            overflow-x: auto;
        }
        .sagecell .CodeMirror {
            height: auto;
        }
    </style>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Problems" href="teoria_i_praktyka_ukladow_zadania.html" />
    <link rel="prev" title="Linear and Polynomial Regression" href="regression.html" />
 
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1">
  </head><body>
  <div class="relbar-top">
    
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="teoria_i_praktyka_ukladow_zadania.html" title="Problems"
             accesskey="N">next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="regression.html" title="Linear and Polynomial Regression"
             accesskey="P">previous</a> &nbsp; &nbsp;</li>
  <li><a href="index.html">Linear Algebra</a> &#187;</li>
  
        <li class="nav-item nav-item-this"><a href="">Linear Programming</a></li> 
      </ul>
    </div>
  </div>
  
  <div class="content">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <section id="linear-programming">
<h1>Linear Programming<a class="headerlink" href="#linear-programming" title="Permalink to this headline">¶</a></h1>
<p>The content of this book as well as quick search in the internet suggest that linear algebra is a branch of mathematics that concerns linear equations, linear operators and their matrix representations. Nevertheless it can be successfully applied to optimize a given expression under certain (linear) constraints. We illustrate some of the techniques, known as <em>linear programming</em>, on the following problems:</p>
<p><strong>The diet problem</strong></p>
<p>There are <span class="math notranslate nohighlight">\(\ m\ \)</span> different types of food, <span class="math notranslate nohighlight">\(\ F_1,\ldots , F_m\ \)</span>,
that supply varying quantities of the <span class="math notranslate nohighlight">\(\ n\ \)</span> nutrients,
<span class="math notranslate nohighlight">\(\ N_1,\ldots , N_n\ \)</span>, that are essential to good
health. Let <span class="math notranslate nohighlight">\(\ b_j\ \)</span> be the minimum daily requirement of nutrient
<span class="math notranslate nohighlight">\(\ N_j\ \)</span>. Let <span class="math notranslate nohighlight">\(\ c_i\ \)</span> be the price of
unit of food <span class="math notranslate nohighlight">\(\ F_i\ \)</span>. Let <span class="math notranslate nohighlight">\(\ a_{ji}\ \)</span> be the amount of nutrient
<span class="math notranslate nohighlight">\(\ N_j\ \)</span> contained in one unit of food <span class="math notranslate nohighlight">\(\ F_i\ \)</span>.
The problem is to supply the required nutrients at minimum cost.</p>
<p>In order to solve this problem we have to find the amount <span class="math notranslate nohighlight">\(\ x_i\ \)</span> of food <span class="math notranslate nohighlight">\(\ F_i\ \)</span>,
<span class="math notranslate nohighlight">\(\ i\in\left\{ 1, 2,\ldots ,m\right\}\)</span>, that one have to buy so that the overall cost</p>
<div class="math notranslate nohighlight">
\[c_1x_1 + \ldots + c_mx_m\]</div>
<p>is minimal and daily requirement for the nutrient <span class="math notranslate nohighlight">\(\ N_j\)</span> is satisfied:</p>
<div class="math notranslate nohighlight">
\[a_{j1}x_1+ \ldots + a_{jm}x_m \geq b_j\,.\]</div>
<p>In other words, we have to solve <em>the Standard Minimum Problem</em> :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}
\text{minimize:} &amp;  c_1x_1 + \ldots + c_mx_m\\
\text{constraints:} &amp; a_{j1}x_1+ \ldots + a_{jm}x_m \geq b_j\, ,\quad j\in\left\{ 1,\ldots ,n\right\}\\
&amp; x_i\geq 0 \, ,\quad i\in\left\{ 1,\ldots ,m\right\}\\
\end{array}\end{split}\]</div>
<p>The last constraint represents the fact that one cannot buy a negative amount of food.</p>
<p><strong>The optimal allocation problem</strong></p>
<p>A company produces <span class="math notranslate nohighlight">\(\ m\ \)</span> types of products,  <span class="math notranslate nohighlight">\(\ P_1,\ldots , P_m\ \)</span>, out of
<span class="math notranslate nohighlight">\(\ n\ \)</span> types of resources,  <span class="math notranslate nohighlight">\(\ R_1,\ldots , R_n\ \)</span>.
One unit of the product <span class="math notranslate nohighlight">\(\ P_i\ \)</span> brings <span class="math notranslate nohighlight">\(\ p_i\ \)</span> of profit and requires <span class="math notranslate nohighlight">\(\ a_{ji}\ \)</span>
units of the resource <span class="math notranslate nohighlight">\(\ R_j\ \)</span>,
<span class="math notranslate nohighlight">\(\ i\in\left\{ 1, 2,\ldots ,m\right\}\, ,\ j\in\left\{ 1, 2,\ldots ,n\right\}\ \)</span>.
The problem is to maximize the profit if there are only <span class="math notranslate nohighlight">\(\ r_j\ \)</span> units of the resource
<span class="math notranslate nohighlight">\(\ R_j\ \)</span>, <span class="math notranslate nohighlight">\(\ j\in\left\{1,\ldots , n\right\}\ \)</span>.</p>
<p>This problem is very similar to the diet problem, but this time asks for optimal numbers
<span class="math notranslate nohighlight">\(\ x_i\ \)</span> of products <span class="math notranslate nohighlight">\(\ P_i\ \)</span> that should be produced so that the profit is maximal.
This represents <em>the Standard Maximum Problem</em> :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}
\text{maximize:} &amp;  p_1x_1 + \ldots + p_mx_m\\
\text{constraints:} &amp; a_{j1}x_1+ \ldots + a_{jm}x_m \leq r_j\, ,\quad j\in\left\{ 1,\ldots ,n\right\}\\
&amp; x_i\geq 0 \, ,\quad i\in\left\{ 1,\ldots ,m\right\}\\
\end{array}\end{split}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Observe that to maximize the values of some function <span class="math notranslate nohighlight">\(f(x)\)</span> is the same as to minimize the values of <span class="math notranslate nohighlight">\(-f(x)\)</span>.
Therefore every standard maximum problem can be easily transformed to a standard minimum problem and vice versa:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}
\text{maximize:} &amp; c_1x_1 + \ldots + c_mx_m \\
\text{constraints:} &amp; a_{j1}x_1+ \ldots + a_{jm}x_m \leq b_j\, ,\quad j\in\left\{ 1,\ldots ,n\right\}\\
&amp; x_i\geq 0 \, ,\quad i\in\left\{ 1,\ldots ,m\right\}\\
\end{array}\end{split}\]</div>
<p>is equivalent to</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}
\text{minimize:} &amp; -(c_1x_1 + \ldots + c_mx_m)\\
\text{constraints:} &amp; -a_{j1}x_1- \ldots - a_{jm}x_m \geq -b_j\, ,\quad j\in\left\{ 1,\ldots ,n\right\}\\
&amp; x_i\geq 0 \, ,\quad i\in\left\{ 1,\ldots ,m\right\}\\
\end{array}\end{split}\]</div>
</div>
<section id="the-geometric-method">
<h2>The Geometric Method<a class="headerlink" href="#the-geometric-method" title="Permalink to this headline">¶</a></h2>
<p>If the expression to minimize/maximize contains only 2 or 3 unknowns, the problem can be solved graphically.</p>
<p><strong>Example 1.</strong></p>
<p>One company produces two products <span class="math notranslate nohighlight">\(P_1\)</span> and <span class="math notranslate nohighlight">\(P_2\)</span> out of three resources <span class="math notranslate nohighlight">\(R_1, R_2, R_3\)</span>.
The amount of resources which are necessary for production as well as their availability is given in the following table:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 23%" />
<col style="width: 27%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p><span class="math notranslate nohighlight">\(P_1\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(P_2\)</span></p></th>
<th class="head"><p>Availability</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(R_1\)</span></p></td>
<td><p>3</p></td>
<td><p>1</p></td>
<td><p>18</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(R_2\)</span></p></td>
<td><p>2</p></td>
<td><p>4</p></td>
<td><p>40</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(R_3\)</span></p></td>
<td><p>3</p></td>
<td><p>2</p></td>
<td><p>24</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">The profit from products <span class="math notranslate nohighlight">\(P_1\)</span> and <span class="math notranslate nohighlight">\(P_2\)</span> is respectively $2 and $3.</div>
<div class="line">How many items of <span class="math notranslate nohighlight">\(P_1\)</span> and <span class="math notranslate nohighlight">\(P_2\)</span> should be produced so that the profit is maximal?</div>
</div>
<p>Denote by <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> the number of items of <span class="math notranslate nohighlight">\(P_1\)</span> and <span class="math notranslate nohighlight">\(P_2\)</span> respectively.
The problem can be written in a concise form as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}
\text{maximize:} &amp;  2x + 3y\\
\text{constraints:} &amp; 3x+y \leq 18 \,,\\
&amp; 2x+ 4y \leq 40 \,,\\
&amp; 3x+ 2y \leq 24 \,,\\
&amp; x, y\geq 0 \,.\\
\end{array}\end{split}\]</div>
<p>The constraints determine the <em>feasible set</em> of solutions to the problem. To draw this region,
we first draw the lines which mark its boundaries, that is, <span class="math notranslate nohighlight">\(\ y = 18-3x,\ 4y = 40-2x,\ 2y=24-3x\ \)</span>,
and then mark the region below the lines (with <span class="math notranslate nohighlight">\(x, y\geq 0\)</span>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">l1</span><span class="o">=</span><span class="n">plot</span><span class="p">(</span><span class="mi">18</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">fillcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span><span class="n">fill</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;$18-3x$&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">l2</span><span class="o">=</span><span class="n">plot</span><span class="p">((</span><span class="mi">40</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;purple&quot;</span><span class="p">,</span> <span class="n">fillcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;axis&#39;</span><span class="p">,</span><span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;$(40-2x)/4$&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">l3</span><span class="o">=</span><span class="n">plot</span><span class="p">((</span><span class="mi">24</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">fillcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;axis&#39;</span><span class="p">,</span><span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;$(24-3x)/2$&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="p">(</span><span class="n">l1</span><span class="o">+</span><span class="n">l2</span><span class="o">+</span><span class="n">l3</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center">
<img alt="_images/lp1.png" src="_images/lp1.png" />
</figure>
<p>The picture tells us that the points <span class="math notranslate nohighlight">\((x, y)\)</span> that satisfy all the requirements lie in the polygon
determined by the points <span class="math notranslate nohighlight">\((0,0),(0,10),(2,9),(4,6),(6,0)\)</span>. We want to maximize the profit function
<span class="math notranslate nohighlight">\(\ p=2x+3y\ \)</span>. In order to find out for which values of <span class="math notranslate nohighlight">\(x, y\)</span> the constant <span class="math notranslate nohighlight">\(p\)</span> is biggest,
we add a few lines <span class="math notranslate nohighlight">\(\ 3y=p-2x\ \)</span> to the picture above:</p>
<figure class="align-center">
<a class="reference internal image-reference" href="_images/lp2.png"><img alt="_images/lp2.png" src="_images/lp2.png" style="width: 465.6px; height: 347.20000000000005px;" /></a>
</figure>
<p>Now it’s clear that the maximal profit is obtained at the point <span class="math notranslate nohighlight">\((x,y)=(2,9)\)</span>
as this is the point within the polygon which the line <span class="math notranslate nohighlight">\(\ 3y=p-2x\ \)</span> touches first.
The point <span class="math notranslate nohighlight">\((x,y)=(2,9)\)</span> represents 2 items of the product <span class="math notranslate nohighlight">\(P_1\)</span> and 9 items of the product <span class="math notranslate nohighlight">\(P_2\)</span>;
the profit is <span class="math notranslate nohighlight">\(\ p=2\cdot 2+3\cdot 9=$31\)</span>.</p>
<p><strong>Example 2.</strong></p>
<p>Consider the following diet problem:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 16%" />
<col style="width: 26%" />
<col style="width: 19%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Food</p></th>
<th class="head"><p>Cost/serving</p></th>
<th class="head"><p>Vitamin A (min 0.9 mg)</p></th>
<th class="head"><p>Iron (min 8 mg)</p></th>
<th class="head"><p>Calcium (min 1000 mg)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Corn</p></td>
<td><p>$ 0.18</p></td>
<td><p>0.009 mg</p></td>
<td><p>0.52 mg</p></td>
<td><p>2 mg</p></td>
</tr>
<tr class="row-odd"><td><p>2% milk</p></td>
<td><p>$ 0.23</p></td>
<td><p>0.028 mg</p></td>
<td><p>0.02 mg</p></td>
<td><p>120 mg</p></td>
</tr>
<tr class="row-even"><td><p>Wheat bread</p></td>
<td><p>$ 0.05</p></td>
<td><p>0 mg</p></td>
<td><p>0.8 mg</p></td>
<td><p>20 mg</p></td>
</tr>
</tbody>
</table>
<p>Denote by <span class="math notranslate nohighlight">\(x, y\)</span> and <span class="math notranslate nohighlight">\(z\)</span> the number of servings of corn, milk and bread, respectively.
The problem of minimizing the expenditure while providing sufficient amount of vitamine A, iron and calcium
may be summarized as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}
\text{minimize:} &amp;  0.18x + 0.23y + 0.05z\\
\text{constraints:} &amp; 0.009x+0.028y \geq 0.9 \,,\\
&amp; 0.52x+ 0.02y + 0.8z \geq 8 \,,\\
&amp; 2x+ 120y + 20z\geq 1000 \,,\\
&amp; x, y, z\geq 0 \,.\\
\end{array}\end{split}\]</div>
<p>Even though this problem can be still represented geometrically, it is much harder to see what the feasible set is and at which point the cost function <span class="math notranslate nohighlight">\(\ c=0.18x + 0.23y + 0.05z\ \)</span> achieves the minimum.</p>
<figure class="align-center">
<img alt="_images/3d2a.png" src="_images/3d2a.png" />
</figure>
<p>(To draw the picture we used the function <code class="docutils literal notranslate"><span class="pre">implicit_plot3d()</span></code>.)</p>
<p>In this picture the cost surfaces are denoted by the red color. The first plane <span class="math notranslate nohighlight">\(0.009x+0.028y= 0.9\)</span> is marked by blue, the second by purple, and the last one by green color. The remaining three planes in lighter colours are parallel to the corresponding planes in darker colours and are drawn to facilitate picturing the feasible set; they show direction of the constraints. The yellow ball is the point with maximal coordinates at this picture: <span class="math notranslate nohighlight">\((60,60,160)\)</span>.</p>
<p>The picture suggests that the place at which the red plane touches the feasible set first is located on the intersection of the blue and purple plane: the red planes that are closer to the origin do not contain any feasible points yet as they are below the restriction given by the blue plane.</p>
<p>We can compute the intersection of the planes using the formulae introduced in section <a class="reference internal" href="primer_geometry-of-eqns-stat.html#geometry-of-eqns"><span class="std std-ref">Geometry of Linear Equations</span></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x y z&#39;</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">eq1</span> <span class="o">=</span> <span class="mf">0.009</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.028</span><span class="o">*</span><span class="n">y</span> <span class="o">==</span> <span class="mf">0.9</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">eq2</span> <span class="o">=</span> <span class="mf">0.52</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.02</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mf">0.8</span><span class="o">*</span><span class="n">z</span> <span class="o">==</span> <span class="mi">8</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">s</span> <span class="o">=</span> <span class="n">solve</span><span class="p">([</span><span class="n">eq1</span><span class="p">,</span><span class="n">eq2</span><span class="p">],[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">s</span>

<span class="p">[[</span><span class="n">x</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1120</span><span class="o">/</span><span class="mi">719</span><span class="o">*</span><span class="n">r1</span> <span class="o">+</span> <span class="mi">10300</span><span class="o">/</span><span class="mi">719</span><span class="p">,</span> <span class="n">y</span> <span class="o">==</span> <span class="mi">360</span><span class="o">/</span><span class="mi">719</span><span class="o">*</span><span class="n">r1</span> <span class="o">+</span> <span class="mi">19800</span><span class="o">/</span><span class="mi">719</span><span class="p">,</span> <span class="n">z</span> <span class="o">==</span> <span class="n">r1</span><span class="p">]]</span>
</pre></div>
</div>
<p>The solution is a line depending on parameter <code class="docutils literal notranslate"><span class="pre">r1</span></code>. We have to choose <code class="docutils literal notranslate"><span class="pre">r1</span></code> so that the cost is minimal. First we substitute the solution to the inequality describing the third constraint to verify that it still holds; we obtain</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
2&amp; \left(-\frac{1120}{719} r_1 + \frac{10300}{719}\right) +120\left( \frac{360}{719} r_1 + \frac{19800}{719}\right) +20r_1 -1000 \\
&amp;= \frac{55340}{719} r_1 + \frac{1677600}{719}
\end{align*}\end{split}\]</div>
<p>which is non-negative for every <span class="math notranslate nohighlight">\(r_1\geq 0\)</span> as required. At the same time, the cost turns out to be equal to</p>
<div class="math notranslate nohighlight">
\[-0.115229485396384\, r_1 + 8.91237830319889\, .\]</div>
<p>It decreases with the growth of parameter <span class="math notranslate nohighlight">\(r_1\)</span>. However, we can only increase <span class="math notranslate nohighlight">\(r_1\)</span> as long as <span class="math notranslate nohighlight">\(x\)</span> remains non-negative. The greatest possible <span class="math notranslate nohighlight">\(r_1\)</span> is when <span class="math notranslate nohighlight">\(x=0\)</span>. The quickest way to find it is to use the function <code class="docutils literal notranslate"><span class="pre">find_root()</span></code> whose last two arguments denote the range of a variable:</p>
<div class='sage_linked'><script type='text/x-sage'>var('r1')
r = find_root(-1120/719*r1 + 10300/719 == 0, 0, 60)
r</script></div><p>We take <span class="math notranslate nohighlight">\(z=r\)</span> and under this assuption compute the intersection of the two planes, including also an equation for the cost function:</p>
<div class='sage_linked'><script type='text/x-sage'>var('x y z c')
eq1 = 0.009*x+0.028*y==0.9
eq2 = 0.52*x+0.02*y+0.8*z==8
cost = 0.18*x+0.23*y+0.05*z==c
Eqns = [eq1,eq2,cost,z==r]
sol = solve(Eqns,[x,y,z,c])
if sol==[]:
    print "Execute code in the previous cell!"
else: print sol</script></div><p>Since the cost remained positive after taking <span class="math notranslate nohighlight">\(z=r\)</span>, it seems that the above solution solves our diet problem. However, since this time the picture was not as clear as in the previous example, this solution should be verified by using another method.</p>
<p>The last example already indicated demand for a more rigorous method. And of course, if the problem is more complex and deals with several variables (what often happens in practice), there is no way to obtain a good illustration of the problem. This is where linear algebra comes into play.</p>
</section>
<section id="the-simplex-method">
<h2>The Simplex Method<a class="headerlink" href="#the-simplex-method" title="Permalink to this headline">¶</a></h2>
<p>The algorithm was invented by an American mathematician George Dantzig in 1940s.</p>
<p>We demonstrate a solution of <em>the Standard Minimum Problem</em> with <span class="math notranslate nohighlight">\(m\)</span> unknowns <span class="math notranslate nohighlight">\(x_1,\ldots, x_m\geq 0\)</span> and <span class="math notranslate nohighlight">\(n+m\)</span> constraints:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}
\text{minimize:} &amp;  c_1x_1 + \ldots + c_mx_m\\
\text{constraints:} &amp; a_{j1}x_1+ \ldots + a_{jm}x_m \geq b_j\, ,\quad j\in\left\{ 1,\ldots ,n\right\}\\
&amp; x_i\geq 0 \, ,\quad i\in\left\{ 1,\ldots ,m\right\}\\
\end{array}\end{split}\]</div>
<p>which may be written in a matrix form as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}
\text{minimize:} &amp;  \boldsymbol{c}^T\boldsymbol{x}\\
\text{constraints:} &amp; \boldsymbol{A}\boldsymbol{x} \geq \boldsymbol{b}\\
&amp; \boldsymbol{x}\geq 0,\\
\end{array}\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}\boldsymbol{c}\,=\,\left[\begin{array}{c}
                      c_{1} \\ \vdots \\ c_{m}
                   \end{array}\right]\,,
\qquad
\boldsymbol{x}\,=\,\left[\begin{array}{c}
                      x_{1} \\ \vdots \\ x_{m}
                   \end{array}\right]\,,
\qquad
\boldsymbol{A}\  =\  \left[\;\begin{array}{ccc}
                        a_{11} &amp; \ldots &amp; a_{1m} \\
                        \vdots &amp; \ddots &amp; \vdots \\
                        a_{n1} &amp; \ldots &amp; a_{nm}
                     \end{array}\right]\,,
\qquad
\boldsymbol{b}\,=\,\left[\begin{array}{c}
                      b_{1} \\ \vdots \\ b_{n}
                   \end{array}\right]\,,\end{split}\]</div>
<p>and by <span class="math notranslate nohighlight">\(\ \boldsymbol{x}\geq 0\ \)</span> (or <span class="math notranslate nohighlight">\(\boldsymbol{A}\boldsymbol{x} \geq \boldsymbol{b}\)</span>) we mean that each coordinate of the vector <span class="math notranslate nohighlight">\(\ \boldsymbol{x}\ \)</span> (or <span class="math notranslate nohighlight">\(\boldsymbol{A}\boldsymbol{x}-\boldsymbol{b}\)</span>) is greater or equal zero.</p>
<p>We will explain the consecutive steps along the way by referring to Example 1. discussed above, which we rewrite as the minimization problem:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}
\text{minimize:} &amp;  -2x -3y\\
\text{constraints:} &amp; -2x -4y \geq -40 \,,\\
&amp; -3x -2y \geq -24 \,,\\
&amp; -3x-y \geq -18 \,,\\
&amp; x, y\geq 0 \,.\\
\end{array}\end{split}\]</div>
<div class="admonition-step-i admonition">
<p class="admonition-title">Step I:</p>
<p>Change the constraints <span class="math notranslate nohighlight">\(\boldsymbol{A}\boldsymbol{x} \geq \boldsymbol{b}\)</span> into equalities by introducing new variables.</p>
</div>
<p>Observe that the constraint <span class="math notranslate nohighlight">\(\ \boldsymbol{A}\boldsymbol{x} \geq \boldsymbol{b}\ \)</span> may be equivalently written as
<span class="math notranslate nohighlight">\(\ \boldsymbol{w} =\boldsymbol{A}\boldsymbol{x} - \boldsymbol{b}\, ,\quad \boldsymbol{w}\geq 0\ \)</span>.
Therefore the following problems are equivalent:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{cases} min\quad \boldsymbol{c}^T\boldsymbol{x}\\
\boldsymbol{A}\boldsymbol{x} \geq \boldsymbol{b}\\
\boldsymbol{x}\geq 0\end{cases}
\qquad\Longleftrightarrow\qquad
\begin{cases} min\quad \left[\begin{array}{c} \boldsymbol{c}^T &amp; \boldsymbol{0}^T\end{array}\right]
\left[\begin{array}{c}\boldsymbol{x}\\ \boldsymbol{w}\end{array}\right]\\
\left[\boldsymbol{A}\;\; -I\right]\left[\begin{array}{c}\boldsymbol{x}\\ \boldsymbol{w}\end{array}\right]
=\boldsymbol{b}\\
\boldsymbol{x},\, \boldsymbol{w}\geq 0
\end{cases}\end{split}\]</div>
<p>We simplify our notation:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\left[\boldsymbol{A}\;\; -I\right]\)</span> is renamed <span class="math notranslate nohighlight">\(\ \boldsymbol{A}\ \)</span>,
<span class="math notranslate nohighlight">\(\ \ \left[\begin{array}{c}\boldsymbol{x}\\ \boldsymbol{w}\end{array}\right]\)</span> is renamed <span class="math notranslate nohighlight">\(\ \boldsymbol{x}\ \)</span>,
<span class="math notranslate nohighlight">\(\ \ \left[\begin{array}{c} \boldsymbol{c}\\ \boldsymbol{0}\end{array}\right]\)</span> is renamed <span class="math notranslate nohighlight">\(\ \boldsymbol{c}\ \)</span>,</p>
</div></blockquote>
<p>so that we have to solve the problem</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}
\text{minimize:} &amp;  \boldsymbol{c}^T\boldsymbol{x}\\
\text{constraints:} &amp; \boldsymbol{A}\boldsymbol{x} = \boldsymbol{b}\\
&amp; \boldsymbol{x}\geq 0,\\
\end{array}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span> is <span class="math notranslate nohighlight">\(n\times (m+n)\)</span> matrix and <span class="math notranslate nohighlight">\(x\)</span> has <span class="math notranslate nohighlight">\(m+n\)</span> components. We will call
<span class="math notranslate nohighlight">\(\boldsymbol{c}^T\boldsymbol{x}\)</span> the cost function.</p>
<p><strong>Example.</strong></p>
<p>In case of Example 1., we obtain</p>
<div class="math notranslate nohighlight">
\[\begin{split}\boldsymbol{A}=\left[\begin{array}{ccccc}
-2 &amp; -4 &amp; -1 &amp; 0 &amp; 0\\
-3 &amp; -2 &amp; 0 &amp; -1 &amp; 0\\
-3 &amp; -1 &amp; 0 &amp; 0 &amp; -1\\
\end{array}\right],\qquad
\boldsymbol{b}=\left[\begin{array}{c} -40 \\ -24 \\ -18 \end{array}\right],\qquad
\boldsymbol{c}=\left[\begin{array}{c} -2 \\ -3 \\ 0 \\ 0 \\ 0 \end{array}\right],\qquad
\boldsymbol{x}=\left[\begin{array}{c} x \\ y \\ w_1 \\ w_2 \\ w_3 \end{array}\right].\end{split}\]</div>
<div class="admonition-step-ii admonition">
<p class="admonition-title">Step II:</p>
<p>Find a point that satisfies the constraints.</p>
</div>
<p>It is convenient to write down the data in the tableau: <span class="math notranslate nohighlight">\(\ T=\left[\begin{array}{cc} \boldsymbol{A} &amp; \boldsymbol{b}\\ \boldsymbol{c} &amp; 0\end{array}\right]\)</span>. Recall that <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span> is <span class="math notranslate nohighlight">\(n\times (m+n)\)</span> matrix, and so it may be written as
<span class="math notranslate nohighlight">\([\boldsymbol{B}\;\; \boldsymbol{N}]\ \)</span> where <span class="math notranslate nohighlight">\(\boldsymbol{B}\)</span> is a square matrix of size <span class="math notranslate nohighlight">\(n\)</span>, and <span class="math notranslate nohighlight">\(\boldsymbol{N}\)</span> is <span class="math notranslate nohighlight">\(n\times m\)</span> matrix. Similarly, we can write
<span class="math notranslate nohighlight">\(\ \boldsymbol{c}=\left[\begin{array}{c}\boldsymbol{c_B}\\ \boldsymbol{c_N}\end{array}\right]\)</span>,
<span class="math notranslate nohighlight">\(\ \boldsymbol{x}=\left[\begin{array}{c}\boldsymbol{x_B}\\ \boldsymbol{x_N}\end{array}\right]\)</span>, where
<span class="math notranslate nohighlight">\(\boldsymbol{c_B}\)</span>, <span class="math notranslate nohighlight">\(\boldsymbol{x_B}\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{c_N}\)</span>, <span class="math notranslate nohighlight">\(\boldsymbol{x_N}\)</span>
have respectively <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(m\)</span> components. In this way,</p>
<div class="math notranslate nohighlight">
\[\begin{split}T=\left[\begin{array}{cccc} \boldsymbol{B} &amp; \boldsymbol{N} &amp; | &amp; \boldsymbol{b}\\
\boldsymbol{c_B}^T &amp; \boldsymbol{c_N}^T &amp; | &amp; 0\end{array}\right]\,,\qquad
\boldsymbol{x}=\left[\begin{array}{c} \boldsymbol{x_B} \\ \boldsymbol{x_N}\end{array}\right],\end{split}\]</div>
<p>which should be interpreted as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[\begin{array}{cc} \boldsymbol{B} &amp; \boldsymbol{N}\end{array}\right]
\left[\begin{array}{c} \boldsymbol{x_B} \\ \boldsymbol{x_N}\end{array}\right]
=\boldsymbol{b}\,,\qquad\text{minimize:}\;\;
\left[\begin{array}{cc} \boldsymbol{c_B}^T &amp; \boldsymbol{c_N}^T\end{array}\right]
\left[\begin{array}{c} \boldsymbol{x_B} \\ \boldsymbol{x_N}\end{array}\right]\, .\end{split}\]</div>
<p>In order to find a point <span class="math notranslate nohighlight">\(\boldsymbol{x_B}\)</span> which satisfies the constraints of the problem it suffices to perform Gauss Jordan elimination on the first <span class="math notranslate nohighlight">\(n\)</span> rows of <span class="math notranslate nohighlight">\(T\)</span> (i.e., excluding the last row) so that the submatrix <span class="math notranslate nohighlight">\([\boldsymbol{B}\; \boldsymbol{N}]\)</span> is in reduced row echelon form. This is equivalent to multiplication of these rows by <span class="math notranslate nohighlight">\(\boldsymbol{B}^{-1}\)</span> on the left. We obtain:</p>
<div class="math notranslate nohighlight">
\[\begin{split}T=\left[\begin{array}{cccc} \boldsymbol{I} &amp; \boldsymbol{B}^{-1}\boldsymbol{N} &amp; | &amp; \boldsymbol{B}^{-1}\boldsymbol{b}\\
\boldsymbol{c_B}^T &amp; \boldsymbol{c_N}^T &amp; | &amp; 0\end{array}\right]\,,\end{split}\]</div>
<p>which means that</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{x_B} = -\boldsymbol{B}^{-1}\boldsymbol{N}\boldsymbol{x_N}+\boldsymbol{B}^{-1}\boldsymbol{b}\,.\]</div>
<p>Hence, the problem to minimize the quantity <span class="math notranslate nohighlight">\(\ \boldsymbol{c_B}^T\boldsymbol{x_B}+\boldsymbol{c_N}^T\boldsymbol{x_N}\ \)</span> becomes</p>
<div class="math notranslate nohighlight">
\[\text{minimize:}\qquad (-\boldsymbol{c_B}^T\boldsymbol{B}^{-1}\boldsymbol{N}+\boldsymbol{c_N}^T)\boldsymbol{x_N}
+\boldsymbol{c_B}^T\boldsymbol{B}^{-1}\boldsymbol{b}\, .\]</div>
<p><strong>Example.</strong></p>
<p>In Example 1.,</p>
<div class="math notranslate nohighlight">
\[\begin{split}T=\left[\begin{array}{ccccccc}
-2 &amp; -4 &amp; -1 &amp; 0 &amp; 0 &amp; | &amp; -40\\
-3 &amp; -2 &amp; 0 &amp; -1 &amp; 0 &amp; | &amp; -24\\
-3 &amp; -1 &amp; 0 &amp; 0 &amp; -1 &amp; | &amp; -18\\
-2 &amp; -3 &amp; 0 &amp; 0 &amp;  0 &amp; | &amp; 0\\
\end{array}\right]\,.\end{split}\]</div>
<p>We use Sage to determine <span class="math notranslate nohighlight">\(\boldsymbol{x_B}\)</span> and current cost.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">B</span><span class="o">=</span><span class="n">Matrix</span><span class="p">([[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">N</span><span class="o">=</span><span class="n">Matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">b</span><span class="o">=</span><span class="n">Matrix</span><span class="p">([[</span><span class="o">-</span><span class="mi">40</span><span class="p">],[</span><span class="o">-</span><span class="mi">24</span><span class="p">],[</span><span class="o">-</span><span class="mi">18</span><span class="p">]])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">cB</span><span class="o">=</span><span class="n">Matrix</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">cN</span><span class="o">=</span><span class="n">Matrix</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">T</span><span class="o">=</span><span class="n">block_matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,[[</span><span class="n">B</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">b</span><span class="p">],[</span><span class="n">cB</span><span class="p">,</span> <span class="n">cN</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">T</span>

<span class="p">[</span> <span class="o">-</span><span class="mi">2</span>  <span class="o">-</span><span class="mi">4</span>  <span class="o">-</span><span class="mi">1</span><span class="o">|</span>  <span class="mi">0</span>   <span class="mi">0</span><span class="o">|-</span><span class="mi">40</span><span class="p">]</span>
<span class="p">[</span> <span class="o">-</span><span class="mi">3</span>  <span class="o">-</span><span class="mi">2</span>   <span class="mi">0</span><span class="o">|</span> <span class="o">-</span><span class="mi">1</span>   <span class="mi">0</span><span class="o">|-</span><span class="mi">24</span><span class="p">]</span>
<span class="p">[</span> <span class="o">-</span><span class="mi">3</span>  <span class="o">-</span><span class="mi">1</span>   <span class="mi">0</span><span class="o">|</span>  <span class="mi">0</span>  <span class="o">-</span><span class="mi">1</span><span class="o">|-</span><span class="mi">18</span><span class="p">]</span>
<span class="p">[</span><span class="o">-----------+-------+---</span><span class="p">]</span>
<span class="p">[</span> <span class="o">-</span><span class="mi">2</span>  <span class="o">-</span><span class="mi">3</span>   <span class="mi">0</span><span class="o">|</span>  <span class="mi">0</span>   <span class="mi">0</span><span class="o">|</span>  <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>Before we proceed, let’s look what is actually happenning. The above table means that we are looking for a solution of the following system of equations:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{alignat*}{7}
-2x &amp; \, - \, 4y &amp; \, - \, w_1 &amp; &amp; &amp; \; =\; &amp; -40 \\
-3x &amp; \, - \, 2y &amp; &amp; \, - \, w_2 &amp; &amp; \; =\; &amp; -24 \\
-3x &amp; \, - \, y &amp; &amp; &amp; \, - \, w_3 &amp; \; =\; &amp; -18
\end{alignat*}\end{split}\]</div>
<p>This can be rewritten in a column picture, so that we obtain an equality between a vector and a linear combination of five three-dimensional vectors:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[\begin{array}{r} -2\\ -3\\ -3\end{array}\right] x +
\left[\begin{array}{r} -4\\ -2\\ -1\end{array}\right] y +
\left[\begin{array}{r} -1\\ 0\\ 0\end{array}\right] w_1 +
\left[\begin{array}{r} 0\\ -1\\ 0\end{array}\right] w_2 +
\left[\begin{array}{r} 0\\ 0\\ -1\end{array}\right] w_3 =
\left[\begin{array}{r} -40\\ -24\\ -18\end{array}\right]\end{split}\]</div>
<p>However, two of the vectors on the left may be expressed in terms of the three other vectors (see Theorem 5 in <a class="reference internal" href="introduction_fundamental-concepts.html#intro-dimension"><span class="std std-ref">Dimension of a Vector Space</span></a> or <a class="reference internal" href="dowody_podstawy_algebry_liniowej.html#proofs-fund"><span class="std std-ref">Fundamental Concepts in Linear Algebra</span></a> for a proof of Theorem 5). Hence the division in the table: at the first stage <span class="math notranslate nohighlight">\(\ w_2,\, w_3\ \)</span> serve as parameters and will guide us later how to optimize the cost function.</p>
<p>If we set <span class="math notranslate nohighlight">\(w_2=w_3=0\)</span>, the above equation means that we restrict our attention to the plane spanned by the first three vectors (or in other words: generated by the points <span class="math notranslate nohighlight">\(\ (-2,-3,-3),\, (-4,-2,-1),\, (-1,0,0)\ \)</span>) and look for constants <span class="math notranslate nohighlight">\(x,y,w_1\)</span> so that the linear combination</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[\begin{array}{r} -2\\ -3\\ -3\end{array}\right] x +
\left[\begin{array}{r} -4\\ -2\\ -1\end{array}\right] y +
\left[\begin{array}{r} -1\\ 0\\ 0\end{array}\right] w_1\end{split}\]</div>
<p>is equal to <span class="math notranslate nohighlight">\(\boldsymbol{b}=\left[\begin{array}{ccc} -40 &amp; -24 &amp; -18\end{array}\right]^T\)</span>.</p>
<p>From another point of view, coming back to the row picture (but with <span class="math notranslate nohighlight">\(w_2=w_3=0\)</span>), the system of equations</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{alignat*}{5}
-2x &amp; \, - \, 4y &amp; \, - \, w_1 &amp; \; =\; &amp; -40 \\
-3x &amp; \, - \, 2y &amp;  &amp; \; =\; &amp; -24 \\
-3x &amp; \, - \, y  &amp;  &amp; \; =\; &amp; -18
\end{alignat*}\end{split}\]</div>
<p>may be interpreted by picture from Example 1: it represents the intersection point of the blue and the green line under the additional condition that this point is under the purple line.</p>
<p>In order to find <span class="math notranslate nohighlight">\(x,y,w_1\)</span>, we multiply the matrix <span class="math notranslate nohighlight">\(T\)</span> by
<span class="math notranslate nohighlight">\(\ \left[\begin{array}{cc} \boldsymbol{B}^{-1} &amp; \boldsymbol{0}\\ \boldsymbol{0} &amp; 1 \end{array}\right]\ \)</span>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">T</span><span class="o">=</span><span class="n">block_matrix</span><span class="p">([[</span><span class="n">B</span><span class="o">.</span><span class="n">inverse</span><span class="p">(),</span><span class="n">zero_matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)],[</span><span class="n">zero_matrix</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="mi">1</span><span class="p">]])</span><span class="o">*</span><span class="n">T</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">T</span>

<span class="p">[</span>    <span class="mi">1</span>     <span class="mi">0</span>     <span class="mi">0</span><span class="o">|</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span>   <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">|</span>    <span class="mi">4</span><span class="p">]</span>
<span class="p">[</span>    <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">0</span><span class="o">|</span>    <span class="mi">1</span>    <span class="o">-</span><span class="mi">1</span><span class="o">|</span>    <span class="mi">6</span><span class="p">]</span>
<span class="p">[</span>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">1</span><span class="o">|-</span><span class="mi">10</span><span class="o">/</span><span class="mi">3</span>   <span class="mi">8</span><span class="o">/</span><span class="mi">3</span><span class="o">|</span>    <span class="mi">8</span><span class="p">]</span>
<span class="p">[</span><span class="o">-----------------+-----------+-----</span><span class="p">]</span>
<span class="p">[</span>   <span class="o">-</span><span class="mi">2</span>    <span class="o">-</span><span class="mi">3</span>     <span class="mi">0</span><span class="o">|</span>    <span class="mi">0</span>     <span class="mi">0</span><span class="o">|</span>    <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>Hence,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{alignat*}{3}
x &amp;\; =\; &amp; \frac13 w_2 &amp;\, -\,\frac23 w_3 &amp; \, +\, 4\\
y &amp;\; =\; &amp; -w_2 &amp; \, +\, w_3 &amp;\, +\, 6\\
w_1 &amp;\; =\; &amp; \frac{10}{3} w_2 &amp; \, -\,\frac83 w_3 &amp; \, +\, 8
\end{alignat*}\end{split}\]</div>
<p>and if we set <span class="math notranslate nohighlight">\(w_2=w_3=0\)</span>, we obtain <span class="math notranslate nohighlight">\((x,y,w_1)=(4,6,8)\)</span> which corresponds to the point <span class="math notranslate nohighlight">\((4,6)\)</span>, the intersection of the blue and the green line, as expected.</p>
<p>The cost at this corner is equal to</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[\begin{array}{ccc} -2 &amp; -3 &amp; 0 \end{array}\right] \left[\begin{array}{c} 4 \\ 6\\ 8 \end{array}\right]
= -26 .\end{split}\]</div>
<p>However, if we do not specialise to <span class="math notranslate nohighlight">\(w_2=w_3=0\)</span> but rather allow these parameters to vary, we obtain the actual cost:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[\begin{array}{ccc} -2 &amp; -3 &amp; 0 \end{array}\right] \left[\begin{array}{c} x \\ y\\ w_1 \end{array}\right]
= -2\left(\frac13 w_2 -\frac23 w_3\right)-3\left(-w_2 + w_3\right)+0\left(\frac{10}{3} w_2 -\frac83 w_3\right)
=\frac73 w_2 -\frac53 w_3 -26\, .\end{split}\]</div>
<p>Since we require <span class="math notranslate nohighlight">\(w_2, w_3\geq 0\)</span>, it is clear that taking <span class="math notranslate nohighlight">\(w_3&gt; 0\)</span> will reduce the cost.
Geometrically, this means that the point <span class="math notranslate nohighlight">\((x,y)\)</span> should be allowed to be strictly under the blue line.</p>
<div class="admonition-step-iii admonition">
<p class="admonition-title">Step III:</p>
<p>Is the cost at this point lowest possible?</p>
</div>
<p>In Step II we obtained the point <span class="math notranslate nohighlight">\(\boldsymbol{x_B} = -\boldsymbol{B}^{-1}\boldsymbol{N}\boldsymbol{x_N}+\boldsymbol{B}^{-1}\boldsymbol{b}\)</span> which satisfies the contraints of the problem.
However, the corresponding cost</p>
<div class="math notranslate nohighlight">
\[(\boldsymbol{c_N}^T-\boldsymbol{c_B}^T\boldsymbol{B}^{-1}\boldsymbol{N})\boldsymbol{x_N}
+\boldsymbol{c_B}^T\boldsymbol{B}^{-1}\boldsymbol{b}\]</div>
<p>may not be minimal. As long as one of the entries of <span class="math notranslate nohighlight">\(\ \boldsymbol{c_N}^T-\boldsymbol{c_B}^T\boldsymbol{B}^{-1}\boldsymbol{N}\ \)</span> is negative, it is possible to choose the corresponding entry of <span class="math notranslate nohighlight">\(\ \boldsymbol{x_N}\ \)</span> to be non-zero and thus reduce the cost. If <span class="math notranslate nohighlight">\(\ \boldsymbol{c_N}^T-\boldsymbol{c_B}^T\boldsymbol{B}^{-1}\boldsymbol{N}\geq 0\ \)</span>, then the cost at the point <span class="math notranslate nohighlight">\(\boldsymbol{x}\)</span> is minimal and is equal to <span class="math notranslate nohighlight">\(\ \boldsymbol{c}^T\boldsymbol{x}\ \)</span>.</p>
<p>The above considerations justify the next operation on rows of the tableau <span class="math notranslate nohighlight">\(T\)</span>:</p>
<blockquote>
<div><p>subtract from the last row the product of <span class="math notranslate nohighlight">\(\boldsymbol{c_B}\)</span> and the first <span class="math notranslate nohighlight">\(n\)</span> rows,</p>
</div></blockquote>
<div class="math notranslate nohighlight">
\[\begin{split}\left[\begin{array}{cc} \boldsymbol{I} &amp; \boldsymbol{0}\\ -\boldsymbol{c_B}^T &amp; 1\end{array}\right]\cdot
\left[\begin{array}{cccc} \boldsymbol{I} &amp; \boldsymbol{B}^{-1}\boldsymbol{N} &amp; | &amp; \boldsymbol{B}^{-1}\boldsymbol{b}\\
\boldsymbol{c_B}^T &amp; \boldsymbol{c_N}^T &amp; | &amp; 0\end{array}\right]
=\left[\begin{array}{cccc} \boldsymbol{I} &amp; \boldsymbol{B}^{-1}\boldsymbol{N} &amp; | &amp; \boldsymbol{B}^{-1}\boldsymbol{b}\\
\boldsymbol{0} &amp; \boldsymbol{c_N}^T-\boldsymbol{c_B}^T\boldsymbol{B}^{-1}\boldsymbol{N} &amp; |
&amp; -\boldsymbol{c_B}^T\boldsymbol{B}^{-1}\boldsymbol{b}\end{array}\right]\,.\end{split}\]</div>
<p><strong>Example</strong></p>
<p>We apply the above operation to the matrix <span class="math notranslate nohighlight">\(T\)</span> from our example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">T</span><span class="o">=</span><span class="n">block_matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,[[</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">zero_matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)],[</span><span class="o">-</span><span class="n">cB</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span><span class="o">*</span><span class="n">T</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">T</span>

<span class="p">[</span>    <span class="mi">1</span>     <span class="mi">0</span>     <span class="mi">0</span><span class="o">|</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span>   <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">|</span>    <span class="mi">4</span><span class="p">]</span>
<span class="p">[</span>    <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">0</span><span class="o">|</span>    <span class="mi">1</span>    <span class="o">-</span><span class="mi">1</span><span class="o">|</span>    <span class="mi">6</span><span class="p">]</span>
<span class="p">[</span>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">1</span><span class="o">|-</span><span class="mi">10</span><span class="o">/</span><span class="mi">3</span>   <span class="mi">8</span><span class="o">/</span><span class="mi">3</span><span class="o">|</span>    <span class="mi">8</span><span class="p">]</span>
<span class="p">[</span><span class="o">-----------------+-----------+-----</span><span class="p">]</span>
<span class="p">[</span>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span><span class="o">|</span>  <span class="mi">7</span><span class="o">/</span><span class="mi">3</span>  <span class="o">-</span><span class="mi">5</span><span class="o">/</span><span class="mi">3</span><span class="o">|</span>   <span class="mi">26</span><span class="p">]</span>
</pre></div>
</div>
<p>Since the submatrix corresponding to <span class="math notranslate nohighlight">\(\ \boldsymbol{c_N}^T-\boldsymbol{c_B}^T\boldsymbol{B}^{-1}\boldsymbol{N}\ \)</span> contains a negative number:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">subdivision</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="p">[</span> <span class="mi">7</span><span class="o">/</span><span class="mi">3</span> <span class="o">-</span><span class="mi">5</span><span class="o">/</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<p>the current cost <span class="math notranslate nohighlight">\(-26\)</span> is not minimal.</p>
<div class="admonition-step-iv admonition">
<p class="admonition-title">Step IV:</p>
<p>If the cost is not minimal, change the basis.</p>
</div>
<p>Assume that the <span class="math notranslate nohighlight">\(i\)</span>-th entry of <span class="math notranslate nohighlight">\(\ \boldsymbol{c_N}^T-\boldsymbol{c_B}^T\boldsymbol{B}^{-1}\boldsymbol{N}\ \)</span> is negative.
Hence, in order to reduce the cost we should include <span class="math notranslate nohighlight">\(x_{N,i}\)</span> to the basis. This means that we have to exclude another variable. Which variable should be excluded so that the cost is reduced?</p>
<p>Compare the quotients of the entries of the last column
<span class="math notranslate nohighlight">\(\boldsymbol{B}^{-1}\boldsymbol{b}=\left[b_1', b_2',\ldots, b_n'\right]^T\)</span> and the <span class="math notranslate nohighlight">\(i\)</span>-th column of <span class="math notranslate nohighlight">\(\boldsymbol{B}^{-1}\boldsymbol{N}=[r_{v\nu}]\ \)</span>:
<span class="math notranslate nohighlight">\(\ \begin{array}{cccc} \frac{b_1'}{r_{1i}}, &amp; \frac{b_2'}{r_{2i}}, &amp;\ldots, &amp; \frac{b_n'}{r_{ni}}\end{array}\ \)</span>.
For simplicity assume that the <em>smallest positive</em> is the <span class="math notranslate nohighlight">\(1\)</span>-st quotient <span class="math notranslate nohighlight">\(\frac{b_1'}{r_{1i}}\)</span>. In this case we exchange the <span class="math notranslate nohighlight">\(1\)</span>-st column of the tableau <span class="math notranslate nohighlight">\(T\)</span> with the <span class="math notranslate nohighlight">\(n+i\)</span>-th column, so that:</p>
<div class="math notranslate nohighlight">
\[\begin{split}T=\left[\begin{array}{ccccccccccc}
r_{1i} &amp; 0 &amp; \ldots &amp; 0 &amp; r_{11} &amp; \ldots &amp; 1 &amp; \ldots &amp; r_{1m} &amp; | &amp; b_1'\\
r_{2i} &amp; 1 &amp; \ldots &amp; 0 &amp; r_{21} &amp; \ldots &amp; 0 &amp; \ldots &amp; r_{2m} &amp; | &amp; b_2'\\
\vdots &amp; \vdots      &amp; \ddots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \ddots &amp; \vdots &amp; | &amp; \vdots\\
r_{ni} &amp; 0 &amp; \ldots &amp; 1 &amp; r_{n1} &amp; \ldots &amp; 0 &amp; \ldots &amp; r_{nm} &amp; | &amp; b_n'\\
c_i'                &amp; 0 &amp; \ldots &amp; 0 &amp; c_1'  &amp; \ldots &amp; 0  &amp; \ldots &amp; c_m'   &amp; | &amp;
-\boldsymbol{c_B}^T\boldsymbol{B}^{-1}\boldsymbol{b}
\end{array}\right]\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\ \boldsymbol{c_N}^T-\boldsymbol{c_B}^T\boldsymbol{B}^{-1}\boldsymbol{N} = \left[c_1', c_2',\ldots, c_m'\right]\)</span>.</p>
<p>Note that one of the things that we have to do in order to write <span class="math notranslate nohighlight">\(T\)</span> in reduced row echelon form is to divide each row of the matrix by the entries from the first column; this will make the last column equal to <span class="math notranslate nohighlight">\(\left[\frac{b_1'}{r_{1i}}, \frac{b_2'}{r_{2i}},\ldots, \frac{b_n'}{r_{ni}}\right]^T\)</span> and because now only the first entry of first <span class="math notranslate nohighlight">\(n\)</span> entries in the last row of <span class="math notranslate nohighlight">\(T\)</span> is non-zero, only <span class="math notranslate nohighlight">\(\frac{b_1'}{r_{1i}}\)</span> will contribute to the cost.</p>
<p><strong>Example</strong></p>
<p>As we noticed above, allowing <span class="math notranslate nohighlight">\(w_3&gt;0\)</span> (or, in other words, allowing the point <span class="math notranslate nohighlight">\((x,y)\)</span> to be strictly under the blue line) wil reduce the cost. Moreover, the plane corresponding to the cost function <span class="math notranslate nohighlight">\(\boldsymbol{c}^T\boldsymbol{x}\)</span> will touch the feasible set first on the boundary (and in most cases, the corner of the set). Last time we reached the point <span class="math notranslate nohighlight">\((4,6)\)</span>. Decision to stay under the blue line should correspond to moving up along the green line to the point <span class="math notranslate nohighlight">\((2,9)\)</span>.</p>
<p>First we compute the quotients of the entries in the last column and the column above <span class="math notranslate nohighlight">\(-\frac53\)</span> of the matrix <span class="math notranslate nohighlight">\(T\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
<span class="n">sage</span><span class="p">:</span>     <span class="nb">print</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span>

<span class="mi">6</span>
<span class="o">-</span><span class="mi">6</span>
<span class="mi">3</span>
</pre></div>
</div>
<p>The smallest positive is the third quotient. Observe that the third column of <span class="math notranslate nohighlight">\(T\)</span> corresponds exactly to the additional variable <span class="math notranslate nohighlight">\(w_1\)</span>. Hence, if we exhange the third column of the matrix <span class="math notranslate nohighlight">\(T\)</span> with the fifth column, we do not lose variables <span class="math notranslate nohighlight">\(x,y\)</span>; the only thing that changes is that now we allow to be under the blue line and want to stay on the border of the purple line.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">swap_columns</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">T</span>

<span class="p">[</span>    <span class="mi">1</span>     <span class="mi">0</span>   <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">|</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span>     <span class="mi">0</span><span class="o">|</span>    <span class="mi">4</span><span class="p">]</span>
<span class="p">[</span>    <span class="mi">0</span>     <span class="mi">1</span>    <span class="o">-</span><span class="mi">1</span><span class="o">|</span>    <span class="mi">1</span>     <span class="mi">0</span><span class="o">|</span>    <span class="mi">6</span><span class="p">]</span>
<span class="p">[</span>    <span class="mi">0</span>     <span class="mi">0</span>   <span class="mi">8</span><span class="o">/</span><span class="mi">3</span><span class="o">|-</span><span class="mi">10</span><span class="o">/</span><span class="mi">3</span>     <span class="mi">1</span><span class="o">|</span>    <span class="mi">8</span><span class="p">]</span>
<span class="p">[</span><span class="o">-----------------+-----------+-----</span><span class="p">]</span>
<span class="p">[</span>    <span class="mi">0</span>     <span class="mi">0</span>  <span class="o">-</span><span class="mi">5</span><span class="o">/</span><span class="mi">3</span><span class="o">|</span>  <span class="mi">7</span><span class="o">/</span><span class="mi">3</span>     <span class="mi">0</span><span class="o">|</span>   <span class="mi">26</span><span class="p">]</span>
</pre></div>
</div>
<p>We perform the steps II and III again.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">T</span><span class="o">=</span><span class="n">block_matrix</span><span class="p">([[</span><span class="n">T</span><span class="o">.</span><span class="n">subdivision</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">inverse</span><span class="p">(),</span><span class="n">zero_matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)],[</span><span class="n">zero_matrix</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="mi">1</span><span class="p">]])</span><span class="o">*</span><span class="n">T</span>

<span class="p">[</span>   <span class="mi">1</span>    <span class="mi">0</span>    <span class="mi">0</span><span class="o">|</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">|</span>   <span class="mi">2</span><span class="p">]</span>
<span class="p">[</span>   <span class="mi">0</span>    <span class="mi">1</span>    <span class="mi">0</span><span class="o">|-</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span>  <span class="mi">3</span><span class="o">/</span><span class="mi">8</span><span class="o">|</span>   <span class="mi">9</span><span class="p">]</span>
<span class="p">[</span>   <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">1</span><span class="o">|-</span><span class="mi">5</span><span class="o">/</span><span class="mi">4</span>  <span class="mi">3</span><span class="o">/</span><span class="mi">8</span><span class="o">|</span>   <span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="o">--------------+---------+----</span><span class="p">]</span>
<span class="p">[</span>   <span class="mi">0</span>    <span class="mi">0</span> <span class="o">-</span><span class="mi">5</span><span class="o">/</span><span class="mi">3</span><span class="o">|</span> <span class="mi">7</span><span class="o">/</span><span class="mi">3</span>    <span class="mi">0</span><span class="o">|</span>  <span class="mi">26</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">T</span><span class="o">=</span><span class="n">block_matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,[[</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">zero_matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)],[</span><span class="o">-</span><span class="n">T</span><span class="o">.</span><span class="n">subdivision</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">1</span><span class="p">]])</span><span class="o">*</span><span class="n">T</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">T</span>

<span class="p">[</span>   <span class="mi">1</span>    <span class="mi">0</span>    <span class="mi">0</span><span class="o">|</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">|</span>   <span class="mi">2</span><span class="p">]</span>
<span class="p">[</span>   <span class="mi">0</span>    <span class="mi">1</span>    <span class="mi">0</span><span class="o">|-</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span>  <span class="mi">3</span><span class="o">/</span><span class="mi">8</span><span class="o">|</span>   <span class="mi">9</span><span class="p">]</span>
<span class="p">[</span>   <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">1</span><span class="o">|-</span><span class="mi">5</span><span class="o">/</span><span class="mi">4</span>  <span class="mi">3</span><span class="o">/</span><span class="mi">8</span><span class="o">|</span>   <span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="o">--------------+---------+----</span><span class="p">]</span>
<span class="p">[</span>   <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span><span class="o">|</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span>  <span class="mi">5</span><span class="o">/</span><span class="mi">8</span><span class="o">|</span>  <span class="mi">31</span><span class="p">]</span>
</pre></div>
</div>
<p>As we can see, now all the entries of the last row are positive, and thus the cost cannot be reduced further. The minimal cost equals <span class="math notranslate nohighlight">\(\ -31\ \)</span> and is achieved at the point <span class="math notranslate nohighlight">\(\ (2,9)\ \)</span> as expected. Since we changed the original problem of maximization to minimization, the original cost we wanted to compute is <span class="math notranslate nohighlight">\(\ -(-31)=31\ \)</span>.</p>
<div class="admonition-step-v admonition">
<p class="admonition-title">Step V:</p>
<p>Repeat the steps II-IV until the cost is minimal.</p>
</div>
<p>The above explanation was partially inspired by an excellent lecture of prof. Craig Tovey, professor in the Georgia Tech Stewart School of Industrial and Systems Engineering. The reader is encouraged to watch that <a class="reference external" href="https://www.youtube.com/watch?v=Ci1vBGn9yRc">lecture</a> for further clarification.</p>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<p>Since the solutions of the exercises below require writing a lot of code, it may be better to download them from <a class="reference external" href="http://visual.icse.us.edu.pl/LA/Notebooks/Linear-prog-ex.ipynb">here</a> in a form of a notebook and then open them e.g. via CoCalc available <a class="reference external" href="https://cocalc.com/settings?session=default">here</a></p>
<p><strong>Exercise 1.</strong></p>
<p>One school organizes a trip for 250 people. A shipping company offers coaches of types A, B, C which can take 32, 45 and 60 people resepctively, and cost 600, 800 and 1000 euros respectively. Find out how many coaches of each type the school should hire so that the cost is minimal.</p>
<div class='sage_linked'><script type='text/x-sage'></script></div><p><strong>Exercise 2.</strong></p>
<p>Consider the diet problem from Example 2. Use simplex method to verify whether the solution obtained by the geometric method is correct.</p>
<div class='sage_linked'><script type='text/x-sage'></script></div><p><strong>Exercise 3.</strong></p>
<p>A company Woolwear produces jackets, sweaters and shirts out of wool (<span class="math notranslate nohighlight">\(60\)</span> units), cotton (<span class="math notranslate nohighlight">\(100\)</span> units), zips (<span class="math notranslate nohighlight">\(50\)</span> units), buttons (<span class="math notranslate nohighlight">\(60\)</span> units) and  fur (<span class="math notranslate nohighlight">\(60\)</span> units). The following table presents the number of units of each material that is necessary for a production of a given type of clothing:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 14%" />
<col style="width: 19%" />
<col style="width: 12%" />
<col style="width: 19%" />
<col style="width: 12%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>Wool</p></th>
<th class="head"><p>Cotton</p></th>
<th class="head"><p>Zip</p></th>
<th class="head"><p>Button</p></th>
<th class="head"><p>Fur</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Sweater</p></td>
<td><p>2</p></td>
<td><p>5</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>Jacket</p></td>
<td><p>1</p></td>
<td><p>7</p></td>
<td><p>0</p></td>
<td><p>2</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p>Shirt</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>3</p></td>
<td><p>3</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
<p>Each sweater gives <span class="math notranslate nohighlight">\(20\)</span> euros of profit, jacket gives <span class="math notranslate nohighlight">\(30\)</span> euros of profit, and shirt <span class="math notranslate nohighlight">\(10\)</span>. How many sweaters, jackets and shirts the company should produce out of available materials in order to obtain a maximal profit?</p>
<div class='sage_linked'><script type='text/x-sage'></script></div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The simplex method does not necesarily produce integer solutions; this may be the case for this problem.
Try to round the solutions to integer values which satisfy the constraints and so that the resulting profit
differs from the optimal one by less than <span class="math notranslate nohighlight">\(10\)</span> (note that the profit is always the number divisible by <span class="math notranslate nohighlight">\(10\)</span>).</p>
<p>In general, a linear programming problem where one seeks an integer solution is called an <em>integer programming problem</em>.
See <a class="reference external" href="https://en.wikipedia.org/wiki/Integer_programming">wikipedia page</a> for a description and a list of possible algorithms.
In fact, in contrast to linear programming problems which can be solved efficiently,
integer programming problems are in may cases <em>NP-hard</em>.</p>
</div>
</section>
</section>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div class="sphinxlocaltoc">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Linear Programming</a><ul>
<li><a class="reference internal" href="#the-geometric-method">The Geometric Method</a></li>
<li><a class="reference internal" href="#the-simplex-method">The Simplex Method</a></li>
<li><a class="reference internal" href="#exercises">Exercises</a></li>
</ul>
</li>
</ul>

  </div>
  <h4>Previous topic</h4>
  <p class="topless"><a href="regression.html"
                        title="previous chapter">Linear and Polynomial Regression</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="teoria_i_praktyka_ukladow_zadania.html"
                        title="next chapter">Problems</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/linear_programming.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  </div>
  <div class="relbar-bottom">
    
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="teoria_i_praktyka_ukladow_zadania.html" title="Problems"
             >next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="regression.html" title="Linear and Polynomial Regression"
             >previous</a> &nbsp; &nbsp;</li>
  <li><a href="index.html">Linear Algebra</a> &#187;</li>
  
        <li class="nav-item nav-item-this"><a href="">Linear Programming</a></li> 
      </ul>
    </div>
  </div>
  
  <div class="footer">
    <a class="logo" href="http://icse.us.edu.pl/" target="_blank"><img src="_static/logo-icse.png" alt="ICSE"/></a><br/>
    &copy; Copyright 2018, Jan Aksamit, Joanna Marzec, and  Marcin Kostur.
    Last updated on Jan 29, 2022.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 4.0.1.
  </div>
  </body>
</html>