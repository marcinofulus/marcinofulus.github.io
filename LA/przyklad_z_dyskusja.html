

  
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17: http://docutils.sourceforge.net/" />

    <title>Example with Discussion &#8212; Linear Algebra</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/cloud.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text|Open+Sans|Droid+Sans+Mono&amp;subset=latin,latin-ext" type="text/css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/jquery.cookie.js"></script>
    <script src="_static/cloud.js"></script>
    <script type="text/javascript" src="http://sagecell.sagemath.org/static/jquery.min.js"></script>
    <script type="text/javascript" src="http://sagecell.sagemath.org/embedded_sagecell.js"></script>
    <script type="text/javascript">
        sagecell.makeSagecell({inputLocation: ".sage_linked",
                               linked: true});
        sagecell.makeSagecell({inputLocation: ".sage_unlinked",
                               linked: false});
    </script>

    <style type="text/css">
        .sagecell .CodeMirror-scroll {
            overflow-y: hidden;
            overflow-x: auto;
        }
        .sagecell .CodeMirror {
            height: auto;
        }
    </style>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Equilibrium of a Linear Set of Masses Connected by Springs" href="przyklad_ze_statyki.html" />
    <link rel="prev" title="Theorems on Solutions of Linear Equations" href="teoria_ukladow_rownan.html" />
 
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1">
  </head><body>
  <div class="relbar-top">
    
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="przyklad_ze_statyki.html" title="Equilibrium of a Linear Set of Masses Connected by Springs"
             accesskey="N">next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="teoria_ukladow_rownan.html" title="Theorems on Solutions of Linear Equations"
             accesskey="P">previous</a> &nbsp; &nbsp;</li>
  <li><a href="index.html">Linear Algebra</a> &#187;</li>
  
        <li class="nav-item nav-item-this"><a href="">Example with Discussion</a></li> 
      </ul>
    </div>
  </div>
  
  <div class="content">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <section id="example-with-discussion">
<span id="id1"></span><h1>Example with Discussion<a class="headerlink" href="#example-with-discussion" title="Permalink to this headline">¶</a></h1>
<p>We will use the aforementioned methods to solve a system of equations over a field <span class="math notranslate nohighlight">\(\,Q:\)</span></p>
<div class="math notranslate nohighlight">
\begin{alignat*}{6}
   x_1 &amp; {\,} + {\,} &amp; 3\,x_2 &amp; {\,}   {\,} &amp;        &amp; {\,} + {\,} &amp; 2\,x_4 &amp; {\,} - {\,} &amp;    x_5 &amp; {\;} = {\;} &amp; 2 \\
       &amp; {\,}   {\,} &amp;        &amp; {\,}   {\,} &amp;    x_3 &amp; {\,} + {\,} &amp; 4\,x_4 &amp; {\,} - {\,} &amp; 3\,x_5 &amp; {\;} = {\;} &amp; 2 \\
   x_1 &amp; {\,} + {\,} &amp; 3\,x_2 &amp; {\,} + {\,} &amp;    x_3 &amp; {\,} + {\,} &amp; 6\,x_4 &amp; {\,} - {\,} &amp; 4\,x_5 &amp; {\;} = {\;} &amp; 4
\end{alignat*}</div><p>First, write down the coefficient matrix <span class="math notranslate nohighlight">\(\,\boldsymbol{A},\ \)</span>
the column of constants <span class="math notranslate nohighlight">\(\,\boldsymbol{b}\ \)</span>
and the augmented matrix <span class="math notranslate nohighlight">\(\,\boldsymbol{B}\,\)</span> of this system:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\boldsymbol{A}\ =\
\left[\begin{array}{rrrrr}
   1 &amp; 3 &amp; 0 &amp; 2 &amp; -1 \\
   0 &amp; 0 &amp; 1 &amp; 4 &amp; -3 \\
   1 &amp; 3 &amp; 1 &amp; 6 &amp; -4
\end{array}\right]\,,\quad
\boldsymbol{b}\ =\
\left[\begin{array}{r}
   2 \\ 2 \\ 4
\end{array}\right]\,;\qquad
\boldsymbol{B}\ =\
\left[\begin{array}{rrrrrr}
   1 &amp; 3 &amp; 0 &amp; 2 &amp; -1 &amp; 2 \\
   0 &amp; 0 &amp; 1 &amp; 4 &amp; -3 &amp; 2 \\
   1 &amp; 3 &amp; 1 &amp; 6 &amp; -4 &amp; 4
\end{array}\right]\,.\end{split}\]</div>
<section id="elimination-method">
<h2>Elimination Method<a class="headerlink" href="#elimination-method" title="Permalink to this headline">¶</a></h2>
<p>Transformation of the augmented matrix to the reduced row echelon form:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                     <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>

<span class="n">sage</span><span class="p">:</span> <span class="n">table</span><span class="p">([[</span><span class="n">B</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">rightarrow$&#39;</span><span class="p">,</span> <span class="n">B</span><span class="o">.</span><span class="n">rref</span><span class="p">()]])</span>
</pre></div>
</div>
<div class="math notranslate nohighlight" id="equation-09">
<span class="eqno">(1)<a class="headerlink" href="#equation-09" title="Permalink to this equation">¶</a></span>\[\begin{split}\left(\begin{array}{rrrrrr}
   1 &amp; 3 &amp; 0 &amp; 2 &amp; -1 &amp; 2 \\
   0 &amp; 0 &amp; 1 &amp; 4 &amp; -3 &amp; 2 \\
   1 &amp; 3 &amp; 1 &amp; 6 &amp; -4 &amp; 4
\end{array}\right)\quad\rightarrow\quad\left(\begin{array}{rrrrrr}
                                          1 &amp; 3 &amp; 0 &amp; 2 &amp; -1 &amp; 2 \\
                                          0 &amp; 0 &amp; 1 &amp; 4 &amp; -3 &amp; 2 \\
                                          0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0
                                       \end{array}\right)\end{split}\]</div>
<p>Hence, the initial system of three equations is equivalent to a system consisting of the first two equations (which is understandable as the third equation is just a sum of the first two):</p>
<div class="math notranslate nohighlight">
\begin{alignat*}{6}
   x_1 &amp; {\,} + {\,} &amp; 3\,x_2 &amp; {\,}   {\,} &amp;        &amp; {\,} + {\,} &amp; 2\,x_4 &amp; {\,} - {\,} &amp;    x_5 &amp; {\;} = {\;} &amp; 2 \\
       &amp; {\,}   {\,} &amp;        &amp; {\,}   {\,} &amp;    x_3 &amp; {\,} + {\,} &amp; 4\,x_4 &amp; {\,} - {\,} &amp; 3\,x_5 &amp; {\;} = {\;} &amp; 2 \\
\end{alignat*}</div><p>It is worth to notice that one can read off a particular solution of the initial system from the reduced row echelon form of the augmented matrix <a class="reference internal" href="#equation-09">(1)</a>: <span class="math notranslate nohighlight">\(\,\)</span>
the numbers in the last column of this matrix are the values of the unknowns corresponding to the columns with leading units, if the values of the other unknowns are taken to be zero. This particular solution is</p>
<div class="math notranslate nohighlight" id="equation-10">
<span class="eqno">(2)<a class="headerlink" href="#equation-10" title="Permalink to this equation">¶</a></span>\[x_1 = x_3 = 2,\quad x_2 = x_4 = x_5 = 0.\]</div>
<p>We rewrite the above system of two equations as</p>
<div class="math notranslate nohighlight">
\begin{alignat*}{5}
   x_1 &amp; {\;} = {\;} &amp; 2 &amp; {\,} - {\,} &amp; 3\,x_2 &amp; {\,} - {\,} &amp; 2\,x_4 &amp; {\,} + {\,} &amp; x_5 \\
   x_3 &amp; {\,} = {\,} &amp; 2 &amp; {\,} - {\,} &amp; 4\,x_4 &amp; {\,} + {\,} &amp; 3\,x_5
\end{alignat*}</div><p>We take the unknowns <span class="math notranslate nohighlight">\(\ x_2,\,x_4\ \,\text{and}\ \, x_5\ \)</span>
(corresponding to the columns without leading units) as parameters:</p>
<div class="math notranslate nohighlight">
\[x_2 = s,\ \,x_4 = t,\ \,x_5 = u,\qquad s,t,u\,\in\,Q,\]</div>
<p>so that the solution is of the form</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
   x_1 \ =\ 2 \ - \ 3\,s \ - \ 2\,t \ + \ u \\
   x_2 \ = \ s \\
   x_3 \ = \ 2 \ - \ 4\,t \ + \ 3\,u \\
   x_4 \ = \ t \\
   x_5 \ = \ u
\end{array}\qquad\quad
s,t,u\,\in\,Q\,.\end{split}\]</div>
<p>Finally, a solution of the system may be written in a vector form</p>
<div class="math notranslate nohighlight" id="equation-11">
<span class="eqno">(3)<a class="headerlink" href="#equation-11" title="Permalink to this equation">¶</a></span>\[\begin{split}\left[\begin{array}{c} x_1 \\ x_2 \\ x_3 \\ x_4 \\ x_5 \end{array}\right]\ \,=\ \,
\left[\begin{array}{r}  2  \\  0  \\  2  \\  0  \\  0  \end{array}\right]\ +\ s\
\left[\begin{array}{r} -3  \\  1  \\  0  \\  0  \\  0  \end{array}\right]\ +\ t\
\left[\begin{array}{r} -2  \\  0  \\ -4  \\  1  \\  0  \end{array}\right]\ +\ u\
\left[\begin{array}{r}  1  \\  0  \\  3  \\  0  \\  1 \end{array}\right]\,,\quad
s,t,u\,\in\,Q.\end{split}\]</div>
</section>
<section id="a-direct-approach">
<h2>A Direct Approach<a class="headerlink" href="#a-direct-approach" title="Permalink to this headline">¶</a></h2>
<p>We use the methods <code class="docutils literal notranslate"><span class="pre">solve_right()</span></code> and <code class="docutils literal notranslate"><span class="pre">right_kernel_matrix()</span></code> to determine a particular solution of the initial unhomogeneous system, and also a general solution of the associated homogeneous system:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                     <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">]])</span>

<span class="n">sage</span><span class="p">:</span> <span class="n">b</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">QQ</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>

<span class="n">sage</span><span class="p">:</span> <span class="n">X</span> <span class="o">=</span> <span class="n">A</span>\<span class="n">b</span>   <span class="c1"># a particular solution of the original system</span>

<span class="c1"># Rows of matrix B0 form a basis of the space of solutions</span>
<span class="c1"># of the homogeneous system associated with the original one</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">B0</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">()</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">B0</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">B0</span> <span class="c1"># to get rid of fractions</span>

<span class="n">sage</span><span class="p">:</span> <span class="n">show</span><span class="p">((</span><span class="n">X</span><span class="p">,</span> <span class="n">B0</span><span class="p">))</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}\left(\quad\left(2,\,0,\,2,\,0,\,0\right),\quad
\left(\ \begin{array}{rrrrr}
   2 &amp; 0 &amp; 0 &amp; -3 &amp; - 4 \\
   0 &amp; 2 &amp; 0 &amp; -9 &amp; -12 \\
   0 &amp; 0 &amp; 2 &amp;  1 &amp;   2
\end{array}\ \right)\quad\right)\end{split}\]</div>
<p>Hence, a general solution comprises a set of vectors of the form</p>
<div class="math notranslate nohighlight" id="equation-12">
<span class="eqno">(4)<a class="headerlink" href="#equation-12" title="Permalink to this equation">¶</a></span>\[\begin{split}\left[\begin{array}{c} x_1 \\ x_2 \\ x_3 \\ x_4 \\ x_5 \end{array}\right]\ \, =\ \,
\left[\begin{array}{r}  2  \\  0  \\  2  \\  0  \\   0 \end{array}\right]\ +\ s\
\left[\begin{array}{r}  2  \\  0  \\  0  \\ -3  \\  -4 \end{array}\right]\ +\ t\
\left[\begin{array}{r}  0  \\  2  \\  0  \\ -9  \\ -12 \end{array}\right]\ +\ u\
\left[\begin{array}{r}  0  \\  0  \\  2  \\  1  \\   2 \end{array}\right]\,,\quad
s,t,u\,\in\,Q.\end{split}\]</div>
</section>
<section id="comparison-of-results">
<h2>Comparison of Results<a class="headerlink" href="#comparison-of-results" title="Permalink to this headline">¶</a></h2>
<p>Formulae <a class="reference internal" href="#equation-11">(3)</a> and <a class="reference internal" href="#equation-12">(4)</a> presenting a general solution of the system are not identical: they contain the same particular solution, but the vectors spanning the solution spaces of the homogeneous system are different.</p>
<p>In order to check the consistence of these formulae we construct and compare the aforementioned space. We make use of the function <code class="docutils literal notranslate"><span class="pre">span()</span></code>,
which returns the space spanned by the given (in a list form) vectors:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">V1</span> <span class="o">=</span> <span class="n">span</span><span class="p">(</span><span class="n">QQ</span><span class="p">,[[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">V2</span> <span class="o">=</span> <span class="n">span</span><span class="p">(</span><span class="n">QQ</span><span class="p">,[[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">],[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>

<span class="n">sage</span><span class="p">:</span> <span class="n">V1</span><span class="o">==</span><span class="n">V2</span>

<span class="kc">True</span>
</pre></div>
</div>
<p>A difference between the formulae <a class="reference internal" href="#equation-11">(3)</a> and <a class="reference internal" href="#equation-12">(4)</a> might have occured because a basis of the vector space is not given unambigously:
<em>every</em> maximal set of linearly independent vectors defines a basis.
Non-trivial spaces over number fields <span class="math notranslate nohighlight">\(\,Q,\,R,\,C\,\)</span>
have infinitely many bases.</p>
</section>
<section id="alternative-solution-of-the-homogeneous-system">
<h2>Alternative Solution of the Homogeneous System<a class="headerlink" href="#alternative-solution-of-the-homogeneous-system" title="Permalink to this headline">¶</a></h2>
<p>The homogeneous system of equations from the previous example, having a matrix form</p>
<div class="math notranslate nohighlight" id="equation-13">
<span class="eqno">(5)<a class="headerlink" href="#equation-13" title="Permalink to this equation">¶</a></span>\[\begin{split}\boldsymbol{A}\,\boldsymbol{x}\ =\ \boldsymbol{0}\,,
\qquad
\boldsymbol{A}\ =\
\left[\begin{array}{ccccc}
   1 &amp; 3 &amp; 0 &amp; 2 &amp; -1 \\
   0 &amp; 0 &amp; 1 &amp; 4 &amp; -3 \\
   1 &amp; 3 &amp; 1 &amp; 6 &amp; -4
\end{array}\right]\,,\end{split}\]</div>
<p>may be solved in a different, non-standard way.</p>
<p>First, we determine rank of the matrix <span class="math notranslate nohighlight">\(\,\boldsymbol{A}\ \,\)</span>
and <span class="math notranslate nohighlight">\(\ \)</span> dimension of the solution space <span class="math notranslate nohighlight">\(\,S_0.\ \)</span> Note that:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\ \text{rk}\boldsymbol{A} &lt; 3,\,\)</span> because the rows are linearly dependent
(the third is a sum of the first two);</p></li>
<li><div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(\ \text{rk}\boldsymbol{A}\geq 2,\,\)</span> because there exist non-zero minors of  order two</div>
<div class="line"><span class="math notranslate nohighlight">\(\qquad\qquad\ \)</span> (eg. a minor in a top right corner).</div>
</div>
</li>
</ul>
<p>Hence, <span class="math notranslate nohighlight">\(\ \,\text{rk}\boldsymbol{A} = 2\ \)</span> and a dimension of the space <span class="math notranslate nohighlight">\(\,S_0\,,\)</span> equal to a difference between the number of the unknowns and rank of the matrix <span class="math notranslate nohighlight">\(\,\boldsymbol{A},\,\)</span> is <span class="math notranslate nohighlight">\(\ 5 - 2 = 3.\ \)</span>
To determine the space <span class="math notranslate nohighlight">\(\,S_0\,\)</span> it suffices to provide any of its bases consisting of three linearly independent column vectors belonging to the space
<span class="math notranslate nohighlight">\(\,Q^5.\)</span></p>
<p><strong>General discussion.</strong></p>
<p>In this situation a problem of solving the system <a class="reference internal" href="#equation-13">(5)</a> is equivalent to  finding a matrix <span class="math notranslate nohighlight">\(\,\boldsymbol{X}\,\)</span> with five rows and three linearly independent columns, which satisfies the condition</p>
<div class="math notranslate nohighlight" id="equation-14">
<span class="eqno">(6)<a class="headerlink" href="#equation-14" title="Permalink to this equation">¶</a></span>\[\boldsymbol{A}\,\boldsymbol{X}\ =\ \boldsymbol{O}_3\,,\]</div>
<p>where the right hand side is a square zero matrix of order three.</p>
<p>Indeed, assume that the matrix <span class="math notranslate nohighlight">\(\,\boldsymbol{X}\in M_{5\times 3}(Q)\,\)</span>
satisfies the equation <a class="reference internal" href="#equation-14">(6)</a>. Denote its columns by
<span class="math notranslate nohighlight">\(\,\boldsymbol{X}_1,\,\boldsymbol{X}_2,\,\boldsymbol{X}_3\ \,\)</span>
so that <span class="math notranslate nohighlight">\(\ \,\)</span> in column matrix notation</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{A}\,\boldsymbol{X}\ \,=\ \,
\boldsymbol{A}\
\left[\,\boldsymbol{X}_1\,|\;\boldsymbol{X}_2\,|\;\boldsymbol{X}_3\,\right]\ \,=\ \,
\left[\,
\boldsymbol{A}\boldsymbol{X}_1\,|\;
\boldsymbol{A}\boldsymbol{X}_2\,|\;
\boldsymbol{A}\boldsymbol{X}_3\,\right]\ \,=\ \,
\left[\,\boldsymbol{0}\,|\,\boldsymbol{0}\,|\,\boldsymbol{0}\,\right]\,.\]</div>
<p>Now, if we compare the columns of the last two matrices:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{A}\boldsymbol{X}_1\ =\ \boldsymbol{0},\qquad
\boldsymbol{A}\boldsymbol{X}_2\ =\ \boldsymbol{0},\qquad
\boldsymbol{A}\boldsymbol{X}_3\ =\ \boldsymbol{0}\,,\]</div>
<p>we see that the columns <span class="math notranslate nohighlight">\(\,\boldsymbol{X}_1,\,\boldsymbol{X}_2,\,\boldsymbol{X}_3\ \)</span>
of the matrix <span class="math notranslate nohighlight">\(\,\boldsymbol{X}\,\)</span> satisfy the equation <a class="reference internal" href="#equation-13">(5)</a> <span class="math notranslate nohighlight">\(\,\)</span>
and <span class="math notranslate nohighlight">\(\,\)</span> (by their linear independence) comprise a basis of the space
<span class="math notranslate nohighlight">\(\,S_0.\)</span></p>
<p><strong>Determination of a basis for the solution space.</strong></p>
<p>The desired matrix <span class="math notranslate nohighlight">\(\,\boldsymbol{X}\,\)</span> may be constructed from  the reduced row echelon form <span class="math notranslate nohighlight">\(\,\boldsymbol{C}\,\)</span> of the coefficient matrix
<span class="math notranslate nohighlight">\(\,\boldsymbol{A}\,\)</span> of the system <a class="reference internal" href="#equation-13">(5)</a>. <span class="math notranslate nohighlight">\(\ \)</span> By the formula <a class="reference internal" href="#equation-09">(1)</a>:</p>
<div class="math notranslate nohighlight" id="equation-15">
<span class="eqno">(7)<a class="headerlink" href="#equation-15" title="Permalink to this equation">¶</a></span>\[\begin{split}\boldsymbol{C}\quad =\quad
\left[\begin{array}{rrrrr}
   1 &amp; 3 &amp; 0 &amp; 2 &amp; -1 \\
   0 &amp; 0 &amp; 1 &amp; 4 &amp; -3 \\
   0 &amp; 0 &amp; 0 &amp; 0 &amp;  0
\end{array}\right]\,.\end{split}\]</div>
<p>Swapping the second and the third column of <span class="math notranslate nohighlight">\(\,\boldsymbol{C}\,\)</span>
leads to a matrix <span class="math notranslate nohighlight">\(\,\boldsymbol{D}\,\)</span> with a clear block structure
(notation of blocks includes their sizes):</p>
<div class="math notranslate nohighlight" id="equation-16">
<span class="eqno">(8)<a class="headerlink" href="#equation-16" title="Permalink to this equation">¶</a></span>\[\begin{split}\boldsymbol{D}\quad =\quad
\left[\begin{array}{cc|ccc}
   1 &amp; 0 &amp; 3 &amp; 2 &amp; -1 \\
   0 &amp; 1 &amp; 0 &amp; 4 &amp; -3 \\
   \hline
   0 &amp; 0 &amp; 0 &amp; 0 &amp;  0
\end{array}\right]
\quad \equiv\quad
\left[\begin{array}{c|c}
   \boldsymbol{I_2}      &amp; \boldsymbol{F_{23}} \\
   \hline
   \boldsymbol{O_{12}}   &amp; \boldsymbol{O_{13}}
\end{array}\right]\,.\end{split}\]</div>
<p>Note that <span class="math notranslate nohighlight">\(\,\boldsymbol{D}\,\)</span> is a matrix (in a reduced echelon form) of the system which we obtaind from <a class="reference internal" href="#equation-13">(5)</a> by changing the numeration of unknowns: <span class="math notranslate nohighlight">\(\ x_2\leftrightarrow x_3.\ \,\)</span>
We define a new matrix</p>
<div class="math notranslate nohighlight" id="equation-17">
<span class="eqno">(9)<a class="headerlink" href="#equation-17" title="Permalink to this equation">¶</a></span>\[\begin{split}\boldsymbol{Y}\quad :\,=\quad
\left[\begin{array}{c}
   \boldsymbol{-F_{23}} \\
   \hline
   \boldsymbol{I_3}
\end{array}\right]
\quad =\quad
\left[\begin{array}{rrr}
   -3 &amp; -2 &amp; 1 \\
    0 &amp; -4 &amp; 3 \\
   \hline
    1 &amp;  0 &amp; 0 \\
    0 &amp;  1 &amp; 0 \\
    0 &amp;  0 &amp; 1
 \end{array}\right]\,.\end{split}\]</div>
<p>Applying the rules for multiplication of block matrices, we get</p>
<div class="math notranslate nohighlight" id="equation-18">
<span class="eqno">(10)<a class="headerlink" href="#equation-18" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}\begin{split}\boldsymbol{D}\cdot\boldsymbol{Y}\ \,=\ \,
\left[\begin{array}{c|c}
   \boldsymbol{I_2}    &amp; \boldsymbol{F_{23}} \\
   \hline
   \boldsymbol{O_{12}} &amp; \boldsymbol{O_{13}}
\end{array}\right]\ \cdot\
\left[\begin{array}{c}
   \boldsymbol{-F_{23}} \\
   \hline
   \boldsymbol{I_3}
\end{array}\right]\ \,=\ \,
\left[\begin{array}{c}
   -\boldsymbol{I_2 F_{23}}+\boldsymbol{F_{23}I_3} \\
   \hline
   \boldsymbol{-O_{12}F_{23}}+\boldsymbol{O_{13}I_3}
\end{array}\right]\ \,=\end{split}\\\begin{split}=\ \,
\left[\begin{array}{c}
   \boldsymbol{-F_{23}}+\boldsymbol{F_{23}} \\
   \hline
   \boldsymbol{-O_{13}}+\boldsymbol{O_{13}}
\end{array}\right]\ \,=\ \,
\left[\begin{array}{c}
   \boldsymbol{O_{23}} \\
   \hline
   \boldsymbol{O_{13}}
\end{array}\right]\ \,=\ \,\boldsymbol{O_3}.\end{split}\end{aligned}\end{align} \]</div>
<p>The columns of the matrix <span class="math notranslate nohighlight">\(\,\boldsymbol{Y}\,\)</span> are then solutions of the system with a matrix <span class="math notranslate nohighlight">\(\,\boldsymbol{D}\,\)</span> in a reduced echelon form, that is with the swapped unknowns <span class="math notranslate nohighlight">\(\ x_2,\,x_3.\ \)</span>
Solutions of the initial system <a class="reference internal" href="#equation-13">(5)</a> are the columns of the matrix <span class="math notranslate nohighlight">\(\,\boldsymbol{X}\,\)</span> obtained from <span class="math notranslate nohighlight">\(\,\boldsymbol{Y}\,\)</span> by
swapping the second and the third row
(because in these matrices, rows correspond with consecutive unknowns):</p>
<div class="math notranslate nohighlight" id="equation-19">
<span class="eqno">(11)<a class="headerlink" href="#equation-19" title="Permalink to this equation">¶</a></span>\[\begin{split}\boldsymbol{X}\quad =\quad
\left[\begin{array}{rrr}
   -3 &amp; -2 &amp; 1 \\
    1 &amp;  0 &amp; 0 \\
    0 &amp; -4 &amp; 3 \\
    0 &amp;  1 &amp; 0 \\
    0 &amp;  0 &amp; 1
 \end{array}\right]\,.\end{split}\]</div>
<p>We still have to check that the columns of the matrix <span class="math notranslate nohighlight">\(\,\boldsymbol{X}\,\)</span>
are linearly independent, i.e. that <span class="math notranslate nohighlight">\(\,\text{rk}\,\boldsymbol{X} = 3.\,\)</span>
This is testified by  the non-zero minor of  order 3. composed from first three rows of the matrix:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\det\,
\left[\begin{array}{rrr}
-3 &amp; -2 &amp; 1 \\
 1 &amp;  0 &amp; 0 \\
 0 &amp; -4 &amp; 3
\end{array}\right]\ \,=\ \, 2.\end{split}\]</div>
<p>Finaly, a general solution of the homogeneous sytem <a class="reference internal" href="#equation-13">(5)</a> is of the form</p>
<div class="math notranslate nohighlight" id="equation-20">
<span class="eqno">(12)<a class="headerlink" href="#equation-20" title="Permalink to this equation">¶</a></span>\[\begin{split}\left[\begin{array}{c} x_1 \\ x_2 \\ x_3 \\ x_4 \\ x_5 \end{array}\right]\quad =\quad
s\ \,\left[\begin{array}{r} -3  \\  1  \\  0  \\  0  \\  0 \end{array}\right]\ +\
t\ \,\left[\begin{array}{r} -2  \\  0  \\ -4  \\  1  \\  0 \end{array}\right]\ +\
u\ \,\left[\begin{array}{r}  1  \\  0  \\  3  \\  0  \\  1 \end{array}\right]\,,\qquad
s,t,u\,\in\,Q\,,\end{split}\]</div>
<p>which coincides with the solution <a class="reference internal" href="#equation-11">(3)</a> of unhomogeneous system. <span class="math notranslate nohighlight">\(\\\)</span></p>
<p><strong>Application of computer algebra.</strong></p>
<p>Now we use tools of Sage to perform matrix operations described above.</p>
<ol class="arabic">
<li><p>Transformation of the matrix <span class="math notranslate nohighlight">\(\,\boldsymbol{A}\,\)</span> to reduced echelon form
<span class="math notranslate nohighlight">\(\,\boldsymbol{C}\,\)</span> (formula <a class="reference internal" href="#equation-15">(7)</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                     <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">]])</span>

<span class="n">sage</span><span class="p">:</span> <span class="n">C</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">rref</span><span class="p">();</span> <span class="n">C</span>

<span class="p">[</span> <span class="mi">1</span>  <span class="mi">3</span>  <span class="mi">0</span>  <span class="mi">2</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="p">[</span> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">4</span> <span class="o">-</span><span class="mi">3</span><span class="p">]</span>
<span class="p">[</span> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>Construction of the matrix <span class="math notranslate nohighlight">\(\,\boldsymbol{D}\,\)</span> by swapping the second and
the third column of the matrix <span class="math notranslate nohighlight">\(\,\boldsymbol{C},\,\)</span>
and indication of its block structure (formula <a class="reference internal" href="#equation-16">(8)</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">D</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="o">.</span><span class="n">with_swapped_columns</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">D</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> <span class="n">D</span>

<span class="p">[</span> <span class="mi">1</span>  <span class="mi">0</span><span class="o">|</span> <span class="mi">3</span>  <span class="mi">2</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="p">[</span> <span class="mi">0</span>  <span class="mi">1</span><span class="o">|</span> <span class="mi">0</span>  <span class="mi">4</span> <span class="o">-</span><span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="o">-----+--------</span><span class="p">]</span>
<span class="p">[</span> <span class="mi">0</span>  <span class="mi">0</span><span class="o">|</span> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>Isolation of the block <span class="math notranslate nohighlight">\(\,\boldsymbol{F_{23}}\,\)</span>
and construction of the matrix <span class="math notranslate nohighlight">\(\,\boldsymbol{Y}\ \)</span> (formula <a class="reference internal" href="#equation-17">(9)</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">F23</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">subdivision</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">I3</span> <span class="o">=</span> <span class="n">identity_matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">block_matrix</span><span class="p">([[</span><span class="o">-</span><span class="n">F23</span><span class="p">],[</span><span class="n">I3</span><span class="p">]]);</span> <span class="n">Y</span>

<span class="p">[</span><span class="o">-</span><span class="mi">3</span> <span class="o">-</span><span class="mi">2</span>  <span class="mi">1</span><span class="p">]</span>
<span class="p">[</span> <span class="mi">0</span> <span class="o">-</span><span class="mi">4</span>  <span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="o">--------</span><span class="p">]</span>
<span class="p">[</span> <span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">0</span><span class="p">]</span>
<span class="p">[</span> <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">0</span><span class="p">]</span>
<span class="p">[</span> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>Verification that a product of matrices <span class="math notranslate nohighlight">\(\,\boldsymbol{D}\,\)</span>
and <span class="math notranslate nohighlight">\(\,\boldsymbol{Y}\,\)</span>
is equal to the zero matrix of order 3. <span class="math notranslate nohighlight">\(\\\)</span> (formula <a class="reference internal" href="#equation-18">(10)</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">D</span><span class="o">*</span><span class="n">Y</span>

<span class="p">[</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">[</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">[</span><span class="o">-----</span><span class="p">]</span>
<span class="p">[</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>Construction of the matrix <span class="math notranslate nohighlight">\(\,\boldsymbol{X}\,\)</span> by swapping the second
and the third row of the matrix <span class="math notranslate nohighlight">\(\,\boldsymbol{Y},\,\)</span>
and removing block structure of <span class="math notranslate nohighlight">\(\,\boldsymbol{X}\,\)</span> (formula <a class="reference internal" href="#equation-19">(11)</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">X</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">with_swapped_rows</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">X</span><span class="o">.</span><span class="n">subdivide</span><span class="p">();</span> <span class="n">X</span>

<span class="p">[</span><span class="o">-</span><span class="mi">3</span> <span class="o">-</span><span class="mi">2</span>  <span class="mi">1</span><span class="p">]</span>
<span class="p">[</span> <span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">0</span><span class="p">]</span>
<span class="p">[</span> <span class="mi">0</span> <span class="o">-</span><span class="mi">4</span>  <span class="mi">3</span><span class="p">]</span>
<span class="p">[</span> <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">0</span><span class="p">]</span>
<span class="p">[</span> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>Verification that the matrix <span class="math notranslate nohighlight">\(\,\boldsymbol{X}\,\)</span> satisfies the equation <a class="reference internal" href="#equation-14">(6)</a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="n">A</span><span class="o">*</span><span class="n">X</span>

<span class="p">[</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">[</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">[</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</li>
</ol>
<div class="admonition-remark admonition">
<p class="admonition-title">Remark:</p>
<p>As opposed to the methods <code class="docutils literal notranslate"><span class="pre">swap_columns()</span></code> and <code class="docutils literal notranslate"><span class="pre">swap_rows()</span></code>,
which perform the operations directly on the original matrix,
the methods <code class="docutils literal notranslate"><span class="pre">with_swapped_columns()</span></code> and <code class="docutils literal notranslate"><span class="pre">with_swapped_rows()</span></code>
used here output a tranformed matrix without changing the original one.</p>
</div>
<p>Joining all the operations we obtain the result <a class="reference internal" href="#equation-20">(12)</a>:</p>
<div class='sage_linked'><script type='text/x-sage'>A = matrix(QQ,[[1, 3, 0, 2,-1],
               [0, 0, 1, 4,-3],
               [1, 3, 1, 6,-4]])
C = A.rref()
D = copy(C).with_swapped_columns(1,2)
D.subdivide(2,2)
F23 = D.subdivision(0,1)
I3 = identity_matrix(3)
Y = block_matrix([[-F23],[I3]])
X = Y.with_swapped_rows(1,2)

cmpnt = '$ %s \\ \\left[\\begin{array}{r} %s \\\ %s \\\ %s \\\ %s \\\ %s \\end{array}\\right]$'

html(cmpnt % (' ',  'x_1',  'x_2',  'x_3',  'x_4',  'x_5') + '  $=$  ' +\
     cmpnt % ('s', X[0,0], X[1,0], X[2,0], X[3,0], X[4,0]) + '  $+$  ' +\
     cmpnt % ('t', X[0,1], X[1,1], X[2,1], X[3,1], X[4,1]) + '  $+$  ' +\
     cmpnt % ('u', X[0,2], X[1,2], X[2,2], X[3,2], X[4,2]) + '$\\,,$ ' +\
     '$\\qquad s,t,u \\in Q.$')</script></div><p>We should emphasize though that a method presented in this section to solve the system  <a class="reference internal" href="#equation-13">(5)</a>, even though it is instructive, it is not universal: it turned out effective  only because of a specific structure of the coefficient matrix
<span class="math notranslate nohighlight">\(\,\boldsymbol{A},\,\)</span> which led to a block form <a class="reference internal" href="#equation-16">(8)</a>. The standard procedure is either a direct method described before or the elimination method.</p>
<div class="line-block">
<div class="line"><strong>Exercise.</strong></div>
<div class="line">Check by hand calculation that the matrix
<span class="math notranslate nohighlight">\(\,\boldsymbol{X}\,\)</span> given by the formula <a class="reference internal" href="#equation-19">(11)</a> satisfies the equation <a class="reference internal" href="#equation-14">(6)</a>.</div>
</div>
</section>
</section>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div class="sphinxlocaltoc">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Example with Discussion</a><ul>
<li><a class="reference internal" href="#elimination-method">Elimination Method</a></li>
<li><a class="reference internal" href="#a-direct-approach">A Direct Approach</a></li>
<li><a class="reference internal" href="#comparison-of-results">Comparison of Results</a></li>
<li><a class="reference internal" href="#alternative-solution-of-the-homogeneous-system">Alternative Solution of the Homogeneous System</a></li>
</ul>
</li>
</ul>

  </div>
  <h4>Previous topic</h4>
  <p class="topless"><a href="teoria_ukladow_rownan.html"
                        title="previous chapter">Theorems on Solutions of Linear Equations</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="przyklad_ze_statyki.html"
                        title="next chapter">Equilibrium of a Linear Set of Masses Connected by Springs</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/przyklad_z_dyskusja.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  </div>
  <div class="relbar-bottom">
    
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="przyklad_ze_statyki.html" title="Equilibrium of a Linear Set of Masses Connected by Springs"
             >next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="teoria_ukladow_rownan.html" title="Theorems on Solutions of Linear Equations"
             >previous</a> &nbsp; &nbsp;</li>
  <li><a href="index.html">Linear Algebra</a> &#187;</li>
  
        <li class="nav-item nav-item-this"><a href="">Example with Discussion</a></li> 
      </ul>
    </div>
  </div>
  
  <div class="footer">
    <a class="logo" href="http://icse.us.edu.pl/" target="_blank"><img src="_static/logo-icse.png" alt="ICSE"/></a><br/>
    &copy; Copyright 2018, Jan Aksamit, Joanna Marzec, and  Marcin Kostur.
    Last updated on Jan 29, 2022.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 4.0.1.
  </div>
  </body>
</html>